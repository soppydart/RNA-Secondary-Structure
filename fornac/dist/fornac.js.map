{"version":3,"file":"fornac.js","mappings":"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","sources":["webpack://fornac/webpack/universalModuleDefinition","webpack://fornac/./src/naview/connection.js","webpack://fornac/./src/naview/loop.js","webpack://fornac/./src/naview/region.js","webpack://fornac/./node_modules/base64-js/index.js","webpack://fornac/./node_modules/buffer/index.js","webpack://fornac/./src/d3-context-menu.css?fe1f","webpack://fornac/./src/fornac.css?7f8e","webpack://fornac/./node_modules/ieee754/index.js","webpack://fornac/./node_modules/slugid/index.js","webpack://fornac/./node_modules/slugid/slugid.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/rng.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/regex.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/validate.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/v1.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/parse.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/v35.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/md5.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/v3.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/v4.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/sha1.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/v5.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/nil.js","webpack://fornac/./node_modules/uuid/dist/esm-browser/version.js","webpack://fornac/external umd \"d3\"","webpack://fornac/webpack/bootstrap","webpack://fornac/webpack/runtime/compat get default export","webpack://fornac/webpack/runtime/define property getters","webpack://fornac/webpack/runtime/global","webpack://fornac/webpack/runtime/hasOwnProperty shorthand","webpack://fornac/webpack/runtime/make namespace object","webpack://fornac/webpack/runtime/publicPath","webpack://fornac/./src/img/play.svg","webpack://fornac/./src/d3-context-menu.js","webpack://fornac/./src/rnautils.js","webpack://fornac/./src/rnagraph.js","webpack://fornac/./src/simplernaplot.js","webpack://fornac/./src/naview/radloop.js","webpack://fornac/./src/naview/base.js","webpack://fornac/./src/naview/naview.js","webpack://fornac/./src/fornac.js","webpack://fornac/./src/rnaplot.js","webpack://fornac/./src/rnatreemap.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"d3\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"d3\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"fornac\"] = factory(require(\"d3\"));\n\telse\n\t\troot[\"fornac\"] = factory(root[\"d3\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__893__) => {\nreturn ","import {Loop} from './loop.js';\r\nimport {Region} from './region.js';\r\n\r\nexport function Connection() {\r\n\tthis.loop = new Loop();\r\n\tthis.region = new Region();\r\n\t// Start and end form the 1st base pair of the region.\r\n\tthis.start = null;\r\n    this.end = null;\r\n\tthis.xrad = null;\r\n    this.yrad = null;\r\n    this.angle = null;\r\n\t// True if segment between this connection and the\r\n\t// next must be extruded out of the circle\r\n\tthis.extruded = null;\r\n\t// True if the extruded segment must be drawn long.\r\n\tthis.broken = null;\r\n\r\n\tthis._isNull = false;\r\n}\r\n\r\nConnection.prototype.isNull = function(){\r\n\treturn this._isNull;\r\n}\r\n\r\nConnection.prototype.setNull = function(isNull){\r\n\tthis._isNull = isNull;\r\n}\r\n\r\nConnection.prototype.getLoop = function(){\r\n\treturn this.loop;\r\n}\r\n\r\nConnection.prototype.setLoop = function(loop) {\r\n\tthis.loop = loop;\r\n}\r\n\r\nConnection.prototype.getRegion = function(){\r\n\treturn this.region;\r\n}\r\n\r\nConnection.prototype.setRegion = function(region){\r\n\tthis.region = region;\r\n}\r\n\r\nConnection.prototype.getStart = function(){\r\n\treturn this.start;\r\n}\r\n\r\nConnection.prototype.setStart = function(start) {\r\n\tthis.start = start;\r\n}\r\n\r\nConnection.prototype.getEnd = function(){\r\n\treturn this.end;\r\n}\r\n\r\nConnection.prototype.setEnd = function(end){\r\n\tthis.end = end;\r\n}\r\n\r\nConnection.prototype.getXrad = function(){\r\n\treturn this.xrad;\r\n}\r\n\r\nConnection.prototype.setXrad = function(xrad){\r\n\tthis.xrad = xrad;\r\n}\r\n\r\nConnection.prototype.getYrad = function(){\r\n\treturn this.yrad;\r\n}\r\n\r\nConnection.prototype.setYrad = function(yrad) {\r\n\tthis.yrad = yrad;\r\n}\r\n\r\nConnection.prototype.getAngle = function(){\r\n\treturn this.angle;\r\n}\r\n\r\nConnection.prototype.setAngle = function(angle){\r\n\tthis.angle = angle;\r\n}\r\n\r\nConnection.prototype.isExtruded = function(){\r\n\treturn this.extruded;\r\n}\r\n\r\nConnection.prototype.setExtruded = function(extruded){\r\n\tthis.extruded = extruded;\r\n}\r\n\r\nConnection.prototype.isBroken = function(){\r\n\treturn this.broken;\r\n}\r\n\r\nConnection.prototype.setBroken = function(broken){\r\n\tthis.broken = broken;\r\n}\r\n","import {Connection} from './connection.js';\r\n\r\nexport function Loop() {\r\n\tthis.nconnection = null;\r\n\tthis.connections = [];\r\n\tthis._connections = [];\r\n\tthis.number = null;\r\n\tthis.depth = null;\r\n\tthis.mark = null;\r\n\tthis.x = null;\r\n    this.y = null;\r\n    this.radius = null;\r\n}\r\n\r\nLoop.prototype.getNconnection = function() {\r\n\treturn this.nconnection;\r\n}\r\n\r\nLoop.prototype.setNconnection = function(nconnection) {\r\n\tthis.nconnection = nconnection;\r\n}\r\n\r\nLoop.prototype.setConnection = function(i, c){\r\n\tif (c != null){\r\n\t\tthis._connections[i] = c;\r\n    }\r\n\telse {\r\n\t\tif (!this._connections[i]){\r\n\t\t\tthis._connections[i] = new Connection();\r\n\t\t}\r\n\t\tthis._connections[i].setNull(true);\r\n\t}\r\n}\r\n\r\nLoop.prototype.getConnection = function(i){\r\n\tvar Connection = require(\"./connection\");\r\n\tif (!this._connections[i]){\r\n        this._connections[i] = new Connection();\r\n    }\r\n\tvar c = this._connections[i];\r\n\tif (c.isNull()){\r\n\t\treturn null;\r\n    }\r\n\telse {\r\n\t\treturn c;\r\n    }\r\n}\r\n\r\nLoop.prototype.addConnection = function(i, c){\r\n\tthis._connections.push(c);\r\n}\r\n\r\nLoop.prototype.getNumber = function(){\r\n\treturn this.number;\r\n}\r\n\r\nLoop.prototype.setNumber = function(number){\r\n\tthis.number = number;\r\n}\r\n\r\nLoop.prototype.getDepth = function(){\r\n\treturn this.depth;\r\n}\r\n\r\nLoop.prototype.setDepth = function(depth){\r\n\tthis.depth = depth;\r\n}\r\n\r\nLoop.prototype.isMark = function(){\r\n\treturn this.mark;\r\n}\r\n\r\nLoop.prototype.setMark = function(mark){\r\n\tthis.mark = mark;\r\n}\r\n\r\nLoop.prototype.getX = function(){\r\n\treturn this.x;\r\n}\r\n\r\nLoop.prototype.setX = function(x){\r\n\tthis.x = x;\r\n}\r\n\r\nLoop.prototype.getY = function(){\r\n\treturn this.y;\r\n}\r\n\r\nLoop.prototype.setY = function(y){\r\n\tthis.y = y;\r\n}\r\n\r\nLoop.prototype.getRadius = function(){\r\n\treturn this.radius;\r\n}\r\n\r\nLoop.prototype.setRadius = function(radius){\r\n\tthis.radius = radius;\r\n}\r\n","export function Region() {\r\n\tthis._start1 = null;\r\n    this._end1 = null;\r\n    this._start2 = null;\r\n    this._end2 = null;\r\n}\r\n\r\nRegion.prototype.getStart1 = function(){\r\n\treturn this._start1;\r\n}\r\n\r\nRegion.prototype.setStart1 = function(start1){\r\n\tthis._start1 = start1;\r\n}\r\n\r\nRegion.prototype.getEnd1 = function(){\r\n\treturn this._end1;\r\n}\r\n\r\nRegion.prototype.setEnd1 = function(end1){\r\n\tthis._end1 = end1;\r\n}\r\n\r\nRegion.prototype.getStart2 = function(){\r\n\treturn this._start2;\r\n}\r\n\r\nRegion.prototype.setStart2 = function(start2){\r\n\tthis._start2 = start2;\r\n}\r\n\r\nRegion.prototype.getEnd2 = function(){\r\n\treturn this._end2;\r\n}\r\n\r\nRegion.prototype.setEnd2 = function(end2){\r\n\tthis._end2 = end2;\r\n}\r\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nconst base64 = require('base64-js')\nconst ieee754 = require('ieee754')\nconst customInspectSymbol =\n  (typeof Symbol === 'function' && typeof Symbol['for'] === 'function') // eslint-disable-line dot-notation\n    ? Symbol['for']('nodejs.util.inspect.custom') // eslint-disable-line dot-notation\n    : null\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\nconst K_MAX_LENGTH = 0x7fffffff\nexports.kMaxLength = K_MAX_LENGTH\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Print warning and recommend using `buffer` v4.x which has an Object\n *               implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * We report that the browser does not support typed arrays if the are not subclassable\n * using __proto__. Firefox 4-29 lacks support for adding new properties to `Uint8Array`\n * (See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438). IE 10 lacks support\n * for __proto__ and has a buggy typed array implementation.\n */\nBuffer.TYPED_ARRAY_SUPPORT = typedArraySupport()\n\nif (!Buffer.TYPED_ARRAY_SUPPORT && typeof console !== 'undefined' &&\n    typeof console.error === 'function') {\n  console.error(\n    'This browser lacks typed array (Uint8Array) support which is required by ' +\n    '`buffer` v5.x. Use `buffer` v4.x if you require old browser support.'\n  )\n}\n\nfunction typedArraySupport () {\n  // Can typed array instances can be augmented?\n  try {\n    const arr = new Uint8Array(1)\n    const proto = { foo: function () { return 42 } }\n    Object.setPrototypeOf(proto, Uint8Array.prototype)\n    Object.setPrototypeOf(arr, proto)\n    return arr.foo() === 42\n  } catch (e) {\n    return false\n  }\n}\n\nObject.defineProperty(Buffer.prototype, 'parent', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.buffer\n  }\n})\n\nObject.defineProperty(Buffer.prototype, 'offset', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.byteOffset\n  }\n})\n\nfunction createBuffer (length) {\n  if (length > K_MAX_LENGTH) {\n    throw new RangeError('The value \"' + length + '\" is invalid for option \"size\"')\n  }\n  // Return an augmented `Uint8Array` instance\n  const buf = new Uint8Array(length)\n  Object.setPrototypeOf(buf, Buffer.prototype)\n  return buf\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new TypeError(\n        'The \"string\" argument must be of type string. Received type number'\n      )\n    }\n    return allocUnsafe(arg)\n  }\n  return from(arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\nfunction from (value, encodingOrOffset, length) {\n  if (typeof value === 'string') {\n    return fromString(value, encodingOrOffset)\n  }\n\n  if (ArrayBuffer.isView(value)) {\n    return fromArrayView(value)\n  }\n\n  if (value == null) {\n    throw new TypeError(\n      'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n      'or Array-like Object. Received type ' + (typeof value)\n    )\n  }\n\n  if (isInstance(value, ArrayBuffer) ||\n      (value && isInstance(value.buffer, ArrayBuffer))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof SharedArrayBuffer !== 'undefined' &&\n      (isInstance(value, SharedArrayBuffer) ||\n      (value && isInstance(value.buffer, SharedArrayBuffer)))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'number') {\n    throw new TypeError(\n      'The \"value\" argument must not be of type number. Received type number'\n    )\n  }\n\n  const valueOf = value.valueOf && value.valueOf()\n  if (valueOf != null && valueOf !== value) {\n    return Buffer.from(valueOf, encodingOrOffset, length)\n  }\n\n  const b = fromObject(value)\n  if (b) return b\n\n  if (typeof Symbol !== 'undefined' && Symbol.toPrimitive != null &&\n      typeof value[Symbol.toPrimitive] === 'function') {\n    return Buffer.from(value[Symbol.toPrimitive]('string'), encodingOrOffset, length)\n  }\n\n  throw new TypeError(\n    'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n    'or Array-like Object. Received type ' + (typeof value)\n  )\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(value, encodingOrOffset, length)\n}\n\n// Note: Change prototype *after* Buffer.from is defined to workaround Chrome bug:\n// https://github.com/feross/buffer/pull/148\nObject.setPrototypeOf(Buffer.prototype, Uint8Array.prototype)\nObject.setPrototypeOf(Buffer, Uint8Array)\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be of type number')\n  } else if (size < 0) {\n    throw new RangeError('The value \"' + size + '\" is invalid for option \"size\"')\n  }\n}\n\nfunction alloc (size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpreted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(size).fill(fill, encoding)\n      : createBuffer(size).fill(fill)\n  }\n  return createBuffer(size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(size, fill, encoding)\n}\n\nfunction allocUnsafe (size) {\n  assertSize(size)\n  return createBuffer(size < 0 ? 0 : checked(size) | 0)\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(size)\n}\n\nfunction fromString (string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('Unknown encoding: ' + encoding)\n  }\n\n  const length = byteLength(string, encoding) | 0\n  let buf = createBuffer(length)\n\n  const actual = buf.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    buf = buf.slice(0, actual)\n  }\n\n  return buf\n}\n\nfunction fromArrayLike (array) {\n  const length = array.length < 0 ? 0 : checked(array.length) | 0\n  const buf = createBuffer(length)\n  for (let i = 0; i < length; i += 1) {\n    buf[i] = array[i] & 255\n  }\n  return buf\n}\n\nfunction fromArrayView (arrayView) {\n  if (isInstance(arrayView, Uint8Array)) {\n    const copy = new Uint8Array(arrayView)\n    return fromArrayBuffer(copy.buffer, copy.byteOffset, copy.byteLength)\n  }\n  return fromArrayLike(arrayView)\n}\n\nfunction fromArrayBuffer (array, byteOffset, length) {\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\"offset\" is outside of buffer bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\"length\" is outside of buffer bounds')\n  }\n\n  let buf\n  if (byteOffset === undefined && length === undefined) {\n    buf = new Uint8Array(array)\n  } else if (length === undefined) {\n    buf = new Uint8Array(array, byteOffset)\n  } else {\n    buf = new Uint8Array(array, byteOffset, length)\n  }\n\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(buf, Buffer.prototype)\n\n  return buf\n}\n\nfunction fromObject (obj) {\n  if (Buffer.isBuffer(obj)) {\n    const len = checked(obj.length) | 0\n    const buf = createBuffer(len)\n\n    if (buf.length === 0) {\n      return buf\n    }\n\n    obj.copy(buf, 0, 0, len)\n    return buf\n  }\n\n  if (obj.length !== undefined) {\n    if (typeof obj.length !== 'number' || numberIsNaN(obj.length)) {\n      return createBuffer(0)\n    }\n    return fromArrayLike(obj)\n  }\n\n  if (obj.type === 'Buffer' && Array.isArray(obj.data)) {\n    return fromArrayLike(obj.data)\n  }\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < K_MAX_LENGTH` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= K_MAX_LENGTH) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + K_MAX_LENGTH.toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return b != null && b._isBuffer === true &&\n    b !== Buffer.prototype // so Buffer.isBuffer(Buffer.prototype) will be false\n}\n\nBuffer.compare = function compare (a, b) {\n  if (isInstance(a, Uint8Array)) a = Buffer.from(a, a.offset, a.byteLength)\n  if (isInstance(b, Uint8Array)) b = Buffer.from(b, b.offset, b.byteLength)\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError(\n      'The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array'\n    )\n  }\n\n  if (a === b) return 0\n\n  let x = a.length\n  let y = b.length\n\n  for (let i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!Array.isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  let i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  const buffer = Buffer.allocUnsafe(length)\n  let pos = 0\n  for (i = 0; i < list.length; ++i) {\n    let buf = list[i]\n    if (isInstance(buf, Uint8Array)) {\n      if (pos + buf.length > buffer.length) {\n        if (!Buffer.isBuffer(buf)) buf = Buffer.from(buf)\n        buf.copy(buffer, pos)\n      } else {\n        Uint8Array.prototype.set.call(\n          buffer,\n          buf,\n          pos\n        )\n      }\n    } else if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    } else {\n      buf.copy(buffer, pos)\n    }\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (ArrayBuffer.isView(string) || isInstance(string, ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    throw new TypeError(\n      'The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. ' +\n      'Received type ' + typeof string\n    )\n  }\n\n  const len = string.length\n  const mustMatch = (arguments.length > 2 && arguments[2] === true)\n  if (!mustMatch && len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  let loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) {\n          return mustMatch ? -1 : utf8ToBytes(string).length // assume utf8\n        }\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  let loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coercion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// This property is used by `Buffer.isBuffer` (and the `is-buffer` npm package)\n// to detect a Buffer instance. It's not possible to use `instanceof Buffer`\n// reliably in a browserify context because there could be multiple different\n// copies of the 'buffer' package in use. This method works even for Buffer\n// instances that were created from another copy of the `buffer` package.\n// See: https://github.com/feross/buffer/issues/154\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  const i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  const len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (let i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  const len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (let i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  const len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (let i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  const length = this.length\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.toLocaleString = Buffer.prototype.toString\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  let str = ''\n  const max = exports.INSPECT_MAX_BYTES\n  str = this.toString('hex', 0, max).replace(/(.{2})/g, '$1 ').trim()\n  if (this.length > max) str += ' ... '\n  return '<Buffer ' + str + '>'\n}\nif (customInspectSymbol) {\n  Buffer.prototype[customInspectSymbol] = Buffer.prototype.inspect\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (isInstance(target, Uint8Array)) {\n    target = Buffer.from(target, target.offset, target.byteLength)\n  }\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError(\n      'The \"target\" argument must be one of type Buffer or Uint8Array. ' +\n      'Received type ' + (typeof target)\n    )\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  let x = thisEnd - thisStart\n  let y = end - start\n  const len = Math.min(x, y)\n\n  const thisCopy = this.slice(thisStart, thisEnd)\n  const targetCopy = target.slice(start, end)\n\n  for (let i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset // Coerce to Number.\n  if (numberIsNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [val], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  let indexSize = 1\n  let arrLength = arr.length\n  let valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  let i\n  if (dir) {\n    let foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      let found = true\n      for (let j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  const remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  const strLen = string.length\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  let i\n  for (i = 0; i < length; ++i) {\n    const parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (numberIsNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset >>> 0\n    if (isFinite(length)) {\n      length = length >>> 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  const remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  let loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return asciiWrite(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  const res = []\n\n  let i = start\n  while (i < end) {\n    const firstByte = buf[i]\n    let codePoint = null\n    let bytesPerSequence = (firstByte > 0xEF)\n      ? 4\n      : (firstByte > 0xDF)\n          ? 3\n          : (firstByte > 0xBF)\n              ? 2\n              : 1\n\n    if (i + bytesPerSequence <= end) {\n      let secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nconst MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  const len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  let res = ''\n  let i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  let ret = ''\n  end = Math.min(buf.length, end)\n\n  for (let i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  let ret = ''\n  end = Math.min(buf.length, end)\n\n  for (let i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  const len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  let out = ''\n  for (let i = start; i < end; ++i) {\n    out += hexSliceLookupTable[buf[i]]\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  const bytes = buf.slice(start, end)\n  let res = ''\n  // If bytes.length is odd, the last 8 bits must be ignored (same as node.js)\n  for (let i = 0; i < bytes.length - 1; i += 2) {\n    res += String.fromCharCode(bytes[i] + (bytes[i + 1] * 256))\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  const len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  const newBuf = this.subarray(start, end)\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(newBuf, Buffer.prototype)\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUintLE =\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let val = this[offset]\n  let mul = 1\n  let i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUintBE =\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  let val = this[offset + --byteLength]\n  let mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUint8 =\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUint16LE =\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUint16BE =\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUint32LE =\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUint32BE =\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readBigUInt64LE = defineBigIntMethod(function readBigUInt64LE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const lo = first +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 24\n\n  const hi = this[++offset] +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    last * 2 ** 24\n\n  return BigInt(lo) + (BigInt(hi) << BigInt(32))\n})\n\nBuffer.prototype.readBigUInt64BE = defineBigIntMethod(function readBigUInt64BE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const hi = first * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    this[++offset]\n\n  const lo = this[++offset] * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    last\n\n  return (BigInt(hi) << BigInt(32)) + BigInt(lo)\n})\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let val = this[offset]\n  let mul = 1\n  let i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let i = byteLength\n  let mul = 1\n  let val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  const val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  const val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readBigInt64LE = defineBigIntMethod(function readBigInt64LE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const val = this[offset + 4] +\n    this[offset + 5] * 2 ** 8 +\n    this[offset + 6] * 2 ** 16 +\n    (last << 24) // Overflow\n\n  return (BigInt(val) << BigInt(32)) +\n    BigInt(first +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 24)\n})\n\nBuffer.prototype.readBigInt64BE = defineBigIntMethod(function readBigInt64BE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const val = (first << 24) + // Overflow\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    this[++offset]\n\n  return (BigInt(val) << BigInt(32)) +\n    BigInt(this[++offset] * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    last)\n})\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUintLE =\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    const maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  let mul = 1\n  let i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUintBE =\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    const maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  let i = byteLength - 1\n  let mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUint8 =\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeUint16LE =\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint16BE =\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint32LE =\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset + 3] = (value >>> 24)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 1] = (value >>> 8)\n  this[offset] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeUint32BE =\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nfunction wrtBigUInt64LE (buf, value, offset, min, max) {\n  checkIntBI(value, min, max, buf, offset, 7)\n\n  let lo = Number(value & BigInt(0xffffffff))\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  let hi = Number(value >> BigInt(32) & BigInt(0xffffffff))\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  return offset\n}\n\nfunction wrtBigUInt64BE (buf, value, offset, min, max) {\n  checkIntBI(value, min, max, buf, offset, 7)\n\n  let lo = Number(value & BigInt(0xffffffff))\n  buf[offset + 7] = lo\n  lo = lo >> 8\n  buf[offset + 6] = lo\n  lo = lo >> 8\n  buf[offset + 5] = lo\n  lo = lo >> 8\n  buf[offset + 4] = lo\n  let hi = Number(value >> BigInt(32) & BigInt(0xffffffff))\n  buf[offset + 3] = hi\n  hi = hi >> 8\n  buf[offset + 2] = hi\n  hi = hi >> 8\n  buf[offset + 1] = hi\n  hi = hi >> 8\n  buf[offset] = hi\n  return offset + 8\n}\n\nBuffer.prototype.writeBigUInt64LE = defineBigIntMethod(function writeBigUInt64LE (value, offset = 0) {\n  return wrtBigUInt64LE(this, value, offset, BigInt(0), BigInt('0xffffffffffffffff'))\n})\n\nBuffer.prototype.writeBigUInt64BE = defineBigIntMethod(function writeBigUInt64BE (value, offset = 0) {\n  return wrtBigUInt64BE(this, value, offset, BigInt(0), BigInt('0xffffffffffffffff'))\n})\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    const limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  let i = 0\n  let mul = 1\n  let sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    const limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  let i = byteLength - 1\n  let mul = 1\n  let sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 3] = (value >>> 24)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeBigInt64LE = defineBigIntMethod(function writeBigInt64LE (value, offset = 0) {\n  return wrtBigUInt64LE(this, value, offset, -BigInt('0x8000000000000000'), BigInt('0x7fffffffffffffff'))\n})\n\nBuffer.prototype.writeBigInt64BE = defineBigIntMethod(function writeBigInt64BE (value, offset = 0) {\n  return wrtBigUInt64BE(this, value, offset, -BigInt('0x8000000000000000'), BigInt('0x7fffffffffffffff'))\n})\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!Buffer.isBuffer(target)) throw new TypeError('argument should be a Buffer')\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('Index out of range')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  const len = end - start\n\n  if (this === target && typeof Uint8Array.prototype.copyWithin === 'function') {\n    // Use built-in when available, missing from IE11\n    this.copyWithin(targetStart, start, end)\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, end),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n    if (val.length === 1) {\n      const code = val.charCodeAt(0)\n      if ((encoding === 'utf8' && code < 128) ||\n          encoding === 'latin1') {\n        // Fast path: If `val` fits into a single byte, use that numeric value.\n        val = code\n      }\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  } else if (typeof val === 'boolean') {\n    val = Number(val)\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  let i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    const bytes = Buffer.isBuffer(val)\n      ? val\n      : Buffer.from(val, encoding)\n    const len = bytes.length\n    if (len === 0) {\n      throw new TypeError('The value \"' + val +\n        '\" is invalid for argument \"value\"')\n    }\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// CUSTOM ERRORS\n// =============\n\n// Simplified versions from Node, changed for Buffer-only usage\nconst errors = {}\nfunction E (sym, getMessage, Base) {\n  errors[sym] = class NodeError extends Base {\n    constructor () {\n      super()\n\n      Object.defineProperty(this, 'message', {\n        value: getMessage.apply(this, arguments),\n        writable: true,\n        configurable: true\n      })\n\n      // Add the error code to the name to include it in the stack trace.\n      this.name = `${this.name} [${sym}]`\n      // Access the stack to generate the error message including the error code\n      // from the name.\n      this.stack // eslint-disable-line no-unused-expressions\n      // Reset the name to the actual name.\n      delete this.name\n    }\n\n    get code () {\n      return sym\n    }\n\n    set code (value) {\n      Object.defineProperty(this, 'code', {\n        configurable: true,\n        enumerable: true,\n        value,\n        writable: true\n      })\n    }\n\n    toString () {\n      return `${this.name} [${sym}]: ${this.message}`\n    }\n  }\n}\n\nE('ERR_BUFFER_OUT_OF_BOUNDS',\n  function (name) {\n    if (name) {\n      return `${name} is outside of buffer bounds`\n    }\n\n    return 'Attempt to access memory outside buffer bounds'\n  }, RangeError)\nE('ERR_INVALID_ARG_TYPE',\n  function (name, actual) {\n    return `The \"${name}\" argument must be of type number. Received type ${typeof actual}`\n  }, TypeError)\nE('ERR_OUT_OF_RANGE',\n  function (str, range, input) {\n    let msg = `The value of \"${str}\" is out of range.`\n    let received = input\n    if (Number.isInteger(input) && Math.abs(input) > 2 ** 32) {\n      received = addNumericalSeparator(String(input))\n    } else if (typeof input === 'bigint') {\n      received = String(input)\n      if (input > BigInt(2) ** BigInt(32) || input < -(BigInt(2) ** BigInt(32))) {\n        received = addNumericalSeparator(received)\n      }\n      received += 'n'\n    }\n    msg += ` It must be ${range}. Received ${received}`\n    return msg\n  }, RangeError)\n\nfunction addNumericalSeparator (val) {\n  let res = ''\n  let i = val.length\n  const start = val[0] === '-' ? 1 : 0\n  for (; i >= start + 4; i -= 3) {\n    res = `_${val.slice(i - 3, i)}${res}`\n  }\n  return `${val.slice(0, i)}${res}`\n}\n\n// CHECK FUNCTIONS\n// ===============\n\nfunction checkBounds (buf, offset, byteLength) {\n  validateNumber(offset, 'offset')\n  if (buf[offset] === undefined || buf[offset + byteLength] === undefined) {\n    boundsError(offset, buf.length - (byteLength + 1))\n  }\n}\n\nfunction checkIntBI (value, min, max, buf, offset, byteLength) {\n  if (value > max || value < min) {\n    const n = typeof min === 'bigint' ? 'n' : ''\n    let range\n    if (byteLength > 3) {\n      if (min === 0 || min === BigInt(0)) {\n        range = `>= 0${n} and < 2${n} ** ${(byteLength + 1) * 8}${n}`\n      } else {\n        range = `>= -(2${n} ** ${(byteLength + 1) * 8 - 1}${n}) and < 2 ** ` +\n                `${(byteLength + 1) * 8 - 1}${n}`\n      }\n    } else {\n      range = `>= ${min}${n} and <= ${max}${n}`\n    }\n    throw new errors.ERR_OUT_OF_RANGE('value', range, value)\n  }\n  checkBounds(buf, offset, byteLength)\n}\n\nfunction validateNumber (value, name) {\n  if (typeof value !== 'number') {\n    throw new errors.ERR_INVALID_ARG_TYPE(name, 'number', value)\n  }\n}\n\nfunction boundsError (value, length, type) {\n  if (Math.floor(value) !== value) {\n    validateNumber(value, type)\n    throw new errors.ERR_OUT_OF_RANGE(type || 'offset', 'an integer', value)\n  }\n\n  if (length < 0) {\n    throw new errors.ERR_BUFFER_OUT_OF_BOUNDS()\n  }\n\n  throw new errors.ERR_OUT_OF_RANGE(type || 'offset',\n                                    `>= ${type ? 1 : 0} and <= ${length}`,\n                                    value)\n}\n\n// HELPER FUNCTIONS\n// ================\n\nconst INVALID_BASE64_RE = /[^+/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node takes equal signs as end of the Base64 encoding\n  str = str.split('=')[0]\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = str.trim().replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  let codePoint\n  const length = string.length\n  let leadSurrogate = null\n  const bytes = []\n\n  for (let i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  const byteArray = []\n  for (let i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  let c, hi, lo\n  const byteArray = []\n  for (let i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  let i\n  for (i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\n// ArrayBuffer or Uint8Array objects from other contexts (i.e. iframes) do not pass\n// the `instanceof` check but they should be treated as of that type.\n// See: https://github.com/feross/buffer/issues/166\nfunction isInstance (obj, type) {\n  return obj instanceof type ||\n    (obj != null && obj.constructor != null && obj.constructor.name != null &&\n      obj.constructor.name === type.name)\n}\nfunction numberIsNaN (obj) {\n  // For IE11 support\n  return obj !== obj // eslint-disable-line no-self-compare\n}\n\n// Create lookup table for `toString('hex')`\n// See: https://github.com/feross/buffer/issues/219\nconst hexSliceLookupTable = (function () {\n  const alphabet = '0123456789abcdef'\n  const table = new Array(256)\n  for (let i = 0; i < 16; ++i) {\n    const i16 = i * 16\n    for (let j = 0; j < 16; ++j) {\n      table[i16 + j] = alphabet[i] + alphabet[j]\n    }\n  }\n  return table\n})()\n\n// Return not function with Error if BigInt not supported\nfunction defineBigIntMethod (fn) {\n  return typeof BigInt === 'undefined' ? BufferBigIntNotDefined : fn\n}\n\nfunction BufferBigIntNotDefined () {\n  throw new Error('BigInt not supported')\n}\n","// extracted by extract-css-chunks-webpack-plugin\nmodule.exports = {};","// extracted by extract-css-chunks-webpack-plugin\nmodule.exports = {\"nodeStrokeWidth\":\"0.8\",\"directionArrowSize\":\"6\",\"directionArrowWidth\":\"0.7\",\"node\":\"fornac-node\",\"directionArrow\":\"fornac-directionArrow\",\"plot\":\"fornac-plot\",\"selectedNode\":\"fornac-selectedNode\",\"nodeLabel\":\"fornac-nodeLabel\",\"link\":\"fornac-link\",\"plotLabel\":\"fornac-plotLabel\",\"transparent\":\"fornac-transparent\",\"dragLine\":\"fornac-dragLine\",\"mouseEventHelper\":\"fornac-mouseEventHelper\"};","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","// The MIT License (MIT)\n//\n// Copyright (c) 2014 Jonas Finnemann Jensen\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nmodule.exports = require('./slugid');\n","// The MIT License (MIT)\n//\n// Copyright (c) 2014 Jonas Finnemann Jensen\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nvar uuid = require('uuid');\n\n/** @type {(bytes: Uint8Array) => string} */\nvar toBase64 = (() => {\n  if (typeof Buffer !== 'undefined') {\n    return (bytes) => Buffer.from(bytes).toString('base64');\n  }\n  return (bytes) => btoa(String.fromCharCode(...bytes));\n})();\n\n/** @type {(base64: string) => Uint8Array | Buffer} */\nvar fromBase64 = (() => {\n  if (typeof Buffer !== 'undefined') {\n    return (base64) => Buffer.from(base64, 'base64');\n  }\n  return (base64) => Uint8Array.from(atob(base64), c => c.charCodeAt(0));\n})();\n\n/**\n * Returns the given uuid as a 22 character slug. This can be a regular v4\n * slug or a \"nice\" slug.\n */\nexports.encode = function(uuid_) {\n  var bytes   = uuid.parse(uuid_);\n  var base64 = toBase64(bytes);\n  var slug = base64\n              .replace(/\\+/g, '-')  // Replace + with - (see RFC 4648, sec. 5)\n              .replace(/\\//g, '_')  // Replace / with _ (see RFC 4648, sec. 5)\n              .substring(0, 22);    // Drop '==' padding\n  return slug;\n};\n\n/**\n * Returns the uuid represented by the given v4 or \"nice\" slug\n */\nexports.decode = function(slug) {\n  var base64 = slug\n                  .replace(/-/g, '+')\n                  .replace(/_/g, '/')\n                  + '==';\n  return uuid.stringify(fromBase64(base64));\n};\n\n/**\n * Returns a randomly generated uuid v4 compliant slug\n */\nexports.v4 = function() {\n  var bytes   = uuid.v4(null, new Uint8Array(16));\n  var base64 = toBase64(bytes);\n  var slug = base64\n              .replace(/\\+/g, '-')  // Replace + with - (see RFC 4648, sec. 5)\n              .replace(/\\//g, '_')  // Replace / with _ (see RFC 4648, sec. 5)\n              .substring(0, 22);    // Drop '==' padding\n  return slug;\n};\n\n/**\n * Returns a randomly generated uuid v4 compliant slug which conforms to a set\n * of \"nice\" properties, at the cost of some entropy. Currently this means one\n * extra fixed bit (the first bit of the uuid is set to 0) which guarantees the\n * slug will begin with [A-Za-f]. For example such slugs don't require special\n * handling when used as command line parameters (whereas non-nice slugs may\n * start with `-` which can confuse command line tools).\n *\n * Potentially other \"nice\" properties may be added in future to further\n * restrict the range of potential uuids that may be generated.\n */\nexports.nice = function() {\n  var bytes   = uuid.v4(null, new Uint8Array(16));\n  bytes[0] = bytes[0] & 0x7f;  // unset first bit to ensure [A-Za-f] first char\n  var base64 = toBase64(bytes);\n  var slug = base64\n              .replace(/\\+/g, '-')  // Replace + with - (see RFC 4648, sec. 5)\n              .replace(/\\//g, '_')  // Replace / with _ (see RFC 4648, sec. 5)\n              .substring(0, 22);    // Drop '==' padding\n  return slug;\n};\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import rng from './rng.js';\nimport stringify from './stringify.js'; // **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\n\nvar _clockseq; // Previous uuid creation time\n\n\nvar _lastMSecs = 0;\nvar _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details\n\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || new Array(16);\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n\n  if (node == null || clockseq == null) {\n    var seedBytes = options.random || (options.rng || rng)();\n\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];\n    }\n\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n\n\n  var msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)\n\n  var dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression\n\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n\n\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  } // Per 4.2.1.2 Throw error if too many uuids are requested\n\n\n  if (nsecs >= 10000) {\n    throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n\n  msecs += 12219292800000; // `time_low`\n\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff; // `time_mid`\n\n  var tmh = msecs / 0x100000000 * 10000 & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff; // `time_high_and_version`\n\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n\n  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n\n  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`\n\n  b[i++] = clockseq & 0xff; // `node`\n\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf || stringify(b);\n}\n\nexport default v1;","import validate from './validate.js';\n\nfunction parse(uuid) {\n  if (!validate(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  var v;\n  var arr = new Uint8Array(16); // Parse ########-....-....-....-............\n\n  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;\n  arr[1] = v >>> 16 & 0xff;\n  arr[2] = v >>> 8 & 0xff;\n  arr[3] = v & 0xff; // Parse ........-####-....-....-............\n\n  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;\n  arr[5] = v & 0xff; // Parse ........-....-####-....-............\n\n  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;\n  arr[7] = v & 0xff; // Parse ........-....-....-####-............\n\n  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;\n  arr[9] = v & 0xff; // Parse ........-....-....-....-############\n  // (Use \"/\" to avoid 32-bit truncation when bit-shifting high-order bytes)\n\n  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;\n  arr[11] = v / 0x100000000 & 0xff;\n  arr[12] = v >>> 24 & 0xff;\n  arr[13] = v >>> 16 & 0xff;\n  arr[14] = v >>> 8 & 0xff;\n  arr[15] = v & 0xff;\n  return arr;\n}\n\nexport default parse;","import stringify from './stringify.js';\nimport parse from './parse.js';\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  var bytes = [];\n\n  for (var i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nexport var DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport var URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function (name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = parse(namespace);\n    }\n\n    if (namespace.length !== 16) {\n      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    } // Compute hash of namespace and value, Per 4.3\n    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =\n    // hashfunc([...namespace, ... value])`\n\n\n    var bytes = new Uint8Array(16 + value.length);\n    bytes.set(namespace);\n    bytes.set(value, namespace.length);\n    bytes = hashfunc(bytes);\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (var i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return stringify(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","/*\n * Browser-compatible JavaScript MD5\n *\n * Modification of JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\nfunction md5(bytes) {\n  if (typeof bytes === 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Uint8Array(msg.length);\n\n    for (var i = 0; i < msg.length; ++i) {\n      bytes[i] = msg.charCodeAt(i);\n    }\n  }\n\n  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));\n}\n/*\n * Convert an array of little-endian words to an array of bytes\n */\n\n\nfunction md5ToHexEncodedArray(input) {\n  var output = [];\n  var length32 = input.length * 32;\n  var hexTab = '0123456789abcdef';\n\n  for (var i = 0; i < length32; i += 8) {\n    var x = input[i >> 5] >>> i % 32 & 0xff;\n    var hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);\n    output.push(hex);\n  }\n\n  return output;\n}\n/**\n * Calculate output length with padding and bit length\n */\n\n\nfunction getOutputLength(inputLength8) {\n  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction wordsToMd5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[getOutputLength(len) - 1] = len;\n  var a = 1732584193;\n  var b = -271733879;\n  var c = -1732584194;\n  var d = 271733878;\n\n  for (var i = 0; i < x.length; i += 16) {\n    var olda = a;\n    var oldb = b;\n    var oldc = c;\n    var oldd = d;\n    a = md5ff(a, b, c, d, x[i], 7, -680876936);\n    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5gg(b, c, d, a, x[i], 20, -373897302);\n    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5hh(d, a, b, c, x[i], 11, -358537222);\n    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5ii(a, b, c, d, x[i], 6, -198630844);\n    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safeAdd(a, olda);\n    b = safeAdd(b, oldb);\n    c = safeAdd(c, oldc);\n    d = safeAdd(d, oldd);\n  }\n\n  return [a, b, c, d];\n}\n/*\n * Convert an array bytes to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction bytesToWords(input) {\n  if (input.length === 0) {\n    return [];\n  }\n\n  var length8 = input.length * 8;\n  var output = new Uint32Array(getOutputLength(length8));\n\n  for (var i = 0; i < length8; i += 8) {\n    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;\n  }\n\n  return output;\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safeAdd(x, y) {\n  var lsw = (x & 0xffff) + (y & 0xffff);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bitRotateLeft(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5cmn(q, a, b, x, s, t) {\n  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n\nfunction md5ff(a, b, c, d, x, s, t) {\n  return md5cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5gg(a, b, c, d, x, s, t) {\n  return md5cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5hh(a, b, c, d, x, s, t) {\n  return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5ii(a, b, c, d, x, s, t) {\n  return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\nexport default md5;","import v35 from './v35.js';\nimport md5 from './md5.js';\nvar v3 = v35('v3', 0x30, md5);\nexport default v3;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  var K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  var H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (var i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  } else if (!Array.isArray(bytes)) {\n    // Convert Array-like to Array\n    bytes = Array.prototype.slice.call(bytes);\n  }\n\n  bytes.push(0x80);\n  var l = bytes.length / 4 + 2;\n  var N = Math.ceil(l / 16);\n  var M = new Array(N);\n\n  for (var _i = 0; _i < N; ++_i) {\n    var arr = new Uint32Array(16);\n\n    for (var j = 0; j < 16; ++j) {\n      arr[j] = bytes[_i * 64 + j * 4] << 24 | bytes[_i * 64 + j * 4 + 1] << 16 | bytes[_i * 64 + j * 4 + 2] << 8 | bytes[_i * 64 + j * 4 + 3];\n    }\n\n    M[_i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (var _i2 = 0; _i2 < N; ++_i2) {\n    var W = new Uint32Array(80);\n\n    for (var t = 0; t < 16; ++t) {\n      W[t] = M[_i2][t];\n    }\n\n    for (var _t = 16; _t < 80; ++_t) {\n      W[_t] = ROTL(W[_t - 3] ^ W[_t - 8] ^ W[_t - 14] ^ W[_t - 16], 1);\n    }\n\n    var a = H[0];\n    var b = H[1];\n    var c = H[2];\n    var d = H[3];\n    var e = H[4];\n\n    for (var _t2 = 0; _t2 < 80; ++_t2) {\n      var s = Math.floor(_t2 / 20);\n      var T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[_t2] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nexport default sha1;","import v35 from './v35.js';\nimport sha1 from './sha1.js';\nvar v5 = v35('v5', 0x50, sha1);\nexport default v5;","export default '00000000-0000-0000-0000-000000000000';","import validate from './validate.js';\n\nfunction version(uuid) {\n  if (!validate(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  return parseInt(uuid.substr(14, 1), 16);\n}\n\nexport default version;","module.exports = __WEBPACK_EXTERNAL_MODULE__893__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","export default __webpack_public_path__ + \"f2af291fa71518bfe54b7a54f6c30b05.svg\";","import './d3-context-menu.css';\r\nimport ArrowIcon from './img/play.svg';\r\n\r\nimport d3 from 'd3';\r\nimport slugid from 'slugid';\r\n\r\nexport function contextMenu(menu, opts) {\r\n    let previouslyMouseUp = false;\r\n    let clickAway = () => {};\r\n    let uid = slugid.nice();\r\n    let rootElement = null;\r\n    let orientation = 'right';   // display the menu to the right of the mouse click\r\n                                 // or parent elemement\r\n    let initialPos = null;\r\n    let parentStart = null;\r\n\r\n    var openCallback,\r\n        closeCallback;\r\n\r\n    if (typeof opts === 'function') {\r\n        openCallback = opts;\r\n    } else {\r\n        opts = opts || {};\r\n        openCallback = opts.onOpen;\r\n        closeCallback = opts.onClose;\r\n    }\r\n\r\n    if ('rootElement' in opts)\r\n        rootElement = opts['rootElement']\r\n\r\n    if ('pos' in opts) {\r\n        // do we want to place this menu somewhere specific?\r\n        initialPos = opts.pos;\r\n    }\r\n\r\n    if ('orientation' in opts) {\r\n        orientation = opts.orientation;\r\n    }\r\n\r\n    if ('parentStart' in opts) {\r\n        parentStart = opts.parentStart;\r\n    }\r\n\r\n    // create the div element that will hold the context menu\r\n    d3.selectAll('.d3-context-menu-' + uid).data([1])\r\n        .enter()\r\n        .append('div')\r\n        .classed('d3-context-menu', true)\r\n        .classed('d3-context-menu-' + uid, true)\r\n\r\n    // close menu\r\n    d3.select('body').on('click.d3-context-menu-' + uid, function() {\r\n        if (previouslyMouseUp) {\r\n            previouslyMouseUp = false;\r\n            return;\r\n        }\r\n       console.log('body click close');\r\n\r\n        d3.select('.d3-context-menu-' + uid).style('display', 'none');\r\n       orientation = 'right';\r\n\r\n        if (closeCallback) {\r\n            closeCallback();\r\n        }\r\n    });\r\n\r\n    // this gets executed when a contextmenu event occurs\r\n    return function(data, index, pMouseUp=false,\r\n                    clickAwayFunc = function() { } ) {\r\n        var elm = this;\r\n        var contextMenuPos = null;\r\n        let mousePos = null;\r\n        let currentThis = this;\r\n\r\n        if (rootElement == null)\r\n            mousePos = d3.mouse(this);\r\n        else\r\n            mousePos = d3.mouse(rootElement); // for recursive menus, we need the mouse\r\n                                              // position relative to another element\r\n\r\n        clickAway = clickAwayFunc;\r\n        let openChildMenuUid = null;\r\n\r\n        previouslyMouseUp = pMouseUp;\r\n\r\n        d3.selectAll('.d3-context-menu-' + uid).html('');\r\n        var list = d3.selectAll('.d3-context-menu-' + uid)\r\n            .on('contextmenu', function(d) {\r\n                console.log('context-menu close');\r\n                d3.select('.d3-context-menu-' + uid).style('display', 'none'); \r\n                orientation = 'right';\r\n\r\n                d3.event.preventDefault();\r\n                d3.event.stopPropagation();\r\n            })\r\n            .append('ul');\r\n\r\n        list.selectAll('li').data(typeof menu === 'function' ? menu(data) : menu).enter()\r\n            .append('li')\r\n            .attr('class', function(d) {\r\n                console.log('d:', d);\r\n                var ret = '';\r\n                if (d.divider) {\r\n                    ret += ' is-divider';\r\n                }\r\n                if (d.disabled) {\r\n                    ret += ' is-disabled';\r\n                }\r\n                if (!d.action) {\r\n                    ret += ' is-header';\r\n                }\r\n                if ('children' in d) {\r\n                    ret += ' d3-context-menu-recursive';\r\n                }\r\n                return ret;\r\n            })\r\n            .html(function(d) {\r\n                if (d.divider) {\r\n                    return '<hr>';\r\n                }\r\n                if (!d.title) {\r\n                    console.error('No title attribute set. Check the spelling of your options.');\r\n                }\r\n                return (typeof d.title === 'string') ? d.title : d.title(data);\r\n            })\r\n            .on('click', function(d, i) {\r\n                if (d.disabled) return; // do nothing if disabled\r\n                if (!d.action) return; // headers have no \"action\"\r\n                d.action(elm, data, index, mousePos);\r\n                console.log('click close');\r\n\r\n                // close all context menus\r\n                d3.selectAll('.d3-context-menu').style('display', 'none');\r\n                orientation = 'right';\r\n\r\n                if (closeCallback) {\r\n                    closeCallback();\r\n                }\r\n            })\r\n            .on('mouseenter', function(d, i) {\r\n                d3.select(this)\r\n                    .classed('d3-context-menu-selected', true)\r\n\r\n                if (openChildMenuUid != null) {\r\n                    // there's a child menu open\r\n\r\n                    // unselect all items\r\n                    d3.select('.d3-context-menu-' + uid)\r\n                        .selectAll('li')\r\n                        .classed('d3-context-menu-selected', false);\r\n\r\n                    if (typeof d.children == 'undefined') {\r\n                        console.log(\"no children close\");\r\n                        // no children, so hide any open child menus\r\n                        d3.select('.d3-context-menu-' + openChildMenuUid)\r\n                        .style('display', 'none');\r\n\r\n                        openChildMenuUid = null;\r\n                        return;\r\n                    }\r\n\r\n                    if (d.childUid == openChildMenuUid) {\r\n                        // the correct child menu is already open\r\n                        return;\r\n\r\n                    } else {\r\n                        // need to open a different child menu\r\n                        console.log('open different child menu close');\r\n                        \r\n                        // close the already open one\r\n                        d3.select('.d3-context-menu-' + openChildMenuUid)\r\n                        .style('display', 'none');\r\n\r\n                        openChildMenuUid = null;\r\n\r\n                    }\r\n                }             \r\n\r\n                // there should be no menu open right now\r\n                if (typeof d.children != 'undefined') {\r\n                    let boundingRect = this.getBoundingClientRect();\r\n\r\n                    let childrenContextMenu = null\r\n                    if (orientation == 'left') {\r\n                        childrenContextMenu = contextMenu(d.children, {'rootElement': currentThis,\r\n                              'pos': [ boundingRect.left + window.pageXOffset,\r\n                                    boundingRect.top - 2 + window.pageYOffset],\r\n                        'orientation': 'left'});\r\n                    } else {\r\n                        childrenContextMenu = contextMenu(d.children, \r\n                                      {\r\n                                          'pos': [ boundingRect.left + boundingRect.width + window.pageXOffset,\r\n                                                boundingRect.top - 2 + window.pageYOffset],\r\n                                       'rootElement': currentThis,\r\n                                    'parentStart': [boundingRect.left + window.pageXOffset,\r\n                                      boundingRect.top - 2 + window.pageYOffset]});\r\n                    }\r\n\r\n                    d.childUid = childrenContextMenu.apply(this, [data,i,true,\r\n                                                           function() { }]);\r\n                    openChildMenuUid = d.childUid;\r\n                }\r\n\r\n\r\n                d3.select(this)\r\n                    .classed('d3-context-menu-selected', true)\r\n            \r\n            })\r\n            .on('mouseleave', function(d, i) {\r\n\r\n                if (openChildMenuUid == null) {\r\n                    d3.select(this)\r\n                        .classed('d3-context-menu-selected', false);\r\n                }\r\n            });\r\n\r\n            list.selectAll('.d3-context-menu-recursive')\r\n            .append('img')\r\n            .attr('src', ArrowIcon)\r\n            .attr('width', '14px')\r\n            .attr('height', '14px')\r\n            .style('position', 'absolute')\r\n            .style('right', '5px')\r\n            ;\r\n\r\n        // the openCallback allows an action to fire before the menu is displayed\r\n        // an example usage would be closing a tooltip\r\n        if (openCallback) {\r\n            if (openCallback(data, index) === false) {\r\n                return uid;\r\n            }\r\n        }\r\n\r\n        let contextMenuSelection = d3.select('.d3-context-menu-' + uid)\r\n            .style('display', 'block');\r\n\r\n        if (initialPos == null) {\r\n            d3.select('.d3-context-menu-' + uid)\r\n            .style('left', (d3.event.pageX - 2) + 'px')\r\n            .style('top', (d3.event.pageY - 2) + 'px')\r\n        } else {\r\n            d3.select('.d3-context-menu-' + uid)\r\n            .style('left', initialPos[0] + 'px')\r\n            .style('top', initialPos[1] + 'px')\r\n        }\r\n\r\n        // check if the menu disappears off the side of the window\r\n        let boundingRect = contextMenuSelection.node().getBoundingClientRect();\r\n\r\n        if (boundingRect.left + boundingRect.width > window.innerWidth || orientation == 'left') {\r\n            orientation = 'left';\r\n\r\n            // menu goes of the end of the window, position it the other way\r\n            if (initialPos == null) {\r\n                // place the menu where the user clicked\r\n                d3.select('.d3-context-menu-' + uid)\r\n                .style('left', (d3.event.pageX - 2 - boundingRect.width) + 'px')\r\n                .style('top', (d3.event.pageY - 2) + 'px')\r\n            } else {\r\n                if (parentStart != null) {\r\n                    d3.select('.d3-context-menu-' + uid)\r\n                    .style('left', (parentStart[0] - boundingRect.width) + 'px')\r\n                    .style('top', parentStart[1] + 'px')\r\n                } else {\r\n                    d3.select('.d3-context-menu-' + uid)\r\n                    .style('left', (initialPos[0] - boundingRect.width) + 'px')\r\n                    .style('top', initialPos[1] + 'px')\r\n                }\r\n            }\r\n            \r\n        }\r\n\r\n        // display context menu\r\n\r\n        if (previouslyMouseUp)\r\n            return uid;\r\n\r\n        d3.event.preventDefault();\r\n        d3.event.stopPropagation();\r\n        //d3.event.stopImmediatePropagation();\r\n        //\r\n        return uid;\r\n    };\r\n};\r\n","var numberSort = function(a,b) { return a - b; };\r\n\r\nexport function arraysEqual(a, b) {\r\n    // courtesy of \r\n    // http://stackoverflow.com/questions/3115982/how-to-check-if-two-arrays-are-equal-with-javascript\r\n  if (a === b) return true;\r\n  if (a === null || b === null) return false;\r\n  if (a.length != b.length) return false;\r\n\r\n  // If you don't care about the order of the elements inside\r\n  // the array, you should sort both arrays here.\r\n\r\n  for (var i = 0; i < a.length; ++i) {\r\n    if (a[i] !== b[i]) return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nexport function RNAUtilities() {\r\n    var self = this;\r\n\r\n    // the brackets to use when constructing dotbracket strings\r\n    // with pseudoknots\r\n    self.bracketLeft =  \"([{<ABCDEFGHIJKLMNOPQRSTUVWXYZ\".split(\"\");\r\n    self.bracketRight = \")]}>abcdefghijklmnopqrstuvwxyz\".split(\"\");\r\n\r\n    self.inverseBrackets = function(bracket) {\r\n        var res = {};\r\n        for (var i = 0; i < bracket.length; i++) {\r\n            res[bracket[i]] = i;\r\n        }\r\n        return res;\r\n    };\r\n\r\n    self.maximumMatching = function maximumMatching(pt){\r\n        // Courtesy of the great Ronny Lorenz\r\n\r\n        var n = pt[0];\r\n        var TURN = 0;    //minimal number of nucleotides in the hairpin\r\n\r\n        /* array init */\r\n        var mm = new Array(n + 1);\r\n        for(var i = 0; i <= n; i++){\r\n            mm[i] = new Array(n + 1);\r\n            for(var j = i; j <= n; j++)\r\n            mm[i][j] = 0;\r\n        }\r\n        var maximum = 0;\r\n\r\n        /* actual computation */\r\n        for(var i = n - TURN - 1; i > 0; i--)\r\n\r\n        for(var j = i + TURN + 1; j <= n; j++){\r\n            maximum = mm[i][j-1];\r\n\r\n            for(var l = j - TURN - 1; l >= i; l--) {\r\n                if(pt[l] === j) {\r\n\r\n                    // we have a base pair here\r\n                    maximum = Math.max(maximum, ((l > i) ? mm[i][l-1] : 0) + 1 + ((j - l - 1 > 0) ? mm[l+1][j-1] : 0));\r\n                }\r\n            }\r\n\r\n            mm[i][j] = maximum;\r\n        }\r\n\r\n        maximum = mm[1][n];\r\n\r\n        return mm;\r\n    };\r\n\r\n    self.backtrackMaximumMatching = function(mm, oldPt) {\r\n      var pt = Array.apply(null, \r\n                           Array(mm.length)).map(function() { return 0 }); \r\n                           //create an array containing zeros\r\n\r\n      self.mmBt(mm, pt, oldPt, 1, mm.length-1);\r\n      return pt;\r\n    }\r\n\r\n    self.mmBt = function(mm, pt, oldPt, i, j){\r\n        // Create a pairtable from the backtracking\r\n      var maximum = mm[i][j];\r\n      var TURN = 0;\r\n\r\n      if(j - i - 1 < TURN) return;    /* no more pairs */\r\n\r\n      if(mm[i][j-1] == maximum){      /* j is unpaired */\r\n        self.mmBt(mm, pt, oldPt, i, j-1);\r\n        return;\r\n      }\r\n\r\n      for(var q = j - TURN - 1; q >= i; q--){  /* j is paired with some q */\r\n        if (oldPt[j] !== q)\r\n            continue;\r\n\r\n        var leftPart     = (q > i) ? mm[i][q-1] : 0;\r\n        var enclosedPart = (j - q - 1 > 0) ? mm[q+1][j-1] : 0;\r\n\r\n        if(leftPart + enclosedPart + 1 == maximum) {\r\n            // there's a base pair between j and q\r\n            pt[q] = j;\r\n            pt[j] = q;\r\n\r\n            if(i < q) \r\n                self.mmBt(mm, pt, oldPt, i, q - 1);\r\n\r\n            self.mmBt(mm, pt, oldPt, q + 1, j - 1);\r\n            return;\r\n        }\r\n      }\r\n\r\n      //alert(i + \",\" + j + \": backtracking failed!\");\r\n      console.log('FAILED!!!' + i + ',' + j + ': backtracking failed!');\r\n\r\n    };\r\n\r\n    self.dotbracketToPairtable = function(dotbracket) {\r\n        // create an array and initialize it to 0\r\n        var pt = Array.apply(null, new Array(dotbracket.length + 1)).map(Number.prototype.valueOf,0);\r\n        \r\n        //  the first element is always the length of the RNA molecule\r\n        pt[0] = dotbracket.length;\r\n\r\n        // store the pairing partners for each symbol\r\n        var stack = {};\r\n        for (var i = 0; i < self.bracketLeft.length; i++) {\r\n            stack[i] = [];\r\n        }\r\n\r\n        // lookup the index of each symbol in the bracket array\r\n        var inverseBracketLeft = self.inverseBrackets(self.bracketLeft);\r\n        var inverseBracketRight = self.inverseBrackets(self.bracketRight);\r\n\r\n        for (var i = 0; i < dotbracket.length; i++) {\r\n            var a = dotbracket[i];\r\n            var ni = i + 1;\r\n\r\n            if (a == '.' || a == 'o') {\r\n                // unpaired\r\n                pt[ni] = 0;\r\n            } else {\r\n                if (a in inverseBracketLeft) {\r\n                    // open pair?\r\n                    stack[inverseBracketLeft[a]].push(ni);\r\n                } else if (a in inverseBracketRight){\r\n                    // close pair?\r\n                    var j = stack[inverseBracketRight[a]].pop();\r\n\r\n                    pt[ni] = j;\r\n                    pt[j] = ni;\r\n                } else {\r\n                    throw \"Unknown symbol in dotbracket string\";\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var key in stack) {\r\n            if (stack[key].length > 0) {\r\n                throw \"Unmatched base at position \" + stack[key][0];\r\n            }\r\n        }\r\n\r\n        return pt;\r\n    };\r\n\r\n    self.insertIntoStack = function(stack, i, j) {\r\n        var k = 0;\r\n        while (stack[k].length > 0 && stack[k][stack[k].length - 1] < j) {\r\n            k += 1;\r\n        }\r\n\r\n        stack[k].push(j);\r\n        return k;\r\n    };\r\n\r\n    self.deleteFromStack = function(stack, j) {\r\n        var k = 0;\r\n        while (stack[k].length === 0 || stack[k][stack[k].length-1] != j) {\r\n            k += 1;\r\n        }\r\n        stack[k].pop();\r\n        return k;\r\n    };\r\n\r\n    self.pairtableToDotbracket = function(pt) {\r\n        // store the pairing partners for each symbol\r\n        var stack = {};\r\n        for (var i = 0; i < pt[0]; i++) {\r\n            stack[i] = [];\r\n        }\r\n\r\n        var seen = {};\r\n        var res = \"\";\r\n        var i;\r\n        for (var i = 1; i < pt[0] + 1; i++) {\r\n            if (pt[i] !== 0 && pt[i] in seen) {\r\n                throw \"Invalid pairtable contains duplicate entries\";\r\n            }\r\n            seen[pt[i]] = true;\r\n\r\n            if (pt[i] === 0) {\r\n                res += '.';\r\n            } else {\r\n                if (pt[i] > i) {\r\n                    res += self.bracketLeft[self.insertIntoStack(stack, i, pt[i])];\r\n                } else {\r\n                    res += self.bracketRight[self.deleteFromStack(stack, i)];\r\n                }\r\n            }\r\n        }\r\n\r\n        return res;\r\n    };\r\n\r\n    self.findUnmatched = function(pt, from, to) {\r\n        /*\r\n         * Find unmatched nucleotides in this molecule.\r\n         */\r\n        var toRemove = [];\r\n        var unmatched = [];\r\n\r\n        var origFrom = from;\r\n        var origTo = to;\r\n        var i;\r\n\r\n        for (var i = from; i <= to; i++)\r\n            if (pt[i] !== 0 && (pt[i] < from || pt[i] > to))\r\n                unmatched.push([i,pt[i]]);\r\n\r\n        for (var i = origFrom; i <= origTo; i++) {\r\n            while (pt[i] === 0 && i <= origTo) i++;\r\n\r\n            to = pt[i];\r\n\r\n            while (pt[i] === to) {\r\n                i++;\r\n                to--;\r\n            }\r\n            \r\n            toRemove = toRemove.concat(self.findUnmatched(pt, i, to));\r\n        }\r\n\r\n        if (unmatched.length > 0)\r\n            toRemove.push(unmatched);\r\n\r\n        return toRemove;\r\n    };\r\n\r\n    self.removePseudoknotsFromPairtable = function(pt) {\r\n        /* Remove the pseudoknots from this structure in such a fashion\r\n         * that the least amount of base-pairs need to be broken\r\n         *\r\n         * The pairtable is manipulated in place and a list of tuples\r\n         * indicating the broken base pairs is returned.\r\n         */\r\n\r\n        var mm = self.maximumMatching(pt);\r\n        var newPt = self.backtrackMaximumMatching(mm, pt);\r\n        var removed = [];\r\n\r\n        for (var i = 1; i < pt.length; i++) {\r\n            if (pt[i] < i)\r\n                continue;\r\n\r\n            if (newPt[i] != pt[i])  {\r\n                removed.push([i, pt[i]]);\r\n                pt[pt[i]] = 0;\r\n                pt[i] = 0;\r\n            }\r\n        }\r\n\r\n        return removed;\r\n    };\r\n\r\n    self.ptToElements = function(pt, level, i, j, dotBracketBreaks) {\r\n        /* Convert a pair table to a list of secondary structure \r\n         * elements:\r\n         *\r\n         * [['s',1,[2,3]]\r\n         *\r\n         * The 's' indicates that an element can be a stem. It can also be\r\n         * an interior loop ('i'), a hairpin loop ('h') or a multiloop ('m')\r\n         *\r\n         * The second number (1 in this case) indicates the depth or\r\n         * how many base pairs have to be broken to get to this element.\r\n         *\r\n         * Finally, there is the list of nucleotides which are part of\r\n         * of this element.\r\n         */\r\n        var elements = [];\r\n        var u5 = [i-1];\r\n        var u3 = [j+1];\r\n\r\n        if (arguments.length < 5)\r\n            dotBracketBreaks = [];\r\n\r\n        if (i > j)\r\n            return [];\r\n            \r\n            //iterate over the unpaired regions on either side\r\n            //this is either 5' and 3' unpaired if level == 0\r\n            //or an interior loop or a multiloop\r\n            for (; pt[i] === 0; i++) { u5.push(i); }\r\n            for (; pt[j] === 0; j--) { u3.push(j); }\r\n\r\n            if (i > j) {\r\n                //hairpin loop or one large unpaired molecule\r\n                u5.push(i);\r\n                if (level === 0)\r\n                    return [['e',level, u5.sort(numberSort)]];\r\n                else {\r\n                    // check to see if we have chain breaks due\r\n                    // to multiple strands in the input\r\n                    var external = false;\r\n                    var left = [];\r\n                    var right = [];\r\n                    for (var k = 0; k < u5.length; k++) {\r\n                        if (external)\r\n                            right.push(u5[k]);\r\n                        else\r\n                            left.push(u5[k]);\r\n\r\n                        if (dotBracketBreaks.indexOf(u5[k]) >= 0)\r\n                            external = true;\r\n                    }\r\n\r\n                    if (external) {\r\n                        return [['h',level, u5.sort(numberSort)]];\r\n                    }\r\n                    else\r\n                        // if not, this is a simple hairpin loop\r\n                        return [['h',level, u5.sort(numberSort)]];\r\n                }\r\n            }\r\n\r\n            if (pt[i] != j) {\r\n                //multiloop\r\n                var m = u5;\r\n                var k = i;\r\n\r\n                // the nucleotide before and the starting nucleotide\r\n                m.push(k);\r\n                while (k <= j) {\r\n                    // recurse into a stem\r\n                    elements = elements.concat(self.ptToElements(pt, level, k, pt[k], dotBracketBreaks));\r\n\r\n                    // add the nucleotides between stems\r\n                    m.push(pt[k]);\r\n                    k = pt[k] + 1;\r\n                    for (; pt[k] === 0 && k <= j; k++) { m.push(k);}\r\n                    m.push(k);\r\n                }\r\n                m.pop();\r\n                m = m.concat(u3);\r\n                \r\n                if (m.length > 0) {\r\n                    if (level === 0)\r\n                        elements.push(['e', level, m.sort(numberSort)]);\r\n                    else\r\n                        elements.push(['m', level, m.sort(numberSort)]);\r\n                }\r\n                \r\n                return elements;\r\n            }\r\n\r\n            if (pt[i] === j) {\r\n                //interior loop\r\n                u5.push(i);\r\n                u3.push(j);\r\n\r\n                var combined = u5.concat(u3);\r\n                if (combined.length > 4) {\r\n                    if (level === 0)\r\n                        elements.push(['e',level, u5.concat(u3).sort(numberSort)]);\r\n                    else\r\n                        elements.push(['i',level, u5.concat(u3).sort(numberSort)]);\r\n                }\r\n            } \r\n\r\n            var s = [];\r\n            //go through the stem\r\n            while (pt[i] === j && i < j) {\r\n                //one stem\r\n                s.push(i);\r\n                s.push(j);\r\n\r\n                i += 1;\r\n                j -= 1;\r\n\r\n                level += 1;\r\n            }\r\n\r\n            u5 = [i-1];\r\n            u3 = [j+1];\r\n            elements.push(['s', level, s.sort(numberSort)]);\r\n\r\n        return elements.concat(self.ptToElements(pt, level, i, j, dotBracketBreaks));\r\n    };\r\n\r\n}\r\n\r\nexport var rnaUtilities = new RNAUtilities();\r\n\r\nexport function ColorScheme(colorsText) {\r\n    var self = this;\r\n    self.colorsText = colorsText;\r\n\r\n    self.parseRange = function(rangeText) {\r\n        //parse a number range such as 1-10 or 3,7,9 or just 7\r\n        var parts = rangeText.split(',')\r\n        var nums = [];\r\n\r\n        for (var i = 0; i < parts.length; i++) {\r\n            //could be 1 or 10-11  or something like that\r\n            var parts1 = parts[i].split('-');\r\n\r\n            if (parts1.length == 1)\r\n                nums.push(parseInt(parts1[0]));\r\n            else if (parts1.length == 2) {\r\n                var from = parseInt(parts1[0]);\r\n                var to = parseInt(parts1[1]);\r\n\r\n                // add each number in this range\r\n                for (var j = from; j <= to; j++) \r\n                    nums.push(j)\r\n            } else {\r\n                console.log('Malformed range (too many dashes):', rangeText);\r\n            }\r\n        }\r\n\r\n        return nums;\r\n    }\r\n\r\n    self.parseColorText = function(colorText) {\r\n        /* Parse the text of an RNA color string. Instructions and description\r\n         * of the format are given below.\r\n         *\r\n         * The return is a json double dictionary indexed first by the \r\n         * molecule name, then by the nucleotide. This is then applied\r\n         * by force.js to the RNAs it is displaying. When no molecule\r\n         * name is specified, the color is applied to all molecules*/\r\n        var lines = colorText.split('\\n');\r\n        var currMolecule = '';\r\n        var counter = 1;\r\n        var colorsJson = {colorValues: {'':{}}, range:['white', 'steelblue']};\r\n        var domainValues = [];\r\n\r\n\r\n        for (var i = 0; i < lines.length; i++) {\r\n\r\n            if (lines[i][0] == '>') {\r\n                // new molecule\r\n                currMolecule = lines[i].trim().slice(1);\r\n                counter = 1;\r\n\r\n                colorsJson.colorValues[currMolecule] = {};\r\n                continue;\r\n            }\r\n\r\n            let words = lines[i].trim().split(/[\\s]+/);\r\n\r\n            for (var j = 0; j < words.length; j++) {\r\n                if (isNaN(words[j])) {\r\n                    if (words[j].search('range') === 0) {\r\n                        //there's a color scale in this entry\r\n                        let parts = words[j].split('=');\r\n                        let partsRight = parts[1].split(':')\r\n                        colorsJson.range = [partsRight[0], partsRight[1]];\r\n                        continue;\r\n                    }\r\n\r\n                    if (words[j].search('domain') == 0) {\r\n                        //there's a color scale in this entry\r\n                        let parts = words[j].split('=');\r\n                        let partsRight = parts[1].split(':')\r\n                        colorsJson.domain = [partsRight[0], partsRight[1]];\r\n                        continue;\r\n                    }\r\n\r\n                    // it's not a number, should be a combination \r\n                    // of a number (nucleotide #) and a color\r\n                    let parts = words[j].split(':');\r\n                    let nums = self.parseRange(parts[0]);\r\n                    let color = parts[1]\r\n\r\n                    for (var k = 0; k < nums.length; k++) {\r\n                        if (isNaN(color)) {\r\n                            colorsJson.colorValues[currMolecule][nums[k]] = color;\r\n                        } else {\r\n                            colorsJson.colorValues[currMolecule][nums[k]] = +color;\r\n                            domainValues.push(Number(color));\r\n                        }\r\n                    }\r\n                } else {\r\n                    //it's a number, so we add it to the list of values\r\n                    //seen for this molecule\r\n                    colorsJson.colorValues[currMolecule][counter] = Number(words[j]);\r\n                    counter += 1;\r\n\r\n                    domainValues.push(Number(words[j]));\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!('domain' in colorsJson))\r\n            colorsJson.domain = [Math.min.apply(null, domainValues), Math.max.apply(null, domainValues)];\r\n\r\n        self.colorsJson = colorsJson;\r\n\r\n        return self;\r\n    };\r\n\r\n    self.normalizeColors = function() {\r\n        /* \r\n         * Normalize the passed in values so that they range from\r\n         * 0 to 1\r\n         */\r\n        var value;\r\n\r\n        for (var moleculeName in self.colorsJson) {\r\n            var minNum = Number.MAX_VALUE;\r\n            var maxNum = Number.MIN_VALUE;\r\n\r\n            // iterate once to find the min and max values;\r\n            for (var resnum in self.colorsJson.colorValues[moleculeName]) {\r\n                value = self.colorsJson.colorValues[moleculeName][resnum];\r\n                if (typeof value == 'number') {\r\n                    if (value < minNum)\r\n                        minNum = value;\r\n                    if (value > maxNum)\r\n                        maxNum = value;\r\n                }\r\n            }\r\n\r\n            // iterate again to normalize\r\n            for (resnum in self.colorsJson.colorValues[moleculeName]) {\r\n                value = self.colorsJson.colorValues[moleculeName][resnum];\r\n                if (typeof value == 'number') {\r\n                    self.colorsJson.colorValues[moleculeName][resnum] = (value - minNum ) / (maxNum - minNum);\r\n                }\r\n            }\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.parseColorText(self.colorsText);\r\n    return self;\r\n}\r\n","import {arraysEqual,RNAUtilities,rnaUtilities} from './rnautils.js';\r\nimport slugid from 'slugid';\r\n\r\nvar numberSort = function(a,b) { return a - b; };\r\n\r\nif (typeof(String.prototype.trim) === 'undefined') {\r\n    String.prototype.trim = function() {\r\n        return String(this).replace(/^\\s+|\\s+$/g, '');\r\n    };\r\n}\r\n\r\nexport function ProteinGraph(structName, size, uid) {\r\n    var self = this;\r\n\r\n    self.type = 'protein';\r\n    self.size = size;\r\n    self.nodes = [{'name': 'P',\r\n                   'num': 1,\r\n                   'radius': 3 *  Math.sqrt(size),\r\n                   'rna': self,\r\n                   'nodeType': 'protein',\r\n                   'structName': structName,\r\n                   'elemType': 'p',\r\n                   'size': size,\r\n                   'uid': slugid.nice()}];\r\n\r\n    self.links = [];\r\n    self.uid = slugid.nice();\r\n\r\n    self.addUids = function(uids) {\r\n        for (let i = 0; i < uids.length; i++)\r\n            self.nodes[i].uid = uids[i];\r\n\r\n        return self;\r\n    };\r\n\r\n    self.getUids = function() {\r\n        /* Get the positions of each node so that they\r\n         * can be passed to elementsToJson later\r\n         */\r\n        uids = [];\r\n        for (let i = 0; i < self.dotbracket.length; i++)\r\n            uids.push(self.nodes[i].uid);\r\n\r\n        return uids;\r\n    };\r\n\r\n}\r\n\r\nexport function RNAGraph(seq = '', dotbracket = '', structName = '', startNumber = 1) {\r\n    var self = this;\r\n\r\n    self.type = 'rna';\r\n    self.circularizeExternal = false;\r\n    self.seq = seq;\r\n    self.dotbracket = dotbracket;  //i.e. ..((..))..\r\n    self.structName = structName;\r\n    self.circular = false;\r\n\r\n    if (self.dotbracket.slice(-1) == '*') {\r\n        //circular RNA\r\n        self.dotbracket = self.dotbracket.slice(0, -1);\r\n        self.circular = true;\r\n    }\r\n\r\n    self.uid = slugid.nice();\r\n\r\n    self.elements = [];            //store the elements and the\r\n                                   //nucleotides they contain\r\n    self.pseudoknotPairs = [];\r\n    self.nucsToNodes = {};\r\n\r\n    self.addUids = function(uids) {\r\n        let nucleotideNodes = self.nodes.filter(function(d) { return d.nodeType == 'nucleotide'; });\r\n\r\n        for (let i = 0; i < uids.length && i < nucleotideNodes.length; i++) {\r\n            nucleotideNodes[i].uid = uids[i];\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.computePairtable = function() {\r\n        self.pairtable = rnaUtilities.dotbracketToPairtable(self.dotbracket);\r\n    };\r\n\r\n    self.removeBreaks = function(targetString) {\r\n        // Remove all chain breaks (denoted with a '&', which indicate\r\n        // that the input represents more than one strand)\r\n        var breaks = [];\r\n        var breakIndex = -1;\r\n\r\n        while ((breakIndex = targetString.indexOf('&')) >= 0) {\r\n            breaks.push(breakIndex);\r\n            targetString = targetString.substring(0, breakIndex) + targetString.substring(breakIndex+1, targetString.length);\r\n\r\n        }\r\n\r\n        return {targetString: targetString,  breaks: breaks};\r\n    };\r\n\r\n    var ret = self.removeBreaks(self.dotbracket);\r\n    self.dotbracket = ret.targetString;\r\n    self.dotBracketBreaks = ret.breaks;\r\n\r\n    ret = self.removeBreaks(self.seq);\r\n    self.seq = ret.targetString;\r\n    self.seqBreaks = ret.breaks;\r\n\r\n    self.rnaLength = self.dotbracket.length;\r\n\r\n    if (!arraysEqual(self.dotBracketBreaks, self.seqBreaks)) {\r\n        console.log('WARNING: Sequence and structure breaks not equal');\r\n        console.log('WARNING: Using the breaks in the structure');\r\n    }\r\n\r\n    self.computePairtable();\r\n\r\n    self.addPositions = function(nodeType, positions) {\r\n        let labelNodes = self.nodes.filter(function(d) { return d.nodeType == nodeType; });\r\n\r\n        for  (let i = 0; i < labelNodes.length; i++) {\r\n            labelNodes[i].x = positions[i][0];\r\n            labelNodes[i].y = positions[i][1];\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.breakNodesToFakeNodes = function() {\r\n        // convert all the nodes following breaks to fake nodes\r\n        let labelNodes = self.nodes.filter(function(d) { return d.nodeType == 'nucleotide'; });\r\n\r\n        // if a node was an artifical break node, convert it to a middle\r\n        for (let i = 0; i < labelNodes.length; i++) {\r\n            if (self.dotBracketBreaks.indexOf(i) >= 0) {\r\n                labelNodes[i].nodeType = 'middle';\r\n                labelNodes[i+1].nodeType = 'middle';\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < self.elements.length; i++) {\r\n            var broken = false;\r\n\r\n            // change the elemType of the other nodes in the element containing\r\n            // the break\r\n            for (let j = 0; j < self.elements[i][2].length; j++) {\r\n                if (self.dotBracketBreaks.indexOf(self.elements[i][2][j]) >= 0)\r\n                    broken = true;\r\n            }\r\n\r\n            if (broken) {\r\n                self.elements[i][2].map(function(x) {\r\n                    if (x == 0)\r\n                        return;\r\n                    self.nodes[x-1].elemType = 'e';\r\n                });\r\n            } else {\r\n                self.elements[i][2].map(function(x) {\r\n                    if (x == 0)\r\n                        return;\r\n                    self.nodes[x-1].elemType = self.elements[i][0];\r\n                });\r\n            }\r\n        }\r\n        return self;\r\n    };\r\n\r\n    self.getPositions = function(nodeType) {\r\n        var positions = [];\r\n        let nucleotideNodes = self.nodes.filter(function(d) { return d.nodeType == nodeType; });\r\n\r\n        for (let i = 0; i < nucleotideNodes.length; i++)\r\n            positions.push([nucleotideNodes[i].x, nucleotideNodes[i].y]);\r\n\r\n        return positions;\r\n    };\r\n\r\n    self.getUids = function() {\r\n        /* Get the positions of each node so that they\r\n         * can be passed to elementsToJson later\r\n         */\r\n        var uids = [];\r\n        for (let i = 0; i < self.dotbracket.length; i++)\r\n            uids.push(self.nodes[i].uid);\r\n\r\n        return uids;\r\n    };\r\n\r\n    self.reinforceStems = function() {\r\n        var pt = self.pairtable;\r\n        let relevantElements = self.elements.filter( function(d) {\r\n            return d[0] == 's' && d[2].length >= 4;\r\n        });\r\n\r\n        for (let i = 0; i < relevantElements.length; i++) {\r\n            let allNucs = relevantElements[i][2];\r\n            let nucs = allNucs.slice(0, allNucs.length / 2);\r\n\r\n            for (let j = 0; j < nucs.length-1; j++) {\r\n                self.addFakeNode([nucs[j], nucs[j+1], pt[nucs[j+1]], pt[nucs[j]]]);\r\n            }\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.reinforceLoops = function() {\r\n        /*\r\n         * Add a set of fake nodes to enforce the structure\r\n         */\r\n        var filterNucs = function(d) {\r\n            return d !== 0 && d <= self.dotbracket.length;\r\n        };\r\n\r\n        for (let i = 0; i < self.elements.length; i++) {\r\n            if (self.elements[i][0] == 's' || (!self.circularizeExternal && self.elements[i][0] == 'e'))\r\n                continue;\r\n\r\n            var nucs = self.elements[i][2].filter(filterNucs);\r\n\r\n            if (self.elements[i][0] == 'e') {\r\n                var newNode1 = {'name': '',\r\n                    'num': -3,\r\n                    //'radius': 18 * radius -6,\r\n                    'radius': 0,\r\n                    'rna': self,\r\n                    'nodeType': 'middle',\r\n                    'elemType': 'f',\r\n                    'nucs': [],\r\n                    'x': self.nodes[self.rnaLength-1].x,\r\n                    'y': self.nodes[self.rnaLength-1].y,\r\n                    'px': self.nodes[self.rnaLength-1].px,\r\n                    'py': self.nodes[self.rnaLength-1].py,\r\n                    'uid': slugid.nice() };\r\n                var newNode2 = {'name': '',\r\n                    'num': -2,\r\n                    //'radius': 18 * radius -6,\r\n                    'radius': 0,\r\n                    'rna': self,\r\n                    'nodeType': 'middle',\r\n                    'elemType': 'f',\r\n                    'nucs': [],\r\n                    'x': self.nodes[0].x,\r\n                    'y': self.nodes[0].y,\r\n                    'px': self.nodes[0].px,\r\n                    'py': self.nodes[0].py,\r\n                    'uid': slugid.nice() };\r\n\r\n                    nucs.push(self.nodes.length+1);\r\n                    nucs.push(self.nodes.length+2);\r\n                    self.nodes.push(newNode1);\r\n                    self.nodes.push(newNode2);\r\n            }\r\n\r\n\r\n            self.addFakeNode(nucs);\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.updateLinkUids = function() {\r\n        for (let i = 0; i < self.links.length; i++) {\r\n            self.links[i].uid = self.links[i].source.uid + self.links[i].target.uid;\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.addFakeNode = function(nucs) {\r\n        var linkLength = 18; //make sure this is consistent with the value in force.js\r\n        var nodeWidth = 6;\r\n        var angle = (3.1415 * 2) / (2 * nucs.length);\r\n        var radius =  linkLength / (2 * Math.tan(angle));\r\n\r\n        var fakeNodeUid = '';\r\n\r\n        for (let i = 0; i < nucs.length; i++)\r\n            fakeNodeUid += self.nodes[nucs[i]-1].uid;\r\n\r\n        var newNode = {'name': '',\r\n                         'num': -1,\r\n                         //'radius': 18 * radius -6,\r\n                         'radius': radius,\r\n                         'rna': self,\r\n                         'nodeType': 'middle',\r\n                         'elemType': 'f',\r\n                         'nucs': nucs,\r\n                         'uid': fakeNodeUid };\r\n        self.nodes.push(newNode);\r\n\r\n        var newX = 0;\r\n        var newY = 0;\r\n        var coordsCounted = 0;\r\n\r\n        angle = (nucs.length - 2) * 3.14159 / (2 * nucs.length);\r\n        radius = 0.5 / Math.cos(angle);\r\n\r\n        for (let j = 0; j < nucs.length; j++) {\r\n            if (nucs[j] === 0 || nucs[j] > self.dotbracket.length)\r\n                continue;\r\n\r\n            //link to the center node\r\n            self.links.push({'source': self.nodes[nucs[j] - 1],\r\n                             'target': self.nodes[self.nodes.length-1],\r\n                             'linkType': 'fake',\r\n                             'value': radius,\r\n                             'uid': slugid.nice() });\r\n\r\n            if (nucs.length > 4) {\r\n                //link across the loop\r\n                self.links.push({'source': self.nodes[nucs[j] - 1],\r\n                                 'target': self.nodes[nucs[(j + Math.floor(nucs.length / 2)) % nucs.length] - 1],\r\n                                 'linkType': 'fake',\r\n                                 'value': radius * 2,\r\n                                 'uid': slugid.nice() });\r\n            }\r\n\r\n            var ia = ((nucs.length - 2) * 3.14159) / nucs.length;\r\n            var c = 2 * Math.cos(3.14159 / 2 - ia / 2);\r\n            //link to over-neighbor\r\n            self.links.push({'source': self.nodes[nucs[j] - 1],\r\n                             'target': self.nodes[nucs[(j + 2) % nucs.length] - 1],\r\n                             'linkType': 'fake',\r\n                             'value': c});\r\n\r\n            // calculate the mean of the coordinats in this loop\r\n            // and place the fake node there\r\n            var fromNode = self.nodes[nucs[j]-1];\r\n            if ('x' in fromNode) {\r\n                newX += fromNode.x;\r\n                newY += fromNode.y;\r\n\r\n                coordsCounted += 1;\r\n            }\r\n        }\r\n\r\n        if (coordsCounted > 0) {\r\n            // the nucleotides had set positions so we can calculate the position\r\n            // of the fake node\r\n            newNode.x = newX / coordsCounted;\r\n            newNode.y = newY / coordsCounted;\r\n            newNode.px = newNode.x;\r\n            newNode.py = newNode.y;\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.connectFakeNodes = function() {\r\n        var linkLength = 18;\r\n\r\n        // We want to be able to connect all of the fake nodes\r\n        // and create a structure consisting of just them\r\n        var filterOutNonFakeNodes = function(d) {\r\n            return d.nodeType == 'middle';\r\n        }\r\n\r\n        var nucsToNodes = {};\r\n        var fakeNodes = self.nodes.filter(filterOutNonFakeNodes);\r\n        var linked = {};\r\n\r\n        // initialize the nucleotides to nodes\r\n        for (var i = 1; i <= self.nodes.length; i++)\r\n            nucsToNodes[i] = [];\r\n\r\n        for (var i = 0; i < fakeNodes.length; i++) {\r\n            var thisNode = fakeNodes[i];\r\n\r\n            // each fake node represents a certain set of nucleotides (thisNode.nucs)\r\n            for (var j = 0; j < thisNode.nucs.length; j++) {\r\n                var thisNuc = thisNode.nucs[j];\r\n\r\n                // check to see if this nucleotide has been seen in another fake node\r\n                // if it has, then we add a link between the two nodes\r\n                for (var k = 0; k < nucsToNodes[thisNuc].length; k++) {\r\n                    if (JSON.stringify([nucsToNodes[thisNuc][k].uid, thisNode.uid].sort()) in linked)\r\n                        continue; //already linked\r\n\r\n                    var distance = nucsToNodes[thisNuc][k].radius + thisNode.radius;\r\n\r\n                    self.links.push({'source': nucsToNodes[thisNuc][k],\r\n                                      'target': thisNode,\r\n                                      'value': distance / linkLength,\r\n                                      'linkType': 'fake_fake'});\r\n\r\n                    // note that we've already seen this link\r\n                    linked[JSON.stringify([nucsToNodes[thisNuc][k].uid, thisNode.uid].sort())] = true;\r\n                }\r\n\r\n                nucsToNodes[thisNuc].push(thisNode);\r\n            }\r\n        }\r\n\r\n        return self;\r\n\r\n    };\r\n\r\n    self.addExtraLinks = function(extraLinks) {\r\n        if (typeof extraLinks == 'undefined')\r\n            return self;\r\n\r\n        for (var i = 0; i < extraLinks.length; i++) {\r\n            var source = self.getNodeFromNucleotides(extraLinks[i].from);\r\n            var target = self.getNodeFromNucleotides(extraLinks[i].to);\r\n\r\n            var newLink = {'source': source, 'target': target, 'linkType': 'extra',\r\n                'extraLinkType': extraLinks[i].linkType, 'uid': slugid.nice() };\r\n\r\n                self.links.push(newLink);\r\n        }\r\n\r\n        return self;\r\n    }\r\n\r\n\r\n    self.elementsToJson = function() {\r\n        /* Convert a set of secondary structure elements to a json\r\n         * representation of the graph that can be used with d3's\r\n         * force-directed layout to generate a visualization of\r\n         * the structure.\r\n         */\r\n        var pt = self.pairtable;\r\n        var elements = self.elements;\r\n\r\n        self.nodes = [];\r\n        self.links = [];\r\n\r\n        //create a reverse lookup so we can find out the type\r\n        //of element that a node is part of\r\n        var elemTypes = {};\r\n\r\n        //sort so that we count stems last\r\n        self.elements.sort();\r\n\r\n        for (let i = 0; i < self.elements.length; i++) {\r\n            var nucs = self.elements[i][2];\r\n            for (let j = 0; j < nucs.length; j++) {\r\n                elemTypes[nucs[j]] = self.elements[i][0];\r\n            }\r\n        }\r\n\r\n        for (let i = 1; i <= pt[0]; i++) {\r\n            var nodeName = self.seq[i-1];\r\n\r\n            if (self.dotBracketBreaks.indexOf(i-1) >= 0 ||\r\n                self.dotBracketBreaks.indexOf(i-2) >= 0) {\r\n                nodeName = '';\r\n            }\r\n\r\n            //create a node for each nucleotide\r\n            self.nodes.push({'name': nodeName,\r\n                             'num': startNumber + i - 1,\r\n                             'radius': 5,\r\n                             'rna': self,\r\n                             'nodeType': 'nucleotide',\r\n                             'structName': self.structName,\r\n                             'elemType': elemTypes[i],\r\n                             'uid': slugid.nice(),\r\n                             'linked': false});\r\n        }\r\n\r\n        for (let i = 0; i < self.nodes.length; i++) {\r\n            if (i === 0)\r\n                self.nodes[i].prevNode = null;\r\n            else {\r\n                self.nodes[i].prevNode = self.nodes[i-1];\r\n            }\r\n\r\n            if (i == self.nodes.length-1)\r\n                self.nodes[i].nextNode = null;\r\n            else {\r\n                self.nodes[i].nextNode = self.nodes[i+1];\r\n            }\r\n        }\r\n\r\n        for (let i = 1; i <= pt[0]; i++) {\r\n\r\n            if (pt[i] !== 0) {\r\n                // base-pair links\r\n                self.links.push({'source': self.nodes[i-1],\r\n                                 'target': self.nodes[pt[i]-1],\r\n                                 'linkType': 'basepair',\r\n                                 'value': 1,\r\n                                 'uid': slugid.nice() });\r\n            }\r\n\r\n            if (i > 1) {\r\n                // backbone links\r\n                if (self.dotBracketBreaks.indexOf(i-1) === -1 &&\r\n                    self.dotBracketBreaks.indexOf(i-2) == -1 &&\r\n                    self.dotBracketBreaks.indexOf(i-3) == -1) {\r\n                    // there is no break in the strands here\r\n                    // we can add a backbone link\r\n                    self.links.push({'source': self.nodes[i-2],\r\n                                    'target': self.nodes[i-1],\r\n                                    'linkType': 'backbone',\r\n                                    'value': 1,\r\n                                    'uid': slugid.nice() });\r\n                    self.nodes[i-1].linked = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        //add the pseudoknot links\r\n        for (let i = 0; i < self.pseudoknotPairs.length; i++) {\r\n            self.links.push({'source': self.nodes[self.pseudoknotPairs[i][0]-1],\r\n                            'target': self.nodes[self.pseudoknotPairs[i][1]-1],\r\n                            'linkType': 'pseudoknot',\r\n                            'value': 1,\r\n                            'uid': slugid.nice()});\r\n        }\r\n\r\n        if (self.circular) {\r\n            self.links.push({'source': self.nodes[0],\r\n                            'target': self.nodes[self.rnaLength-1],\r\n                            'linkType': 'backbone',\r\n                            'value': 1,\r\n                            'uid': slugid.nice() });\r\n\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.ptToElements = function(pt, level, i, j) {\r\n        /* Convert a pair table to a list of secondary structure\r\n         * elements:\r\n         *\r\n         * [['s',1,[2,3]]\r\n         *\r\n         * The 's' indicates that an element can be a stem. It can also be\r\n         * an interior loop ('i'), a hairpin loop ('h') or a multiloop ('m')\r\n         *\r\n         * The second number (1 in this case) indicates the depth or\r\n         * how many base pairs have to be broken to get to this element.\r\n         *\r\n         * Finally, there is the list of nucleotides which are part of\r\n         * of this element.\r\n         */\r\n        var elements = [];\r\n        var u5 = [i-1];\r\n        var u3 = [j+1];\r\n\r\n        if (i > j)\r\n            return [];\r\n\r\n            //iterate over the unpaired regions on either side\r\n            //this is either 5' and 3' unpaired if level == 0\r\n            //or an interior loop or a multiloop\r\n            for (; pt[i] === 0; i++) { u5.push(i); }\r\n            for (; pt[j] === 0; j--) { u3.push(j); }\r\n\r\n            if (i > j) {\r\n                //hairpin loop or one large unpaired molecule\r\n                u5.push(i);\r\n                if (level === 0)\r\n                    return [['e',level, u5.sort(numberSort)]];\r\n                else {\r\n                    // check to see if we have chain breaks due\r\n                    // to multiple strands in the input\r\n                    var external = false;\r\n                    var left = [];\r\n                    var right = [];\r\n                    for (var k = 0; k < u5.length; k++) {\r\n                        if (external)\r\n                            right.push(u5[k]);\r\n                        else\r\n                            left.push(u5[k]);\r\n\r\n                        if (self.dotBracketBreaks.indexOf(u5[k]) >= 0)\r\n                            external = true;\r\n                    }\r\n\r\n                    if (external) {\r\n                        return [['h',level, u5.sort(numberSort)]];\r\n                    }\r\n                    else\r\n                        // if not, this is a simple hairpin loop\r\n                        return [['h',level, u5.sort(numberSort)]];\r\n                }\r\n            }\r\n\r\n            if (pt[i] != j) {\r\n                //multiloop\r\n                var m = u5;\r\n                var k = i;\r\n\r\n                // the nucleotide before and the starting nucleotide\r\n                m.push(k);\r\n                while (k <= j) {\r\n                    // recurse into a stem\r\n                    elements = elements.concat(self.ptToElements(pt, level, k, pt[k]));\r\n\r\n                    // add the nucleotides between stems\r\n                    m.push(pt[k]);\r\n                    k = pt[k] + 1;\r\n                    for (; pt[k] === 0 && k <= j; k++) { m.push(k);}\r\n                    m.push(k);\r\n                }\r\n                m.pop();\r\n                m = m.concat(u3);\r\n\r\n                if (m.length > 0) {\r\n                    if (level === 0)\r\n                        elements.push(['e', level, m.sort(numberSort)]);\r\n                    else\r\n                        elements.push(['m', level, m.sort(numberSort)]);\r\n                }\r\n\r\n                return elements;\r\n            }\r\n\r\n            if (pt[i] === j) {\r\n                //interior loop\r\n                u5.push(i);\r\n                u3.push(j);\r\n\r\n                var combined = u5.concat(u3);\r\n                if (combined.length > 4) {\r\n                    if (level === 0)\r\n                        elements.push(['e',level, u5.concat(u3).sort(numberSort)]);\r\n                    else\r\n                        elements.push(['i',level, u5.concat(u3).sort(numberSort)]);\r\n                }\r\n            }\r\n\r\n            var s = [];\r\n            //go through the stem\r\n            while (pt[i] === j && i < j) {\r\n                //one stem\r\n                s.push(i);\r\n                s.push(j);\r\n\r\n                i += 1;\r\n                j -= 1;\r\n\r\n                level += 1;\r\n            }\r\n\r\n            u5 = [i-1];\r\n            u3 = [j+1];\r\n            elements.push(['s', level, s.sort(numberSort)]);\r\n\r\n        return elements.concat(self.ptToElements(pt, level, i, j));\r\n    };\r\n\r\n    self.addLabels = function(startNumber = 1, labelInterval = 10) {\r\n        if (labelInterval === 0)\r\n            return self;\r\n\r\n        for (let i = 1; i <= self.rnaLength; i++) {\r\n            // add labels\r\n            if (i % labelInterval === 0) {\r\n                //create a node for each label\r\n                let newX, newY;\r\n\r\n                let thisNode = self.nodes[i-1];\r\n                let prevNode, nextNode;\r\n                let prevVec, nextVec;\r\n\r\n                if (self.rnaLength == 1) {\r\n                    nextVec = [thisNode.x - 15, thisNode.y];\r\n                    prevVec = [thisNode.x - 15, thisNode.y];\r\n                } else {\r\n                    // if we're labelling the first node, then label it in relation to the last\r\n                    if (i == 1)\r\n                        prevNode = self.nodes[self.rnaLength - 1];\r\n                    else\r\n                        prevNode = self.nodes[i - 2];\r\n\r\n                    // if we're labelling the last node, then label it in relation to the first\r\n                    if (i == self.rnaLength)\r\n                        nextNode = self.nodes[0];\r\n                    else\r\n                        nextNode = self.nodes[i];\r\n\r\n                    // this nucleotide and its neighbors are paired\r\n                    if (self.pairtable[nextNode.num - startNumber+1] !== 0 &&\r\n                        self.pairtable[prevNode.num - startNumber+1] !== 0 &&\r\n                        self.pairtable[thisNode.num - startNumber+1] !== 0) {\r\n\r\n                        prevNode = nextNode = self.nodes[self.pairtable[thisNode.num - startNumber+1]-1];\r\n                    }\r\n\r\n                    // this node is paired but at least one of its neighbors is unpaired\r\n                    // place the label in the direction of the two neighbors\r\n                    if (self.pairtable[thisNode.num - startNumber+1] !== 0 && (\r\n                        self.pairtable[nextNode.num - startNumber+1] === 0 ||\r\n                        self.pairtable[prevNode.num - startNumber+1] === 0)) {\r\n                        nextVec = [thisNode.x - nextNode.x, thisNode.y - nextNode.y];\r\n                        prevVec = [thisNode.x - prevNode.x, thisNode.y - prevNode.y];\r\n\r\n                    } else {\r\n                        nextVec = [nextNode.x - thisNode.x, nextNode.y - thisNode.y];\r\n                        prevVec = [prevNode.x - thisNode.x, prevNode.y - thisNode.y];\r\n                    }\r\n                }\r\n\r\n                var combinedVec = [nextVec[0] + prevVec[0], nextVec[1] + prevVec[1]];\r\n                var vecLength = Math.sqrt(combinedVec[0] * combinedVec[0] + combinedVec[1] * combinedVec[1]);\r\n                var normedVec = [combinedVec[0] / vecLength, combinedVec[1] / vecLength];\r\n                var offsetVec = [-15 * normedVec[0], -15 * normedVec[1]];\r\n\r\n                newX = self.nodes[i-1].x + offsetVec[0];\r\n                newY = self.nodes[i-1].y + offsetVec[1];\r\n\r\n                var newNode = {'name': i + startNumber -1,\r\n                                 'num': -1,\r\n                                 'radius': 6,\r\n                                 'rna': self,\r\n                                 'nodeType': 'label',\r\n                                 'structName': self.structName,\r\n                                 'elemType': 'l',\r\n                                 'x': newX,\r\n                                 'y': newY,\r\n                                 'px': newX,\r\n                                 'py': newY,\r\n                                 'uid': slugid.nice() };\r\n                var newLink = {'source': self.nodes[i-1],\r\n                            'target': newNode,\r\n                            'value': 1,\r\n                            'linkType': 'label_link',\r\n                            'uid': slugid.nice() };\r\n\r\n                self.nodes.push(newNode);\r\n                self.links.push(newLink);\r\n            }\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.recalculateElements = function() {\r\n        self.removePseudoknots();\r\n        self.elements = self.ptToElements(self.pairtable, 0, 1, self.dotbracket.length);\r\n\r\n        if (self.circular) {\r\n            //check to see if the external loop is a hairpin or a multiloop\r\n            let externalLoop = self.elements.filter(function(d) { if (d[0] == 'e') return true; });\r\n\r\n            if (externalLoop.length > 0) {\r\n                eloop = externalLoop[0];\r\n                nucs = eloop[2].sort(numberSort);\r\n\r\n                prev = nucs[0];\r\n                hloop = true;\r\n                numGreater = 0;\r\n                for (let i = 1; i < nucs.length; i++) {\r\n                    if (nucs[i] - prev > 1) {\r\n                        numGreater += 1;\r\n                    }\r\n                    prev = nucs[i];\r\n                }\r\n\r\n                if (numGreater == 1) {\r\n                    eloop[0] = 'h';\r\n                } else if (numGreater == 2) {\r\n                    eloop[0] = 'i';\r\n                } else {\r\n                    eloop[0] = 'm';\r\n                }\r\n            }\r\n        }\r\n\r\n        return self;\r\n    };\r\n\r\n    self.reassignLinkUids = function() {\r\n        // reassign uids to the links, corresponding to the uids of the two nodes\r\n        // they connect\r\n        var i;\r\n\r\n        for (var i = 0; i < self.links.length; i++) {\r\n            self.links[i].uid = self.links[i].source.uid + self.links[i].target.uid;\r\n        }\r\n\r\n        return self;\r\n    }\r\n\r\n    self.removePseudoknots = function() {\r\n        if (self.pairtable.length > 1)\r\n            self.pseudoknotPairs = self.pseudoknotPairs.concat(rnaUtilities.removePseudoknotsFromPairtable(self.pairtable));\r\n\r\n        return self;\r\n    };\r\n\r\n    self.addPseudoknots = function() {\r\n        /* Add all of the pseudoknot pairs which are stored outside\r\n         * of the pairtable back to the pairtable\r\n         */\r\n        var pt = self.pairtable;\r\n        var pseudoknotPairs = self.pseudoknotPairs;\r\n\r\n        for (var i = 0; i < pseudoknotPairs.length; i++) {\r\n            pt[pseudoknotPairs[i][0]] = pseudoknotPairs[i][1];\r\n            pt[pseudoknotPairs[i][1]] = pseudoknotPairs[i][0];\r\n        }\r\n\r\n        self.pseudoknotPairs = [];\r\n        return self;\r\n    };\r\n\r\n    self.addName = function(name) {\r\n        if (typeof name == 'undefined') {\r\n            self.name = '';\r\n            return self;\r\n        } else {\r\n            self.name = name;\r\n            return self;\r\n        }\r\n    };\r\n\r\n\r\n    if (self.rnaLength > 0)\r\n        self.recalculateElements();\r\n\r\n    self.getNodeFromNucleotides = function(nucs) {\r\n        /* Get a node given a nucleotide number or an array of nucleotide\r\n         * numbers indicating an element node */\r\n        if (Object.prototype.toString.call(nucs) === '[object Array]') {\r\n            for (let j = 0; j < self.nodes.length; j++) {\r\n                if ('nucs' in self.nodes[j]) {\r\n                    if (self.nodes[j].nucs.equals(nucs)) {\r\n                        return self.nodes[j];\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            for (let j = 0; j < self.nodes.length; j++) {\r\n                if (self.nodes[j].num == nucs) {\r\n                    return self.nodes[j];\r\n                }\r\n            }\r\n        }\r\n\r\n        console.log('ERROR: No node found for nucs:', nucs);\r\n        return null;\r\n    }\r\n}\r\n\r\nexport function moleculesToJson(moleculesJson) {\r\n    /* Convert a list of RNA and protein molecules to a list of RNAGraph\r\n     * ProteinGraph and extraLinks structure */\r\n\r\n    var nodes = {}; //index the nodes by uid\r\n    var graphs = [];\r\n    var extraLinks = [];\r\n\r\n\r\n    // Create the graphs for each molecule\r\n    for (var i = 0; i < moleculesJson.molecules.length; i++) {\r\n        var molecule = moleculesJson.molecules[i];\r\n        var rg;\r\n\r\n        if (molecule.type == 'rna') {\r\n            rg = new RNAGraph(molecule.seq, molecule.ss, molecule.header);\r\n            rg.circularizeExternal = true;\r\n            rg.elementsToJson()\r\n            .addPositions('nucleotide', molecule.positions)\r\n            .addLabels()\r\n            .reinforceStems()\r\n            .reinforceLoops();\r\n\r\n\r\n        } else if (molecule.type == 'protein') {\r\n            rg = new ProteinGraph(molecule.header, molecule.size);\r\n\r\n        }\r\n\r\n        rg.addUids(molecule.uids);\r\n\r\n        for (var j = 0; j < rg.nodes.length; j++) {\r\n            nodes[rg.nodes[j].uid] = rg.nodes[j];\r\n        }\r\n\r\n        graphs.push(rg);\r\n    }\r\n\r\n    //Add the extra links\r\n    for (var i = 0; i < moleculesJson.extraLinks.length; i++) {\r\n        link = moleculesJson.extraLinks[i];\r\n\r\n        link.source = nodes[link.source];\r\n        link.target = nodes[link.target];\r\n        link.uid = slugid.nice();\r\n\r\n        extraLinks.push(link);\r\n    }\r\n\r\n    return {'graphs': graphs, 'extraLinks': extraLinks};\r\n};\r\n","export function simpleXyCoordinates (pair_table) {\r\n  var INIT_ANGLE=0.;     /* initial bending angle */\r\n  var INIT_X = 100.;     /* coordinate of first digit */\r\n  var INIT_Y = 100.;     /* see above */\r\n  var RADIUS =  15.;\r\n\r\n  var x = [], y = [];\r\n\r\n  var i, len;\r\n  var  alpha;\r\n\r\n  len = pair_table[0];\r\n  var angle = Array.apply(null, new Array(len+5)).map(Number.prototype.valueOf,0); \r\n  var loop_size = Array.apply(null, new Array(16+Math.floor(len/5)))\r\n                    .map(Number.prototype.valueOf, 0); \r\n  var stack_size = Array.apply(null, new Array(16+Math.floor(len/5)))\r\n                    .map(Number.prototype.valueOf, 0); \r\n\r\n  var lp = 0;\r\n  var stk = 0;\r\n  var PIHALF = Math.PI / 2;\r\n\r\n\r\n  var loop = function(i, j, pair_table)\r\n  /* i, j are the positions AFTER the last pair of a stack; i.e\r\n     i-1 and j+1 are paired. */\r\n  {\r\n      var count = 2;   /* counts the VERTICES of a loop polygon; that's\r\n                          NOT necessarily the number of unpaired bases!\r\n                          Upon entry the loop has already 2 vertices, namely\r\n                          the pair i-1/j+1.  */\r\n\r\n  var    r = 0, bubble = 0; /* bubble counts the unpaired digits in loops */\r\n\r\n  var    i_old, partner, k, l, start_k, start_l, fill, ladder;\r\n  var    begin, v, diff;\r\n  var  polygon;\r\n\r\n  var remember = Array.apply(null, new Array((3+Math.floor((j-i)/5)*2))).map(Number.prototype.valueOf, 0);\r\n\r\n  i_old = i-1, j++;         /* j has now been set to the partner of the\r\n                               previous pair for correct while-loop\r\n                               termination.  */\r\n  while (i != j) {\r\n      partner = pair_table[i];\r\n      if ((!partner) || (i==0))\r\n          i++, count++, bubble++;\r\n      else {\r\n          count += 2;\r\n          k = i, l = partner;    /* beginning of stack */\r\n          remember[++r] = k;\r\n          remember[++r] = l;\r\n          i = partner+1;         /* next i for the current loop */\r\n\r\n          start_k = k, start_l = l;\r\n          ladder = 0;\r\n          do {\r\n              k++, l--, ladder++;        /* go along the stack region */\r\n          }\r\n          while ((pair_table[k] == l) && (pair_table[k] > k));\r\n\r\n          fill = ladder-2;\r\n          if (ladder >= 2) {\r\n              angle[start_k+1+fill] += PIHALF;   /*  Loop entries and    */\r\n              angle[start_l-1-fill] += PIHALF;   /*  exits get an        */\r\n              angle[start_k]        += PIHALF;   /*  additional PI/2.    */\r\n              angle[start_l]        += PIHALF;   /*  Why ? (exercise)    */\r\n              if (ladder > 2) {\r\n                  for (; fill >= 1; fill--) {\r\n                      angle[start_k+fill] = Math.PI;    /*  fill in the angles  */\r\n                      angle[start_l-fill] = Math.PI;    /*  for the backbone    */\r\n                  }\r\n              }\r\n          }\r\n          stack_size[++stk] = ladder;\r\n          if (k <= l)\r\n            loop(k, l, pair_table);\r\n      }\r\n  }\r\n\r\n  polygon = Math.PI*(count-2)/count; /* bending angle in loop polygon */\r\n  remember[++r] = j;\r\n  begin = i_old < 0 ? 0 : i_old;\r\n  for (v = 1; v <= r; v++) {\r\n      diff  = remember[v]-begin;\r\n      for (fill = 0; fill <= diff; fill++)\r\n      angle[begin+fill] += polygon;\r\n      if (v > r)\r\n          break;\r\n      begin = remember[++v];\r\n  }\r\n  loop_size[++lp] = bubble;\r\n  }\r\n\r\n  loop(0, len+1, pair_table);\r\n  loop_size[lp] -= 2;     /* correct for cheating with function loop */\r\n\r\n  alpha = INIT_ANGLE;\r\n  x[0]  = INIT_X;\r\n  y[0]  = INIT_Y;\r\n\r\n  var poss = [];\r\n\r\n  poss.push([x[0], y[0]]);\r\n  for (i = 1; i < len; i++) {\r\n      x[i] = x[i-1]+RADIUS*Math.cos(alpha);\r\n      y[i] = y[i-1]+RADIUS*Math.sin(alpha);\r\n\r\n      poss.push([x[i], y[i]]);\r\n      alpha += Math.PI-angle[i+1];\r\n  }\r\n\r\n  return poss;\r\n}\r\n","export function Radloop() {\r\n\tthis.radius = null;\r\n\tthis.loopnumber = null;\r\n\tthis.next = null;\r\n    this.prev = null;\r\n}\r\n\r\nRadloop.prototype.getRadius = function(){\r\n\treturn this.radius;\r\n}\r\n\r\nRadloop.prototype.setRadius = function(radius){\r\n\tthis.radius = radius;\r\n}\r\n\r\nRadloop.prototype.getLoopnumber = function(){\r\n\treturn this.loopnumber;\r\n}\r\n\r\nRadloop.prototype.setLoopnumber = function(loopnumber){\r\n\tthis.loopnumber = loopnumber;\r\n}\r\n\r\nRadloop.prototype.getNext = function(){\r\n\treturn this.next;\r\n}\r\n\r\nRadloop.prototype.setNext = function(next){\r\n\tthis.next = next;\r\n}\r\n\r\nRadloop.prototype.getPrev = function(){\r\n\treturn this.prev;\r\n}\r\n\r\nRadloop.prototype.setPrev = function(prev){\r\n\tthis.prev = prev;\r\n}\r\n","import {Region} from './region.js';\r\n\r\nexport function Base() {\r\n\tthis.mate = null;\r\n\tthis.x = null;\r\n    this.y = null;\r\n\tthis.extracted = null;\r\n\tthis.region = new Region();\r\n}\r\n\r\nBase.prototype.getMate = function(){\r\n\treturn this.mate;\r\n}\r\n\r\nBase.prototype.setMate = function(mate){\r\n\tthis.mate = mate;\r\n}\r\n\r\nBase.prototype.getX = function(){\r\n\treturn this.x;\r\n}\r\n\r\nBase.prototype.setX = function(x){\r\n\tthis.x = x;\r\n}\r\n\r\nBase.prototype.getY = function(){\r\n\treturn this.y;\r\n}\r\n\r\nBase.prototype.setY = function(y){\r\n\tthis.y = y;\r\n}\r\n\r\nBase.prototype.isExtracted = function(){\r\n\treturn this.extracted;\r\n}\r\n\r\nBase.prototype.setExtracted = function(extracted){\r\n\tthis.extracted = extracted;\r\n}\r\n\r\nBase.prototype.getRegion = function(){\r\n\treturn this.region;\r\n}\r\n\r\nBase.prototype.setRegion = function(region){\r\n\tthis.region = region;\r\n}\r\n","import {Radloop} from './radloop.js';\r\nimport {Connection} from './connection.js';\r\nimport {Region} from './region.js';\r\nimport {Base} from './base.js';\r\nimport {Loop} from './loop.js';\r\n\r\nexport function NAView(){\r\n    this.ANUM = 9999.0;\r\n\tthis.MAXITER = 500;\r\n\r\n\tthis.bases = [];\r\n\tthis.nbase = null;\r\n    this.nregion = null;\r\n    this.loop_count = null;\r\n\r\n\tthis.root = new Loop();\r\n\tthis.loops = [];\r\n\r\n\tthis.regions = [];\r\n\r\n\tthis.rlphead = new Radloop();\r\n\r\n\tthis.lencut = 0.8;\r\n\tthis.RADIUS_REDUCTION_FACTOR = 1.4;\r\n\r\n\t// show algorithm step by step\r\n\tthis.angleinc = null;\r\n\r\n\tthis._h = null;\r\n\r\n\t// private boolean noIterationFailureYet = true;\r\n\r\n\tthis.HELIX_FACTOR = 0.6;\r\n\tthis.BACKBONE_DISTANCE = 27;\r\n}\r\n\r\nNAView.prototype.naview_xy_coordinates = function(pair_table){\r\n    var x = [];\r\n\tvar y = [];\r\n    if (pair_table.length === 0 || pair_table[0] === 0){\r\n        return 0;\r\n    }\r\n    var i;\r\n    this.nbase = pair_table[0];\r\n    this.bases = [];\r\n    for (var index = 0; index < this.nbase + 1; index++){\r\n        this.bases.push(new Base());\r\n    }\r\n    this.regions = [];\r\n    for (var index = 0; index < this.nbase + 1; index++){\r\n        this.regions.push(new Region());\r\n    }\r\n    this.read_in_bases(pair_table);\r\n    this.rlphead = null;\r\n    this.find_regions();\r\n    this.loop_count = 0;\r\n    this.loops = [];\r\n    for (var index = 0; index < this.nbase + 1; index++){\r\n        this.loops.push(new Loop());\r\n    }\r\n    this.construct_loop(0);\r\n    this.find_central_loop();\r\n    this.traverse_loop(this.root, null);\r\n\r\n    for (i = 0; i < this.nbase; i++){\r\n        x.push(100 + this.BACKBONE_DISTANCE * this.bases[i + 1].getX());\r\n        y.push(100 + this.BACKBONE_DISTANCE * this.bases[i + 1].getY());\r\n    }\r\n\r\n    return {\r\n        nbase: this.nbase,\r\n        x: x,\r\n        y: y\r\n    }\r\n}\r\n\r\nNAView.prototype.read_in_bases = function read_in_bases(pair_table){\r\n    var i = null;\r\n    var npairs = null;\r\n\r\n    // Set up an origin.\r\n    this.bases.push(new Base());\r\n    this.bases[0].setMate(0);\r\n    this.bases[0].setExtracted(false);\r\n    this.bases[0].setX(this.ANUM);\r\n    this.bases[0].setY(this.ANUM);\r\n\r\n    for (npairs = 0, i = 1; i <= this.nbase; i++){\r\n        this.bases.push(new Base());\r\n        this.bases[i].setExtracted(false);\r\n        this.bases[i].setX(this.ANUM);\r\n        this.bases[i].setY(this.ANUM);\r\n        this.bases[i].setMate(pair_table[i]);\r\n        if (pair_table[i] > i)\r\n            npairs++;\r\n    }\r\n    // must have at least 1 pair to avoid segfault\r\n    if (npairs == 0){\r\n        this.bases[1].setMate(this.nbase);\r\n        this.bases[this.nbase].setMate(1);\r\n    }\r\n}\r\n\r\nNAView.prototype.find_regions = function find_regions(){\r\n    var i = null;\r\n    var mate = null;\r\n    var nb1 = null;\r\n\r\n    nb1 = this.nbase + 1;\r\n    var mark = [];\r\n    for (i = 0; i < nb1; i++){\r\n        mark.push(false);\r\n    }\r\n    this.nregion = 0;\r\n    for (i = 0; i <= this.nbase; i++) {\r\n        if ((mate = this.bases[i].getMate()) != 0 && !mark[i]) {\r\n            this.regions[this.nregion].setStart1(i);\r\n            this.regions[this.nregion].setEnd2(mate);\r\n            mark[i] = true;\r\n            mark[mate] = true;\r\n            this.bases[i].setRegion(this.regions[this.nregion]);\r\n            this.bases[mate].setRegion(this.regions[this.nregion]);\r\n            for (i++, mate--; i < mate && this.bases[i].getMate() == mate; i++, mate--) {\r\n                mark[mate] = true;\r\n                mark[i]= true;\r\n                this.bases[i].setRegion(this.regions[this.nregion]);\r\n                this.bases[mate].setRegion(this.regions[this.nregion]);\r\n            }\r\n            this.regions[this.nregion].setEnd1(--i);\r\n            this.regions[this.nregion].setStart2(mate + 1);\r\n\r\n            this.nregion++;\r\n        }\r\n    }\r\n}\r\n\r\nNAView.prototype.construct_loop = function construct_loop(ibase){\r\n    var i = null;\r\n    var mate = null;\r\n    var retloop = new Loop();\r\n    var lp = new Loop();\r\n    var cp = new Connection();\r\n    var rp = new Region();\r\n    var rlp = new Radloop();\r\n    retloop = this.loops[this.loop_count++];\r\n    retloop.setNconnection(0);\r\n    retloop.setDepth(0);\r\n    retloop.setNumber(this.loop_count);\r\n    retloop.setRadius(0.0);\r\n\r\n    for (rlp = this.rlphead; rlp != null; rlp = rlp.getNext())\r\n        if (rlp.getLoopnumber() == this.loop_count)\r\n            retloop.setRadius(rlp.getRadius());\r\n    i = ibase;\r\n    do {\r\n        if ((mate = this.bases[i].getMate()) != 0) {\r\n            rp = this.bases[i].getRegion();\r\n            if (!this.bases[rp.getStart1()].isExtracted()) {\r\n                if (i == rp.getStart1()) {\r\n                    this.bases[rp.getStart1()].setExtracted(true);\r\n                    this.bases[rp.getEnd1()].setExtracted(true);\r\n                    this.bases[rp.getStart2()].setExtracted(true);\r\n                    this.bases[rp.getEnd2()].setExtracted(true);\r\n                    lp = this.construct_loop(rp.getEnd1() < this.nbase ? rp.getEnd1() + 1\r\n                            : 0);\r\n                } else if (i == rp.getStart2()) {\r\n                    this.bases[rp.getStart2()].setExtracted(true);\r\n                    this.bases[rp.getEnd2()].setExtracted(true);\r\n                    this.bases[rp.getStart1()].setExtracted(true);\r\n                    this.bases[rp.getEnd1()].setExtracted(true);\r\n                    lp = this.construct_loop(rp.getEnd2() < this.nbase ? rp.getEnd2() + 1\r\n                            : 0);\r\n                } else {\r\n                    console.log(\"Something went terribly wrong ....\");\r\n                }\r\n                retloop.setNconnection(retloop.getNconnection() + 1);\r\n                cp = new Connection();\r\n                retloop.setConnection(retloop.getNconnection() - 1,\tcp);\r\n                retloop.setConnection(retloop.getNconnection(), null);\r\n                cp.setLoop(lp);\r\n                cp.setRegion(rp);\r\n                if(i == rp.getStart1()) {\r\n                    cp.setStart(rp.getStart1());\r\n                    cp.setEnd(rp.getEnd2());\r\n                } else {\r\n                    cp.setStart(rp.getStart2());\r\n                    cp.setEnd(rp.getEnd1());\r\n                }\r\n                cp.setExtruded(false);\r\n                cp.setBroken(false);\r\n                lp.setNconnection(lp.getNconnection() + 1);\r\n                cp = new Connection();\r\n                lp.setConnection(lp.getNconnection() - 1, cp);\r\n                lp.setConnection(lp.getNconnection(), null);\r\n                cp.setLoop(retloop);\r\n                cp.setRegion(rp);\r\n                if (i == rp.getStart1()) {\r\n                    cp.setStart(rp.getStart2());\r\n                    cp.setEnd(rp.getEnd1());\r\n                } else {\r\n                    cp.setStart(rp.getStart1());\r\n                    cp.setEnd(rp.getEnd2());\r\n                }\r\n                cp.setExtruded(false);\r\n                cp.setBroken(false);\r\n            }\r\n            i = mate;\r\n        }\r\n        if (++i > this.nbase)\r\n            i = 0;\r\n    } while (i != ibase);\r\n    return retloop;\r\n}\r\n\r\nNAView.prototype.find_central_loop = function find_central_loop(){\r\n    var lp = new Loop();\r\n    var maxconn = null;\r\n    var maxdepth = null;\r\n    var i = null;\r\n\r\n    determine_depths.bind(this)();\r\n    maxconn = 0;\r\n    maxdepth = -1;\r\n    for (i = 0; i < this.loop_count; i++) {\r\n        lp = this.loops[i];\r\n        if (lp.getNconnection() > maxconn) {\r\n            maxdepth = lp.getDepth();\r\n            maxconn = lp.getNconnection();\r\n            this.root = lp;\r\n        } else if (lp.getDepth() > maxdepth\r\n                && lp.getNconnection() == maxconn) {\r\n            maxdepth = lp.getDepth();\r\n            this.root = lp;\r\n        }\r\n    }\r\n}\r\n\r\nfunction determine_depths() {\r\n    var lp = new Loop();\r\n    var i = null;\r\n    var j = null;\r\n\r\n    for (i = 0; i < this.loop_count; i++) {\r\n        lp = this.loops[i];\r\n        for (j = 0; j < this.loop_count; j++){\r\n            this.loops[j].setMark(false);\r\n        }\r\n        lp.setDepth(depth(lp));\r\n    }\r\n}\r\n\r\nfunction depth(lp){\r\n    var count = null;\r\n    var ret = null;\r\n    var d = null;\r\n\r\n    if (lp.getNconnection() <= 1){\r\n        return 0;\r\n    }\r\n    if (lp.isMark()){\r\n        return -1;\r\n    }\r\n    lp.setMark(true);\r\n    count = 0;\r\n    ret = 0;\r\n    for (var i = 0; lp.getConnection(i) != null; i++) {\r\n        d = depth(lp.getConnection(i).getLoop());\r\n        if (d >= 0) {\r\n            if (++count == 1){\r\n                ret = d;\r\n            }\r\n            else if (ret > d){\r\n                ret = d;\r\n            }\r\n        }\r\n    }\r\n    lp.setMark(false);\r\n    return ret + 1;\r\n}\r\n\r\nNAView.prototype.traverse_loop = function traverse_loop(lp, anchor_connection){\r\n    var xs, ys, xe, ye, xn, yn, angleinc, r;\r\n    var radius, xc, yc, xo, yo, astart, aend, a;\r\n    var cp, cpnext, acp, cpprev;\r\n    var i, j, n, ic;\r\n    var da, maxang;\r\n    var count, icstart, icend, icmiddle, icroot;\r\n    var done, done_all_connections, rooted;\r\n    var sign;\r\n    var midx, midy, nrx, nry, mx, my, vx, vy, dotmv, nmidx, nmidy;\r\n    var icstart1, icup, icdown, icnext, direction;\r\n    var dan, dx, dy, rr;\r\n    var cpx, cpy, cpnextx, cpnexty, cnx, cny, rcn, rc, lnx, lny, rl, ac, acn, sx, sy, dcp;\r\n    var imaxloop = 0;\r\n\r\n    angleinc = 2 * Math.PI / (this.nbase + 1);\r\n    acp = null;\r\n    icroot = -1;\r\n    var indice = 0;\r\n\r\n    for (ic = 0; (cp = lp.getConnection(indice)) != null; indice++, ic++) {\r\n        xs = -Math.sin(angleinc * cp.getStart());\r\n        ys = Math.cos(angleinc * cp.getStart());\r\n        xe = -Math.sin(angleinc * cp.getEnd());\r\n        ye = Math.cos(angleinc * cp.getEnd());\r\n        xn = ye - ys;\r\n        yn = xs - xe;\r\n        r = Math.sqrt(xn * xn + yn * yn);\r\n        cp.setXrad(xn / r);\r\n        cp.setYrad(yn / r);\r\n        cp.setAngle(Math.atan2(yn, xn));\r\n        if (cp.getAngle() < 0.0){\r\n            cp.setAngle(cp.getAngle() + 2 * Math.PI);\r\n        }\r\n        if (anchor_connection != null\r\n                && anchor_connection.getRegion() == cp.getRegion()) {\r\n            acp = cp;\r\n            icroot = ic;\r\n        }\r\n    }\r\n    set_radius: while (true) {\r\n        this.determine_radius(lp, this.lencut);\r\n        radius = lp.getRadius()/this.RADIUS_REDUCTION_FACTOR;\r\n        if (anchor_connection == null){\r\n            xc = yc = 0.0;\r\n        }\r\n        else {\r\n            xo = (this.bases[acp.getStart()].getX() + this.bases\r\n                    [acp.getEnd()].getX()) / 2.0;\r\n            yo = (this.bases[acp.getStart()].getY() + this.bases\r\n                    [acp.getEnd()].getY()) / 2.0;\r\n            xc = xo - radius * acp.getXrad();\r\n            yc = yo - radius * acp.getYrad();\r\n        }\r\n\r\n        // The construction of the connectors will proceed in blocks of\r\n        // connected connectors, where a connected connector pairs means two\r\n        // connectors that are forced out of the drawn circle because they\r\n        // are too close together in angle.\r\n\r\n        // First, find the start of a block of connected connectors\r\n\r\n        if (icroot == -1){\r\n            icstart = 0;\r\n        }\r\n        else {\r\n            icstart = icroot;\r\n        }\r\n        cp = lp.getConnection(icstart);\r\n        count = 0;\r\n        done = false;\r\n        do {\r\n            j = icstart - 1;\r\n            if (j < 0){\r\n                j = lp.getNconnection() - 1;\r\n            }\r\n            cpprev = lp.getConnection(j);\r\n            if (!this.connected_connection(cpprev, cp)) {\r\n                done = true;\r\n            }\r\n            else {\r\n                icstart = j;\r\n                cp = cpprev;\r\n            }\r\n            if (++count > lp.getNconnection()) {\r\n                // Here everything is connected. Break on maximum angular\r\n                // separation between connections.\r\n                maxang = -1.0;\r\n                for (ic = 0; ic < lp.getNconnection(); ic++) {\r\n                    j = ic + 1;\r\n                    if (j >= lp.getNconnection()){\r\n                        j = 0;\r\n                    }\r\n                    cp = lp.getConnection(ic);\r\n                    cpnext = lp.getConnection(j);\r\n                    ac = cpnext.getAngle() - cp.getAngle();\r\n                    if (ac < 0.0){\r\n                        ac += 2 * Math.PI;\r\n                    }\r\n                    if (ac > maxang) {\r\n                        maxang = ac;\r\n                        imaxloop = ic;\r\n                    }\r\n                }\r\n                icend = imaxloop;\r\n                icstart = imaxloop + 1;\r\n                if (icstart >= lp.getNconnection()){\r\n                    icstart = 0;\r\n                }\r\n                cp = lp.getConnection(icend);\r\n                cp.setBroken(true);\r\n                done = true;\r\n            }\r\n        } while (!done);\r\n        done_all_connections = false;\r\n        icstart1 = icstart;\r\n        while (!done_all_connections) {\r\n            count = 0;\r\n            done = false;\r\n            icend = icstart;\r\n            rooted = false;\r\n            while (!done) {\r\n                cp = lp.getConnection(icend);\r\n                if (icend == icroot){\r\n                    rooted = true;\r\n                }\r\n                j = icend + 1;\r\n                if (j >= lp.getNconnection()) {\r\n                    j = 0;\r\n                }\r\n                cpnext = lp.getConnection(j);\r\n                if (this.connected_connection(cp, cpnext)) {\r\n                    if (++count >= lp.getNconnection()){\r\n                        break;\r\n                    }\r\n                    icend = j;\r\n                }\r\n                else {\r\n                    done = true;\r\n                }\r\n            }\r\n            icmiddle = this.find_ic_middle(icstart, icend, anchor_connection,\r\n                    acp, lp);\r\n            ic = icup = icdown = icmiddle;\r\n            done = false;\r\n            direction = 0;\r\n            while (!done) {\r\n                if (direction < 0) {\r\n                    ic = icup;\r\n                }\r\n                else if (direction == 0) {\r\n                    ic = icmiddle;\r\n                }\r\n                else {\r\n                    ic = icdown;\r\n                }\r\n                if (ic >= 0) {\r\n                    cp = lp.getConnection(ic);\r\n                    if (anchor_connection == null || acp != cp) {\r\n                        if (direction == 0) {\r\n                            astart = cp.getAngle()\r\n                                    - Math.asin(1.0 / 2.0 / radius);\r\n                            aend = cp.getAngle()\r\n                                    + Math.asin(1.0 / 2.0 / radius);\r\n                            this.bases[cp.getStart()].setX(\r\n                                    xc + radius * Math.cos(astart));\r\n                            this.bases[cp.getStart()].setY(\r\n                                    yc + radius * Math.sin(astart));\r\n                            this.bases[cp.getEnd()].setX(\r\n                                    xc + radius * Math.cos(aend));\r\n                            this.bases[cp.getEnd()].setY(\r\n                                    yc + radius * Math.sin(aend));\r\n                        }\r\n                        else if (direction < 0) {\r\n                            j = ic + 1;\r\n                            if (j >= lp.getNconnection()){\r\n                                j = 0;\r\n                            }\r\n                            cp = lp.getConnection(ic);\r\n                            cpnext = lp.getConnection(j);\r\n                            cpx = cp.getXrad();\r\n                            cpy = cp.getYrad();\r\n                            ac = (cp.getAngle() + cpnext.getAngle()) / 2.0;\r\n                            if (cp.getAngle() > cpnext.getAngle()){\r\n                                ac -= Math.PI;\r\n                            }\r\n                            cnx = Math.cos(ac);\r\n                            cny = Math.sin(ac);\r\n                            lnx = cny;\r\n                            lny = -cnx;\r\n                            da = cpnext.getAngle() - cp.getAngle();\r\n                            if (da < 0.0){\r\n                                da += 2 * Math.PI;\r\n                            }\r\n                            if (cp.isExtruded()) {\r\n                                if (da <= Math.PI / 2){\r\n                                    rl = 2.0;\r\n                                }\r\n                                else {\r\n                                    rl = 1.5;\r\n                                }\r\n                            }\r\n                            else {\r\n                                rl = 1.0;\r\n                            }\r\n                            this.bases[cp.getEnd()].setX(\r\n                                    this.bases[cpnext.getStart()].getX()\r\n                                            + rl * lnx);\r\n                            this.bases[cp.getEnd()].setY(\r\n                                    this.bases[cpnext.getStart()].getY()\r\n                                            + rl * lny);\r\n                            this.bases[cp.getStart()].setX(\r\n                                    this.bases[cp.getEnd()].getX() + cpy);\r\n                            this.bases[cp.getStart()].setY(\r\n                                    this.bases[cp.getEnd()].getY() - cpx);\r\n                        } else {\r\n                            j = ic - 1;\r\n                            if (j < 0){\r\n                                j = lp.getNconnection() - 1;\r\n                            }\r\n                            cp = lp.getConnection(j);\r\n                            cpnext = lp.getConnection(ic);\r\n                            cpnextx = cpnext.getXrad();\r\n                            cpnexty = cpnext.getYrad();\r\n                            ac = (cp.getAngle() + cpnext.getAngle()) / 2.0;\r\n                            if (cp.getAngle() > cpnext.getAngle()){\r\n                                ac -= Math.PI;\r\n                            }\r\n                            cnx = Math.cos(ac);\r\n                            cny = Math.sin(ac);\r\n                            lnx = -cny;\r\n                            lny = cnx;\r\n                            da = cpnext.getAngle() - cp.getAngle();\r\n                            if (da < 0.0){\r\n                                da += 2 * Math.PI;\r\n                            }\r\n                            if (cp.isExtruded()) {\r\n                                if (da <= Math.PI / 2){\r\n                                    rl = 2.0;\r\n                                }\r\n                                else {\r\n                                    rl = 1.5;\r\n                                }\r\n                            }\r\n                            else {\r\n                                rl = 1.0;\r\n                            }\r\n                            this.bases[cpnext.getStart()].setX(\r\n                                    this.bases[cp.getEnd()].getX() + rl\r\n                                            * lnx);\r\n                            this.bases[cpnext.getStart()].setY(\r\n                                    this.bases[cp.getEnd()].getY() + rl\r\n                                            * lny);\r\n                            this.bases[cpnext.getEnd()].setX(\r\n                                    this.bases[cpnext.getStart()].getX()\r\n                                            - cpnexty);\r\n                            this.bases[cpnext.getEnd()].setY(\r\n                                    this.bases[cpnext.getStart()].getY()\r\n                                            + cpnextx);\r\n                        }\r\n                    }\r\n                }\r\n                if (direction < 0) {\r\n                    if (icdown == icend) {\r\n                        icdown = -1;\r\n                    }\r\n                    else if (icdown >= 0) {\r\n                        if (++icdown >= lp.getNconnection()) {\r\n                            icdown = 0;\r\n                        }\r\n                    }\r\n                    direction = 1;\r\n                }\r\n                else {\r\n                    if (icup == icstart){\r\n                        icup = -1;\r\n                    }\r\n                    else if (icup >= 0) {\r\n                        if (--icup < 0) {\r\n                            icup = lp.getNconnection() - 1;\r\n                        }\r\n                    }\r\n                    direction = -1;\r\n                }\r\n                done = icup == -1 && icdown == -1;\r\n            }\r\n            icnext = icend + 1;\r\n            if (icnext >= lp.getNconnection()){\r\n                icnext = 0;\r\n            }\r\n            if (icend != icstart\r\n                    && (!(icstart == icstart1 && icnext == icstart1))) {\r\n\r\n                // Move the bases just constructed (or the radius) so that\r\n                // the bisector of the end points is radius distance away\r\n                // from the loop center.\r\n\r\n                cp = lp.getConnection(icstart);\r\n                cpnext = lp.getConnection(icend);\r\n                dx = this.bases[cpnext.getEnd()].getX()\r\n                        - this.bases[cp.getStart()].getX();\r\n                dy = this.bases[cpnext.getEnd()].getY()\r\n                        - this.bases[cp.getStart()].getY();\r\n                midx = this.bases[cp.getStart()].getX() + dx / 2.0;\r\n                midy = this.bases[cp.getStart()].getY() + dy / 2.0;\r\n                rr = Math.sqrt(dx * dx + dy * dy);\r\n                mx = dx / rr;\r\n                my = dy / rr;\r\n                vx = xc - midx;\r\n                vy = yc - midy;\r\n                rr = Math.sqrt(dx * dx + dy * dy);\r\n                vx /= rr;\r\n                vy /= rr;\r\n                dotmv = vx * mx + vy * my;\r\n                nrx = dotmv * mx - vx;\r\n                nry = dotmv * my - vy;\r\n                rr = Math.sqrt(nrx * nrx + nry * nry);\r\n                nrx /= rr;\r\n                nry /= rr;\r\n\r\n                // Determine which side of the bisector the center should\r\n                // be.\r\n\r\n                dx = this.bases[cp.getStart()].getX() - xc;\r\n                dy = this.bases[cp.getStart()].getY() - yc;\r\n                ac = Math.atan2(dy, dx);\r\n                if (ac < 0.0){\r\n                    ac += 2 * Math.PI;\r\n                }\r\n                dx = this.bases[cpnext.getEnd()].getX() - xc;\r\n                dy = this.bases[cpnext.getEnd()].getY() - yc;\r\n                acn = Math.atan2(dy, dx);\r\n                if (acn < 0.0){\r\n                    acn += 2 * Math.PI;\r\n                }\r\n                if (acn < ac){\r\n                    acn += 2 * Math.PI;\r\n                }\r\n                if (acn - ac > Math.PI){\r\n                    sign = -1;\r\n                }\r\n                else {\r\n                    sign = 1;\r\n                }\r\n                nmidx = xc + sign * radius * nrx;\r\n                nmidy = yc + sign * radius * nry;\r\n                if (rooted) {\r\n                    xc -= nmidx - midx;\r\n                    yc -= nmidy - midy;\r\n                }\r\n                else {\r\n                    for (ic = icstart;;) {\r\n                        cp = lp.getConnection(ic);\r\n                        i = cp.getStart();\r\n                        this.bases[i].setX(\r\n                                this.bases[i].getX() + nmidx - midx);\r\n                        this.bases[i].setY(\r\n                                this.bases[i].getY() + nmidy - midy);\r\n                        i = cp.getEnd();\r\n                        this.bases[i].setX(\r\n                                this.bases[i].getX() + nmidx - midx);\r\n                        this.bases[i].setY(\r\n                                this.bases[i].getY() + nmidy - midy);\r\n                        if (ic == icend){\r\n                            break;\r\n                        }\r\n                        if (++ic >= lp.getNconnection()){\r\n                            ic = 0;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            icstart = icnext;\r\n            done_all_connections = icstart == icstart1;\r\n        }\r\n        for (ic = 0; ic < lp.getNconnection(); ic++) {\r\n            cp = lp.getConnection(ic);\r\n            j = ic + 1;\r\n            if (j >= lp.getNconnection()){\r\n                j = 0;\r\n            }\r\n            cpnext = lp.getConnection(j);\r\n            dx = this.bases[cp.getEnd()].getX() - xc;\r\n            dy = this.bases[cp.getEnd()].getY() - yc;\r\n            rc = Math.sqrt(dx * dx + dy * dy);\r\n            ac = Math.atan2(dy, dx);\r\n            if (ac < 0.0){\r\n                ac += 2 * Math.PI;\r\n            }\r\n            dx = this.bases[cpnext.getStart()].getX() - xc;\r\n            dy = this.bases[cpnext.getStart()].getY() - yc;\r\n            rcn = Math.sqrt(dx * dx + dy * dy);\r\n            acn = Math.atan2(dy, dx);\r\n            if (acn < 0.0){\r\n                acn += 2 * Math.PI;\r\n            }\r\n            if (acn < ac){\r\n                acn += 2 * Math.PI;\r\n            }\r\n            dan = acn - ac;\r\n            dcp = cpnext.getAngle() - cp.getAngle();\r\n            if (dcp <= 0.0){\r\n                dcp += 2 * Math.PI;\r\n            }\r\n            if (Math.abs(dan - dcp) > Math.PI) {\r\n                if (cp.isExtruded()) {\r\n                    console.log(\"Warning from traverse_loop. Loop \"\r\n                            + lp.getNumber() + \" has crossed regions\\n\");\r\n                }\r\n                else if ((cpnext.getStart() - cp.getEnd()) != 1) {\r\n                    cp.setExtruded(true);\r\n                    continue set_radius; // remplacement du goto\r\n                }\r\n            }\r\n            if (cp.isExtruded()) {\r\n                this.construct_extruded_segment(cp, cpnext);\r\n            }\r\n            else {\r\n                n = cpnext.getStart() - cp.getEnd();\r\n                if (n < 0){\r\n                    n += this.nbase + 1;\r\n                }\r\n                angleinc = dan / n;\r\n                for (j = 1; j < n; j++) {\r\n                    i = cp.getEnd() + j;\r\n                    if (i > this.nbase){\r\n                        i -= this.nbase + 1;\r\n                    }\r\n                    a = ac + j * angleinc;\r\n                    rr = rc + (rcn - rc) * (a - ac) / dan;\r\n                    this.bases[i].setX(xc + rr * Math.cos(a));\r\n                    this.bases[i].setY(yc + rr * Math.sin(a));\r\n                }\r\n            }\r\n        }\r\n        break;\r\n    }\r\n    for (ic = 0; ic < lp.getNconnection(); ic++) {\r\n        if (icroot != ic) {\r\n            cp = lp.getConnection(ic);\r\n            //IM HERE\r\n            this.generate_region(cp);\r\n            this.traverse_loop(cp.getLoop(), cp);\r\n        }\r\n    }\r\n    n = 0;\r\n    sx = 0.0;\r\n    sy = 0.0;\r\n    for (ic = 0; ic < lp.getNconnection(); ic++) {\r\n        j = ic + 1;\r\n        if (j >= lp.getNconnection()){\r\n            j = 0;\r\n        }\r\n        cp = lp.getConnection(ic);\r\n        cpnext = lp.getConnection(j);\r\n        n += 2;\r\n        sx += this.bases[cp.getStart()].getX()\r\n                + this.bases[cp.getEnd()].getX();\r\n        sy += this.bases[cp.getStart()].getY()\r\n                + this.bases[cp.getEnd()].getY();\r\n        if (!cp.isExtruded()) {\r\n            for (j = cp.getEnd() + 1; j != cpnext.getStart(); j++) {\r\n                if (j > this.nbase){\r\n                    j -= this.nbase + 1;\r\n                }\r\n                n++;\r\n                sx += this.bases[j].getX();\r\n                sy += this.bases[j].getY();\r\n            }\r\n        }\r\n    }\r\n    lp.setX(sx / n);\r\n    lp.setY(sy / n);\r\n}\r\n\r\nNAView.prototype.determine_radius = function determine_radius(lp, lencut){\r\n    var mindit, ci, dt, sumn, sumd, radius, dit;\r\n    var i, j, end, start, imindit = 0;\r\n    var cp = new Connection(), cpnext = new Connection();\r\n    var rt2_2 = 0.7071068;\r\n\r\n    do {\r\n        mindit = 1.0e10;\r\n        for (sumd = 0.0, sumn = 0.0, i = 0; i < lp.getNconnection(); i++) {\r\n            cp = lp.getConnection(i);\r\n            j = i + 1;\r\n            if (j >= lp.getNconnection()){\r\n                j = 0;\r\n            }\r\n            cpnext = lp.getConnection(j);\r\n            end = cp.getEnd();\r\n            start = cpnext.getStart();\r\n            if (start < end){\r\n                start += this.nbase + 1;\r\n            }\r\n            dt = cpnext.getAngle() - cp.getAngle();\r\n            if (dt <= 0.0){\r\n                dt += 2 * Math.PI;\r\n            }\r\n            if (!cp.isExtruded()){\r\n                ci = start - end;\r\n            }\r\n            else {\r\n                if (dt <= Math.PI / 2){\r\n                    ci = 2.0;\r\n                }\r\n                else {\r\n                    ci = 1.5;\r\n                }\r\n            }\r\n            sumn += dt * (1.0 / ci + 1.0);\r\n            sumd += dt * dt / ci;\r\n            dit = dt / ci;\r\n            if (dit < mindit && !cp.isExtruded() && ci > 1.0) {\r\n                mindit = dit;\r\n                imindit = i;\r\n            }\r\n        }\r\n        radius = sumn / sumd;\r\n        if (radius < rt2_2){\r\n            radius = rt2_2;\r\n        }\r\n        if (mindit * radius < lencut) {\r\n            lp.getConnection(imindit).setExtruded(true);\r\n        }\r\n    } while (mindit * radius < lencut);\r\n    if (lp.getRadius() > 0.0){\r\n        radius = lp.getRadius();\r\n    }\r\n    else {\r\n        lp.setRadius(radius);\r\n    }\r\n}\r\n\r\nNAView.prototype.find_ic_middle = function find_ic_middle(icstart, icend, anchor_connection, acp, lp){\r\n    var count, ret, ic, i;\r\n    var done;\r\n\r\n    count = 0;\r\n    ret = -1;\r\n    ic = icstart;\r\n    done = false;\r\n    while (!done) {\r\n        if (count++ > lp.getNconnection() * 2) {\r\n            console.log(\"Infinite loop in 'find_ic_middle'\");\r\n        }\r\n        if (anchor_connection != null && lp.getConnection(ic) == acp) {\r\n            ret = ic;\r\n        }\r\n        done = ic == icend;\r\n        if (++ic >= lp.getNconnection()) {\r\n            ic = 0;\r\n        }\r\n    }\r\n    if (ret == -1) {\r\n        for (i = 1, ic = icstart; i < (count + 1) / 2; i++) {\r\n            if (++ic >= lp.getNconnection())\r\n                ic = 0;\r\n        }\r\n        ret = ic;\r\n    }\r\n    return ret;\r\n}\r\n\r\nNAView.prototype.construct_extruded_segment = function construct_extruded_segment(cp, cpnext){\r\n    var astart, aend1, aend2, aave, dx, dy, a1, a2, ac, rr, da, dac;\r\n    var start, end, n, nstart, nend;\r\n    var collision;\r\n\r\n    astart = cp.getAngle();\r\n    aend2 = aend1 = cpnext.getAngle();\r\n    if (aend2 < astart){\r\n        aend2 += 2 * Math.PI;\r\n    }\r\n    aave = (astart + aend2) / 2.0;\r\n    start = cp.getEnd();\r\n    end = cpnext.getStart();\r\n    n = end - start;\r\n    if (n < 0){\r\n        n += this.nbase + 1;\r\n    }\r\n    da = cpnext.getAngle() - cp.getAngle();\r\n    if (da < 0.0) {\r\n        da += 2 * Math.PI;\r\n    }\r\n    if (n == 2) {\r\n        this.construct_circle_segment(start, end);\r\n    }\r\n    else {\r\n        dx = this.bases[end].getX() - this.bases[start].getX();\r\n        dy = this.bases[end].getY() - this.bases[start].getY();\r\n        rr = Math.sqrt(dx * dx + dy * dy);\r\n        dx /= rr;\r\n        dy /= rr;\r\n        if (rr >= 1.5 && da <= Math.PI / 2) {\r\n            nstart = start + 1;\r\n            if (nstart > this.nbase){\r\n                nstart -= this.nbase + 1;\r\n            }\r\n            nend = end - 1;\r\n            if (nend < 0){\r\n                nend += this.nbase + 1;\r\n            }\r\n            this.bases[nstart].setX(this.bases[start].getX() + 0.5 * dx);\r\n            this.bases[nstart].setY(this.bases[start].getY() + 0.5 * dy);\r\n            this.bases[nend].setX(this.bases[end].getX() - 0.5 * dx);\r\n            this.bases[nend].setY(this.bases[end].getY() - 0.5 * dy);\r\n            start = nstart;\r\n            end = nend;\r\n        }\r\n        do {\r\n            collision = false;\r\n            this.construct_circle_segment(start, end);\r\n            nstart = start + 1;\r\n            if (nstart > this.nbase) {\r\n                nstart -= this.nbase + 1;\r\n            }\r\n            dx = this.bases[nstart].getX() - this.bases[start].getX();\r\n            dy = this.bases[nstart].getY() - this.bases[start].getY();\r\n            a1 = Math.atan2(dy, dx);\r\n            if (a1 < 0.0){\r\n                a1 += 2 * Math.PI;\r\n            }\r\n            dac = a1 - astart;\r\n            if (dac < 0.0){\r\n                dac += 2 * Math.PI;\r\n            }\r\n            if (dac > Math.PI){\r\n                collision = true;\r\n            }\r\n            nend = end - 1;\r\n            if (nend < 0){\r\n                nend += this.nbase + 1;\r\n            }\r\n            dx = this.bases[nend].getX() - this.bases[end].getX();\r\n            dy = this.bases[nend].getY() - this.bases[end].getY();\r\n            a2 = Math.atan2(dy, dx);\r\n            if (a2 < 0.0){\r\n                a2 += 2 * Math.PI;\r\n            }\r\n            dac = aend1 - a2;\r\n            if (dac < 0.0){\r\n                dac += 2 * Math.PI;\r\n            }\r\n            if (dac > Math.PI){\r\n                collision = true;\r\n            }\r\n            if (collision) {\r\n                ac = this.minf2(aave, astart + 0.5);\r\n                this.bases[nstart].setX(\r\n                        this.bases[start].getX() + Math.cos(ac));\r\n                this.bases[nstart].setY(\r\n                        this.bases[start].getY() + Math.sin(ac));\r\n                start = nstart;\r\n                ac = this.maxf2(aave, aend2 - 0.5);\r\n                this.bases[nend].setX(this.bases[end].getX() + Math.cos(ac));\r\n                this.bases[nend].setY(this.bases[end].getY() + Math.sin(ac));\r\n                end = nend;\r\n                n -= 2;\r\n            }\r\n        } while (collision && n > 1);\r\n    }\r\n}\r\n\r\nNAView.prototype.construct_circle_segment = function construct_circle_segment(start, end){\r\n    var dx, dy, rr, midx, midy, xn, yn, nrx, nry, mx, my, a;\r\n    var l, j, i;\r\n\r\n    dx = this.bases[end].getX() - this.bases[start].getX();\r\n    dy = this.bases[end].getY() - this.bases[start].getY();\r\n    rr = Math.sqrt(dx * dx + dy * dy);\r\n    l = end - start;\r\n    if (l < 0){\r\n        l += this.nbase + 1;\r\n    }\r\n    if (rr >= l) {\r\n        dx /= rr;\r\n        dy /= rr;\r\n        for (j = 1; j < l; j++) {\r\n            i = start + j;\r\n            if (i > this.nbase){\r\n                i -= this.nbase + 1;\r\n            }\r\n            this.bases[i].setX(\r\n                    this.bases[start].getX() + dx * j / l);\r\n            this.bases[i].setY(\r\n                    this.bases[start].getY() + dy * j / l);\r\n        }\r\n    }\r\n    else {\r\n        this.find_center_for_arc((l - 1), rr);\r\n        dx /= rr;\r\n        dy /= rr;\r\n        midx = this.bases[start].getX() + dx * rr / 2.0;\r\n        midy = this.bases[start].getY() + dy * rr / 2.0;\r\n        xn = dy;\r\n        yn = -dx;\r\n        nrx = midx + this._h * xn;\r\n        nry = midy + this._h * yn;\r\n        mx = this.bases[start].getX() - nrx;\r\n        my = this.bases[start].getY() - nry;\r\n        rr = Math.sqrt(mx * mx + my * my);\r\n        a = Math.atan2(my, mx);\r\n        for (j = 1; j < l; j++) {\r\n            i = start + j;\r\n            if (i > this.nbase){\r\n                i -= this.nbase + 1;\r\n            }\r\n            this.bases[i].setX(nrx + rr * Math.cos(a + j * this.angleinc));\r\n            this.bases[i].setY(nry + rr * Math.sin(a + j * this.angleinc));\r\n        }\r\n    }\r\n}\r\n\r\nNAView.prototype.find_center_for_arc = function find_center_for_arc(n, b){\r\n    var h, hhi, hlow, r, disc, theta, e, phi;\r\n    var iter;\r\n\r\n    hhi = (n + 1.0) / Math.PI;\r\n    // changed to prevent div by zero if (ih)\r\n    hlow = -hhi - b / (n + 1.000001 - b);\r\n    if (b < 1){\r\n        // otherwise we might fail below (ih)\r\n        hlow = 0;\r\n    }\r\n    iter = 0;\r\n    do {\r\n        h = (hhi + hlow) / 2.0;\r\n        r = Math.sqrt(h * h + b * b / 4.0);\r\n        disc = 1.0 - 0.5 / (r * r);\r\n        if (Math.abs(disc) > 1.0) {\r\n            console.log(\"Unexpected large magnitude discriminant = \" + disc\r\n                            + \" \" + r);\r\n        }\r\n        theta = Math.acos(disc);\r\n        phi = Math.acos(h / r);\r\n        e = theta * (n + 1) + 2 * phi - 2 * Math.PI;\r\n        if (e > 0.0) {\r\n            hlow = h;\r\n        }\r\n        else {\r\n            hhi = h;\r\n        }\r\n    } while (Math.abs(e) > 0.0001 && ++iter < this.MAXITER);\r\n    if (iter >= this.MAXITER) {\r\n        if (noIterationFailureYet) {\r\n            console.log(\"Iteration failed in find_center_for_arc\");\r\n            noIterationFailureYet = false;\r\n        }\r\n        h = 0.0;\r\n        theta = 0.0;\r\n    }\r\n    this._h = h;\r\n    this.angleinc = theta;\r\n}\r\n\r\nNAView.prototype.generate_region = function generate_region(cp){\r\n    var l, start, end, i, mate;\r\n    var rp;\r\n\r\n    rp = cp.getRegion();\r\n    l = 0;\r\n    if (cp.getStart() == rp.getStart1()) {\r\n        start = rp.getStart1();\r\n        end = rp.getEnd1();\r\n    }\r\n    else {\r\n        start = rp.getStart2();\r\n        end = rp.getEnd2();\r\n    }\r\n    if (this.bases[cp.getStart()].getX() > this.ANUM - 100.0\r\n            || this.bases[cp.getEnd()].getX() > this.ANUM - 100.0) {\r\n        console.log(\r\n                \"Bad region passed to generate_region. Coordinates not defined.\");\r\n    }\r\n    for (i = start + 1; i <= end; i++) {\r\n        l++;\r\n        this.bases[i].setX(\r\n                this.bases[cp.getStart()].getX() + this.HELIX_FACTOR * l\r\n                        * cp.getXrad());\r\n        this.bases[i].setY(\r\n                this.bases[cp.getStart()].getY() + this.HELIX_FACTOR * l\r\n                        * cp.getYrad());\r\n        mate = this.bases[i].getMate();\r\n        this.bases[mate].setX(\r\n                this.bases[cp.getEnd()].getX() + this.HELIX_FACTOR * l\r\n                        * cp.getXrad());\r\n        this.bases[mate].setY(\r\n                this.bases[cp.getEnd()].getY() + this.HELIX_FACTOR * l\r\n                        * cp.getYrad());\r\n\r\n    }\r\n}\r\n\r\nNAView.prototype.minf2 = function minf2(x1, x2) {\r\n    return ((x1) < (x2)) ? (x1) : (x2);\r\n}\r\n\r\nNAView.prototype.maxf2 = function maxf2(x1, x2) {\r\n    return ((x1) > (x2)) ? (x1) : (x2);\r\n}\r\n\r\nNAView.prototype.connected_connection = function connected_connection(cp, cpnext) {\r\n    if (cp.isExtruded()) {\r\n        return true;\r\n    }\r\n    else if (cp.getEnd() + 1 == cpnext.getStart()) {\r\n        return true;\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\n","/* Version: 0.2\r\n* Date: 2015-03-15\r\n*/\r\n\r\nimport fstyle from './fornac.css';\r\n\r\nimport d3 from 'd3';\r\nimport slugid from 'slugid';\r\nimport {contextMenu} from './d3-context-menu.js';\r\n\r\nimport {RNAGraph} from './rnagraph.js';\r\nimport {ColorScheme, rnaUtilities} from './rnautils.js';\r\n\r\nimport {simpleXyCoordinates} from './simplernaplot.js';\r\nimport {NAView} from './naview/naview.js';\r\n\r\nexport function FornaContainer(element, passedOptions = {}) {\r\n    var self = this;\r\n\r\n    let options = {\r\n        'editable': false,\r\n        'zoomable': true,\r\n        'animation': true,\r\n        'displayAllLinks': false,\r\n        'labelInterval': 10,\r\n        'chargeDistance': 110,\r\n        'friction': 0.35,\r\n        'middleCharge': -30,\r\n        'otherCharge': -30,\r\n        'linkDistanceMultiplier': 15,\r\n        'initialSize': null,\r\n        'layout': 'standard-polygonal',\r\n        'transitionDuration': 500,\r\n        'maxNodeRadius': 80    // the maximum radius of a node when the view is centered\r\n    };\r\n\r\n    self.options = Object.assign(options, passedOptions);\r\n\r\n    if (self.options.initialSize !== null) {\r\n        self.options.svgW = self.options.initialSize[0];\r\n        self.options.svgH = self.options.initialSize[1];\r\n    } else {\r\n        self.options.svgW = 300;\r\n        self.options.svgH = 300;\r\n    }\r\n\r\n    self.linkStrengths = {\r\n        'pseudoknot': 0.00,\r\n        'proteinChain': 0.00,\r\n        'chainChain': 0.00,\r\n        'intermolecule': 10.00,\r\n        'external': 0.00,\r\n        'other': 10.00\r\n    };\r\n\r\n    self.displayParameters = {\r\n        'displayNumbering': true,\r\n        'displayNodeOutline': true,\r\n        'displayNodeLabel': true,\r\n        'displayLinks': true,\r\n        'displayPseudoknotLinks': true,\r\n        'displayProteinLinks': true,\r\n        'displayDirectionArrows': true\r\n    };\r\n\r\n    self.colorScheme = 'structure';\r\n    self.customColors = {};\r\n    self.rnas = {};\r\n    self.extraLinks = []; //store links between different RNAs\r\n\r\n    // global mouse event vars\r\n    var mousedownLink = null,\r\n        mousedownNode = null,\r\n        mouseupNode = null;\r\n    let linkContextMenuShown = false;\r\n\r\n    let resetMouseVars = () => {\r\n        mousedownNode = null;\r\n        mouseupNode = null;\r\n        mousedownLink = null;\r\n    }\r\n\r\n    var graph = self.graph = {\r\n        'nodes':[],\r\n        'links':[]\r\n    };\r\n\r\n    Array.prototype.equals = function (array) {\r\n        // if the other array is a falsy value, return\r\n        if (!array)\r\n            return false;\r\n\r\n        // compare lengths - can save a lot of time\r\n        if (this.length != array.length)\r\n            return false;\r\n\r\n        for (var i = 0, l=this.length; i < l; i++) {\r\n            // Check if we have nested arrays\r\n            if (this[i] instanceof Array && array[i] instanceof Array) {\r\n                // recurse into the nested arrays\r\n                if (!this[i].equals(array[i]))\r\n                    return false;\r\n            }\r\n            else if (this[i] != array[i]) {\r\n                // Warning - two different object instances will never be equal: {x:20} != {x:20}\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n\r\n    /* Register global mouse and key events */\r\n    if (self.options.editable || self.options.animation) {\r\n      var shiftKeydown = false;\r\n      var ctrlKeydown = false;\r\n\r\n      let keydown = () => {\r\n          switch (d3.event.keyCode) {\r\n              case 68:    //'d' key\r\n                  console.log('dotbracket:', self.getStructuresDotBracket());\r\n                  break;\r\n              case 16:\r\n                  shiftKeydown = true;\r\n                  break;\r\n              case 17:\r\n                  ctrlKeydown = true;\r\n                  break;\r\n              case 67: //c\r\n                  self.centerView();\r\n                  break;\r\n          }\r\n\r\n          if (ctrlKeydown) {\r\n            // Ctrl key must disable panning and zooming\r\n            if (self.options.zoomable)\r\n              disableZooming()\r\n            // Ctrl Button must enable crosshair and start brusher\r\n            if (self.options.editable || self.options.animation) {\r\n              enableBrushing()\r\n            }\r\n          }\r\n      }\r\n\r\n      let keyup = () => {\r\n          shiftKeydown = false;\r\n          ctrlKeydown = false;\r\n\r\n          // enable zoomer\r\n          if (self.options.zoomable)\r\n            enableZooming()\r\n          // disable brushing events\r\n          disableBrushing()\r\n      }\r\n\r\n      d3.select('body')\r\n      .on('keydown', keydown)\r\n      .on('keyup', keyup)\r\n      .on('contextmenu', function() {\r\n          d3.event.preventDefault();\r\n      });\r\n    }\r\n\r\n    /* Register global context menu */\r\n    if (self.options.editable) {\r\n        let backgroundMenu = [\r\n            {\r\n                title: 'Add Node',\r\n                action: function(elm, d, i, mousePos) {\r\n\r\n                },\r\n                children: [{\r\n                    'title': 'A',\r\n                    action: function(elm, d, i, mousePos) {\r\n                        console.log('mousePos:', mousePos, self.options.svgW, self.options.svgH);\r\n                        let canvasMousePos = [xScale.invert(mousePos[0]),\r\n                                              yScale.invert(mousePos[1])];\r\n                        console.log('canvasMousePos', canvasMousePos);\r\n\r\n                        self.addRNA('.', {'sequence': 'A', 'centerPos': canvasMousePos});\r\n                    }\r\n                },\r\n                {\r\n                    'title': 'C',\r\n                    action: function(elm, d, i, mousePos) {\r\n                        console.log('mousePos:', mousePos, self.options.svgW, self.options.svgH);\r\n                        let canvasMousePos = [xScale.invert(mousePos[0]),\r\n                                              yScale.invert(mousePos[1])];\r\n                        console.log('canvasMousePos', canvasMousePos);\r\n\r\n                        self.addRNA('.', {'sequence': 'C', 'centerPos': canvasMousePos});\r\n                    }\r\n\r\n                    },\r\n                {\r\n                    'title': 'G',\r\n                    action: function(elm, d, i, mousePos) {\r\n                        console.log('mousePos:', mousePos, self.options.svgW, self.options.svgH);\r\n                        let canvasMousePos = [xScale.invert(mousePos[0]),\r\n                                              yScale.invert(mousePos[1])];\r\n                        console.log('canvasMousePos', canvasMousePos);\r\n\r\n                        self.addRNA('.', {'sequence': 'G', 'centerPos': canvasMousePos});\r\n                    }\r\n\r\n                    },\r\n                {\r\n                    'title': 'U',\r\n                    action: function(elm, d, i, mousePos) {\r\n                        console.log('mousePos:', mousePos, self.options.svgW, self.options.svgH);\r\n                        let canvasMousePos = [xScale.invert(mousePos[0]),\r\n                                              yScale.invert(mousePos[1])];\r\n                        console.log('canvasMousePos', canvasMousePos);\r\n\r\n                        self.addRNA('.', {'sequence': 'U', 'centerPos': canvasMousePos});\r\n\r\n                    }\r\n                }\r\n                ],\r\n                disabled: false // optional, defaults to false\r\n            }\r\n        ]\r\n\r\n        let nodeMenu = [\r\n            {\r\n                title: 'Delete Node',\r\n                action: function(elm, d, i) {\r\n                    deleteNode(d);\r\n                },\r\n                disabled: false // optional, defaults to false\r\n            },\r\n            {\r\n                title: 'Change Node',\r\n                action: function(elm, d, i) {\r\n                    console.log('You have clicked the second item!');\r\n                    console.log('The data for this circle is: ' + d);\r\n                },\r\n                children: [\r\n                    {\r\n                        title: 'A',\r\n                        action: function(elm, d, i) {\r\n                            changeNode('A', d);\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'C',\r\n                        action: function(elm, d, i) {\r\n                            changeNode('C', d);\r\n\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'G',\r\n                        action: function(elm, d, i) {\r\n                            changeNode('G', d);\r\n\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'U',\r\n                        action: function(elm, d, i) {\r\n                            changeNode('U', d);\r\n                        }\r\n                    },\r\n                ]\r\n            },\r\n            {\r\n                title: 'Insert Before',\r\n                action: function(elm, d, i) {\r\n\r\n                },\r\n                children: [\r\n                    {\r\n                        title: 'A',\r\n                        action: function(elm, d, i) {\r\n                            insertNodeBeforeOrAfter('A', d, -1);\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'C',\r\n                        action: function(elm, d, i) {\r\n                            insertNodeBeforeOrAfter('C', d, -1);\r\n\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'G',\r\n                        action: function(elm, d, i) {\r\n                            insertNodeBeforeOrAfter('G', d, -1);\r\n\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'U',\r\n                        action: function(elm, d, i) {\r\n                            insertNodeBeforeOrAfter('U', d, -1);\r\n                        }\r\n                    },\r\n                ]\r\n            },\r\n            {\r\n                title: 'Insert After',\r\n                action: function(elm, d, i) {\r\n                    console.log('d:', d);\r\n\r\n                },\r\n                children: [\r\n                    {\r\n                        title: 'A',\r\n                        action: function(elm, d, i) {\r\n                            insertNodeBeforeOrAfter('A', d, 0);\r\n\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'C',\r\n                        action: function(elm, d, i) {\r\n                            insertNodeBeforeOrAfter('C', d, 0);\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'G',\r\n                        action: function(elm, d, i) {\r\n                            insertNodeBeforeOrAfter('G', d, 0);\r\n                        }\r\n                    },\r\n                    {\r\n                        title: 'U',\r\n                        action: function(elm, d, i) {\r\n                            insertNodeBeforeOrAfter('U', d, 0);\r\n                        }\r\n                    },\r\n                ]\r\n            }\r\n        ]\r\n\r\n        self.nodeContextMenu = contextMenu(nodeMenu);\r\n        self.backgroundContextMenu = contextMenu(backgroundMenu);\r\n\r\n    }  else {\r\n        //console.log('empty context menu');\r\n        self.nodeContextMenu = function() {};\r\n    }\r\n\r\n    /* Draw the plot here */\r\n    d3.select(element).select('svg').remove();\r\n\r\n    var svg = d3.select(element)\r\n    .attr('tabindex', 1)\r\n    .each(function() { this.focus(); })\r\n    .append('svg:svg')\r\n    .attr('preserveAspectRatio', 'xMidYMid meet')\r\n    .attr('viewBox', '0 0 ' + self.options.svgW + ' ' + self.options.svgH)\r\n\r\n    self.options.svg = svg;\r\n\r\n    if (self.options.editable || self.options.animation) {\r\n      var mouseEventHelper = svg.append('svg:g')\r\n      .on('mousemove', () => {\r\n            // only if we are dragging\r\n            if (!mousedownNode) return;\r\n\r\n            // update drag line\r\n            let mpos = d3.mouse(vis.node());\r\n            dragLine\r\n            .attr('x1', mousedownNode.x)\r\n            .attr('y1', mousedownNode.y)\r\n            .attr('x2', mpos[0])\r\n            .attr('y2', mpos[1]);\r\n          })\r\n      .on('mousedown', () => {\r\n      })\r\n      .on('mouseup', () => {\r\n            if (mousedownNode && !linkContextMenuShown) {\r\n                dragLine.classed(fstyle.transparent, true);\r\n            }\r\n            // clear mouse event vars\r\n            resetMouseVars();\r\n            //update()\r\n          })\r\n      .classed(fstyle.mouseEventHelper, true)\r\n      .style('pointer-events', 'all')\r\n\r\n      // draw a background layer for mouse events\r\n      mouseEventHelper.append('svg:rect')\r\n      .classed('background', true)\r\n      .style('visibility', 'hidden')\r\n      .attr('width', self.options.svgW)\r\n      .attr('height', self.options.svgH)\r\n      .on('mousedown', function() {\r\n        //console.log('background click');\r\n        deselectAllNodes()\r\n      })\r\n    } else {\r\n      var mouseEventHelper = svg;\r\n    }\r\n\r\n    var vis = mouseEventHelper.append('svg:g')\r\n    .classed(fstyle.plot, true)\r\n    var visLinks = vis.append('svg:g')\r\n    .classed('fornac-links', true);\r\n    var visNodes = vis.append('svg:g')\r\n    .classed('fornac-nodes', true);\r\n\r\n    // line displayed when dragging new nodes\r\n    if (self.options.editable) {\r\n      var dragLine = vis.append('line')\r\n      .attr('class', fstyle.dragLine)\r\n      .attr('x1', 0)\r\n      .attr('y1', 0)\r\n      .attr('x2', 0)\r\n      .attr('y2', 0);\r\n\r\n      svg.on('contextmenu', self.backgroundContextMenu);\r\n    }\r\n\r\n    /* Zooming related objects and functions */\r\n    var xScale = d3.scale.linear()\r\n    .domain([0,self.options.svgW]).range([0,self.options.svgW]);\r\n    var yScale = d3.scale.linear()\r\n    .domain([0,self.options.svgH]).range([0, self.options.svgH]);\r\n\r\n    self.zoomer = d3.behavior.zoom()\r\n      .scaleExtent([0.1,10])\r\n      .x(xScale)\r\n      .y(yScale)\r\n      .on('zoom', () => {\r\n          vis.attr('transform',\r\n                   'translate(' + d3.event.translate + ')' + ' scale(' + d3.event.scale + ')');\r\n      });\r\n\r\n    let enableZooming = () => {\r\n      svg.call(self.zoomer)\r\n      .on(\"dblclick.zoom\", null);\r\n    }\r\n\r\n    let disableZooming = () => {\r\n      svg.call(self.zoomer)\r\n      .on(\"dblclick.zoom\", null)\r\n      .on('mousedown.zoom', null)\r\n      .on('touchstart.zoom', null)\r\n      .on('touchmove.zoom', null)\r\n      .on('touchend.zoom', null);\r\n    }\r\n\r\n    if (self.options.zoomable)\r\n      enableZooming()\r\n\r\n    /* Node selection related objects and functions */\r\n    let toggleSelectNode = (node) => {\r\n      node.selected = !node.selected;\r\n      visNodes.selectAll('g.gnode').filter((d) => { return node.uid == d.uid; })\r\n      .classed(fstyle.selectedNode, function(p) { return p.selected; });\r\n    }\r\n\r\n    let selectNode = (node) => {\r\n      node.selected = true;\r\n      visNodes.selectAll('g.gnode').filter((d) => { return node.uid == d.uid; })\r\n      .classed(fstyle.selectedNode, function(p) { return p.selected; });\r\n    }\r\n\r\n    let deselectAllNodes = () => {\r\n      visNodes.selectAll('g.gnode')\r\n      .classed(fstyle.selectedNode, function(p) { return p.selected = false; });\r\n    }\r\n\r\n    let selectedNodes = () => {\r\n      // return all selected nodes\r\n      return visNodes.selectAll('g.gnode').filter(function(d) { return d.selected; });\r\n    }\r\n\r\n    self.brusher = d3.svg.brush()\r\n      .x(xScale)\r\n      .y(yScale)\r\n      .on('brushstart', function(d) {})\r\n      .on('brush', function() {\r\n        // during brushing invert styling of selection as preview\r\n        let extent = d3.event.target.extent();\r\n\r\n        visNodes.selectAll('g.gnode')\r\n        .classed(fstyle.selectedNode, function (d) {\r\n         return d.selected ^ (extent[0][0] <= d.x && d.x < extent[1][0]\r\n                && extent[0][1] <= d.y && d.y < extent[1][1])\r\n        })\r\n      })\r\n      .on('brushend', function() {\r\n        // after brushing finally toggle the selection\r\n        let extent = d3.event.target.extent();\r\n\r\n        visNodes.selectAll('g.gnode')\r\n        .filter(function (d) {\r\n         return extent[0][0] <= d.x && d.x < extent[1][0]\r\n                && extent[0][1] <= d.y && d.y < extent[1][1]\r\n      })\r\n      .each(toggleSelectNode)\r\n\r\n      d3.event.target.clear();\r\n      d3.select(this).call(d3.event.target);\r\n    });\r\n\r\n    let enableBrushing = () => {\r\n     // crosshair curson\r\n     mouseEventHelper.select('.background').style('cursor', 'crosshair');\r\n     // bind brusher\r\n     mouseEventHelper.call(self.brusher);\r\n    }\r\n\r\n    let disableBrushing = () => {\r\n     // normal cursor\r\n     mouseEventHelper.select('.background').style('cursor', 'auto');\r\n     // disable brushing events\r\n     mouseEventHelper.call(self.brusher)\r\n     .on('mousedown.brush', null)\r\n     .on('touchstart.brush', null)\r\n     .on('touchmove.brush', null)\r\n     .on('touchend.brush', null);\r\n    }\r\n\r\n     /* Force related objects and functions */\r\n    self.force = d3.layout.force()\r\n    .charge(function(d) {\r\n      if (d.nodeType == 'middle')\r\n        return self.options.middleCharge;\r\n      else\r\n        return self.options.otherCharge;\r\n      })\r\n    .friction(self.options.friction)\r\n    .linkDistance(function(d) { return self.options.linkDistanceMultiplier * d.value; })\r\n    .linkStrength(function(d) { if (d.linkType in self.linkStrengths) {\r\n                                  return self.linkStrengths[d.linkType];\r\n                                } else {\r\n                                  return self.linkStrengths.other; }\r\n    })\r\n    .gravity(0.000)\r\n    .nodes(self.graph.nodes)\r\n    .links(self.graph.links)\r\n    .chargeDistance(self.options.chargeDistance)\r\n    .size([self.options.svgW, self.options.svgH]);\r\n\r\n    var drag = d3.behavior.drag()\r\n    .on('dragstart', function(d) {\r\n      console.log('dragstart')\r\n      d3.event.sourceEvent.stopPropagation();\r\n\r\n      selectedNodes().each(function(d1) {\r\n        d1.fixed |= 2;\r\n      });\r\n    })\r\n    .on('drag', (d) => {\r\n      if (shiftKeydown) return\r\n      selectedNodes().each(function(d1) {\r\n        d1.x += d3.event.dx;\r\n        d1.y += d3.event.dy;\r\n\r\n        d1.px += d3.event.dx;\r\n        d1.py += d3.event.dy;\r\n      });\r\n\r\n      self.resumeForce();\r\n      d3.event.sourceEvent.preventDefault();\r\n    })\r\n    .on('dragend', (d) => {\r\n      console.log('dragend')\r\n      selectedNodes().each(function(d1) {\r\n        d1.fixed &= ~6;\r\n      });\r\n    });\r\n\r\n    /* Main plot drawing functions */\r\n    let createInitialLayout = function(structure, passedOptions = {}) {\r\n        // the default options\r\n        let options = {\r\n                        'sequence': '',\r\n                        'name': 'empty',\r\n                        'positions': [],\r\n                        'labelInterval': self.options.labelInterval,\r\n                        'avoidOthers': true,\r\n                        'uids': [],\r\n                        'circularizeExternal': true\r\n                      };\r\n\r\n        options = Object.assign(options, passedOptions);\r\n\r\n        //console.log('options.uids:', options.uids);\r\n        let rg = new RNAGraph(options.sequence, structure, options.name);\r\n        rg.circularizeExternal = options.circularizeExternal;\r\n\r\n        let rnaJson = rg.recalculateElements();\r\n\r\n        if (options.positions.length === 0) {\r\n            // no provided positions means we need to calculate an initial layout\r\n\r\n            if (self.options.layout == 'naview') {\r\n                let naview = new NAView();\r\n\r\n                let naViewPositions = naview.naview_xy_coordinates(rg.pairtable);\r\n                options.positions = []\r\n                for (let i = 0; i < naViewPositions.nbase; i++)\r\n                    options.positions.push([naViewPositions.x[i], naViewPositions.y[i]]);\r\n            } else {\r\n                options.positions = simpleXyCoordinates(rnaJson.pairtable);\r\n            }\r\n        }\r\n\r\n        rnaJson = rnaJson.elementsToJson()\r\n        .addUids(options.uids)\r\n        .addPositions('nucleotide', options.positions)\r\n        .addLabels(1, options.labelInterval)\r\n        .reinforceStems()\r\n        .reinforceLoops()\r\n        .connectFakeNodes()\r\n        .reassignLinkUids()\r\n        .breakNodesToFakeNodes();\r\n\r\n        return rnaJson;\r\n    };\r\n\r\n    let createNewNodes = function(gnodesEnter) {\r\n        gnodesEnter = gnodesEnter.append('g')\r\n        .classed('gnode', true)\r\n        .attr('struct_name', function(d) { return d.structName; })\r\n        .attr('transform', function(d) {\r\n            if (typeof d.x != 'undefined' && typeof d.y != 'undefined')\r\n                return 'translate(' + [d.x, d.y] + ')';\r\n            else\r\n                return '';\r\n        })\r\n        .each( function(d) { d.selected = d.previouslySelected = false; });\r\n\r\n        gnodesEnter\r\n        .attr('num', function(d) { return 'n' + d.num; })\r\n        .attr('rnum', function(d) {\r\n            return 'n' + (d.rna.rnaLength - d.num + 1); })\r\n        .transition()\r\n        .duration(750)\r\n        .ease('elastic');\r\n\r\n        if (self.options.editable || self.options.animation) {\r\n          gnodesEnter.on('mousedown', nodeMousedown)\r\n          //.on('mousedrag', function(d) {})\r\n          .on('mouseup', nodeMouseup)\r\n          .on('contextmenu', self.nodeContextMenu)\r\n          .call(drag)\r\n        }\r\n\r\n        let labelAndProteinNodes = gnodesEnter.filter(function(d) {\r\n            return d.nodeType == 'label' || d.nodeType == 'protein';\r\n        });\r\n\r\n        let nucleotideNodes = gnodesEnter.filter(function(d) {\r\n            return d.nodeType == 'nucleotide';\r\n        });\r\n\r\n        labelAndProteinNodes.append('svg:circle')\r\n        .classed(fstyle.node, true)\r\n        .attr('r', function(d) {\r\n            if (d.nodeType == 'middle') return 0;\r\n            else {\r\n                return d.radius;\r\n            }\r\n        })\r\n        .attr('node_type', function(d) { return d.nodeType; })\r\n        .attr('node_num', function(d) { return d.num; });\r\n\r\n        // direction arrows\r\n        nucleotideNodes.append('svg:path')\r\n        .attr('class', fstyle.directionArrow)\r\n        .attr('node_num', function(d) { return d.num; })\r\n\r\n        // nucleotide outlines\r\n        nucleotideNodes.append('svg:circle')\r\n        .attr('class', fstyle.node)\r\n        .attr('node_type', function(d) { return d.nodeType; })\r\n        .attr('node_num', function(d) { return d.num; })\r\n        .attr('r', function(d) { return d.radius; })\r\n        .append('svg:title')\r\n        .text(function(d) {\r\n            if (d.nodeType == 'nucleotide') {\r\n                return d.structName + ':' + d.num;\r\n            } else {\r\n                return '';\r\n            }\r\n        });\r\n\r\n        // nucleotide labels\r\n        var labelsEnter = gnodesEnter.append('text')\r\n        .text(function(d) { return d.name; })\r\n        .attr('class', fstyle.nodeLabel)\r\n        .attr('label_type', function(d) { return d.nodeType; })\r\n\r\n        // nucleotide label title\r\n        labelsEnter.append('svg:title')\r\n        .text(function(d) {\r\n            if (d.nodeType == 'nucleotide') {\r\n                return d.structName + ':' + d.num;\r\n            } else {\r\n                return '';\r\n            }\r\n        });\r\n\r\n        return gnodesEnter;\r\n    };\r\n\r\n    let createNewLinks = function(linksEnter) {\r\n        var linkLines = linksEnter.append('svg:line');\r\n\r\n        linkLines.append('svg:title')\r\n        .text((d) => { return d.linkType + ':' + d.source.num + '-' + d.target.num });\r\n\r\n        linkLines\r\n        .classed('link', true)\r\n        .classed(fstyle.link, true)\r\n        .attr('x1', function(d) { return d.source.x; })\r\n        .attr('y1', function(d) { return d.source.y; })\r\n        .attr('x2', function(d) { return d.target.x; })\r\n        .attr('y2', function(d) { return d.target.y; })\r\n        .attr('link_type', function(d) { return d.linkType; } )\r\n        .attr('pointer-events', function(d) { if (d.linkType == 'fake') return 'none'; else return 'all';});\r\n\r\n        if (self.options.editable)\r\n          linkLines.on('click', linkClick);\r\n\r\n        /* We don't need to update the positions of the stabilizing links */\r\n        /*\r\n        basepairLinks = visLinks.selectAll('[link_type=basepair]');\r\n        basepairLinks.classed('basepair', true);\r\n\r\n        fakeLinks = visLinks.selectAll('[link_type=fake]')\r\n        fakeLinks.classed('fake', true);\r\n\r\n        intermolecule_links = vis_links.selectAll('[link_type=intermolecule]');\r\n        intermolecule_links.classed('intermolecule', true);\r\n\r\n        plink = vis_links.selectAll('[link_type=protein_chain],[link_type=chain_chain]');\r\n        plink.classed('chain_chain', true);\r\n        */\r\n\r\n       return linkLines;\r\n    };\r\n\r\n    function drawDirectionArrow(d) {\r\n        let magnitude = (x) => {\r\n            return Math.sqrt(x[0] * x[0] + x[1] * x[1]);\r\n        }\r\n\r\n        let endPoint = d;\r\n        let startPoint = d.prevNode;\r\n        // get stroke width and arrow size values from css\r\n        let nodeStroke = parseFloat(fstyle.nodeStrokeWidth) / 2;\r\n        let lengthMult = parseFloat(fstyle.directionArrowSize);\r\n        let arrowWidth = parseFloat(fstyle.directionArrowWidth);\r\n\r\n        if (startPoint === null)\r\n            return;\r\n\r\n        // does this node have a link pointing to it?\r\n        if (!d.linked)\r\n            return;\r\n\r\n        // point back toward the previous node\r\n        let u = [-(endPoint.x - startPoint.x), -(endPoint.y - startPoint.y)];\r\n\r\n        if (u[0] == 0 && u[1] == 0)\r\n            return;     // will lead to a NaN error\r\n\r\n        // scale u to unit length\r\n        u = [u[0] / magnitude(u), u[1] / magnitude(u)];\r\n        // normal vector of u\r\n        let v = [-u[1], u[0]];\r\n\r\n        // calculate the tip position\r\n        let arrowTip = [(d.radius + nodeStroke) * u[0], (d.radius + nodeStroke) * u[1]];\r\n\r\n        let path = 'M' + (arrowTip[0] + lengthMult * (u[0]/2 + v[0]*arrowWidth/2)) + ',' + (arrowTip[1] + lengthMult * (u[1]/2 + v[1]*arrowWidth/2)) +\r\n                   'L' + (arrowTip[0]) + ',' + (arrowTip[1]) +\r\n                   'L' + (arrowTip[0] + lengthMult * (u[0]/2 - v[0]*arrowWidth/2)) + ',' + (arrowTip[1] + lengthMult * (u[1]/2 - v[1]*arrowWidth/2));\r\n\r\n        d3.select(this).attr('d', path);\r\n    }\r\n\r\n    let realLinkFilter = (d) => {\r\n        return d.linkType == 'basepair' ||\r\n               d.linkType == 'backbone' ||\r\n               d.linkType == 'intermolecule' ||\r\n               d.linkType == 'pseudoknot' ||\r\n               d.linkType == 'label_link' ||\r\n               d.linkType == 'external' ||\r\n               d.linkType == 'chain_chain';\r\n    }\r\n\r\n    let recalculateGraph = () => {\r\n        // Condense all of the individual RNAs into one\r\n        // collection of nodes and links\r\n        self.graph.nodes = [];\r\n        self.graph.links = [];\r\n        for (let uid in self.rnas) {\r\n            self.graph.nodes = self.graph.nodes.concat(self.rnas[uid].nodes);\r\n            self.graph.links = self.graph.links.concat(self.rnas[uid].links);\r\n        }\r\n\r\n        // Create a lookup table so that we can access each node\r\n        // based on its uid. This will be used to create the links\r\n        // between different RNAs\r\n        var uidsToNodes = {};\r\n\r\n        for (let i = 0; i < self.graph.nodes.length; i++)\r\n            uidsToNodes[self.graph.nodes[i].uid] = self.graph.nodes[i];\r\n\r\n        self.graph.links.forEach(function(link) {\r\n            link.source = uidsToNodes[link.source.uid];\r\n            link.target = uidsToNodes[link.target.uid];\r\n        });\r\n\r\n        for (let i = 0; i < self.extraLinks.length; i++) {\r\n            // the actual node objects may have changed, so we hae to recreate\r\n            // the extra links based on the uids\r\n            if (!(self.extraLinks[i].target.uid in uidsToNodes)) {\r\n                console.log('not there:', self.extraLinks[i]);\r\n                continue;\r\n            }\r\n\r\n            self.extraLinks[i].source = uidsToNodes[self.extraLinks[i].source.uid];\r\n            self.extraLinks[i].target = uidsToNodes[self.extraLinks[i].target.uid];\r\n\r\n            if (self.extraLinks[i].linkType == 'intermolecule') {\r\n                //remove links to middle nodes\r\n                let fakeLinks = self.graph.links.filter(function(d) {\r\n                    return ((d.source == self.extraLinks[i].source || d.source == self.extraLinks[i].target ||\r\n                            d.target == self.extraLinks[i].source || d.target == self.extraLinks[i].source) &&\r\n                            d.linkType == 'fake');\r\n                });\r\n\r\n                for (let j = 0; j < fakeLinks.length; j++) {\r\n                    let linkIndex = self.graph.links.indexOf(fakeLinks[j]);\r\n                    self.graph.links.splice(linkIndex, 1);\r\n                }\r\n            }\r\n\r\n            graph.links.push(self.extraLinks[i]);\r\n        }\r\n    };\r\n\r\n    self.update = function () {\r\n        self.force.nodes(self.graph.nodes)\r\n        .links(self.graph.links);\r\n\r\n        if (self.options.animation) {\r\n          self.force.start();\r\n        }\r\n\r\n        let allLinks = visLinks.selectAll('line.link')\r\n        .data(self.graph.links.filter(realLinkFilter), elementKey);\r\n\r\n        allLinks.attr('class', '')\r\n        .classed('link', true)\r\n        .classed(fstyle.link, true)\r\n        .attr('link_type', function(d) { return d.linkType; } )\r\n\r\n        let linksEnter = allLinks.enter();\r\n        createNewLinks(linksEnter);\r\n\r\n        allLinks.exit().remove();\r\n\r\n        let gnodes = visNodes.selectAll('g.gnode')\r\n        .data(self.graph.nodes, elementKey);\r\n        //.attr('pointer-events', 'all');\r\n\r\n        let gnodesEnter = gnodes.enter();\r\n        createNewNodes(gnodesEnter);\r\n        gnodes.exit().remove();\r\n\r\n\r\n        //fake_nodes = self.graph.nodes.filter(function(d) { return d.nodeType == 'middle'; });\r\n        //fakeNodes = self.graph.nodes.filter(function(d) { return true; });\r\n        let realNodes = self.graph.nodes.filter(function(d) { return d.nodeType == 'nucleotide' || d.nodeType == 'label';});\r\n\r\n        gnodes.select('.' + fstyle.directionArrow).each(drawDirectionArrow);\r\n\r\n        self.force.on('tick', function() {\r\n            let q = d3.geom.quadtree(realNodes);\r\n            let i = 0;\r\n            let n = realNodes.length;\r\n\r\n            let collide = (node) => {\r\n                let r = node.radius + 16,\r\n                nx1 = node.x - r,\r\n                nx2 = node.x + r,\r\n                ny1 = node.y - r,\r\n                ny2 = node.y + r;\r\n                return function(quad, x1, y1, x2, y2) {\r\n                    if (quad.point && (quad.point !== node)) {\r\n                        let x = node.x - quad.point.x,\r\n                        y = node.y - quad.point.y,\r\n                        l = Math.sqrt(x * x + y * y),\r\n                        r = node.radius + quad.point.radius;\r\n                        if (l < r) {\r\n                            l = (l - r) / l * 0.1;\r\n                            node.x -= x *= l;\r\n                            node.y -= y *= l;\r\n                            quad.point.x += x;\r\n                            quad.point.y += y;\r\n                        }\r\n                    }\r\n                    return x1 > nx2 || x2 < nx1 || y1 > ny2 || y2 < ny1;\r\n                };\r\n            }\r\n\r\n            while (++i < n) q.visit(collide(realNodes[i]));\r\n\r\n            allLinks.attr('x1', function(d) { return d.source.x; })\r\n            .attr('y1', function(d) {  return d.source.y; })\r\n            .attr('x2', function(d) { return d.target.x; })\r\n            .attr('y2', function(d) { return d.target.y; });\r\n\r\n            // Translate the groups\r\n            gnodes.attr('transform', function(d) {\r\n                return 'translate(' + [d.x, d.y] + ')';\r\n            });\r\n\r\n            gnodes.select('.' + fstyle.directionArrow).each(drawDirectionArrow);\r\n\r\n        });\r\n\r\n        self.force.on('end', () => {\r\n            gnodes.selectAll('[node_type=nucleotide]')\r\n            .filter((d,i) => { if (i == 0) return true; else return false; })\r\n            .each((d,i) => {\r\n                //console.log(\"pos\", d.num, d.x, d.y);\r\n            });\r\n\r\n            //for (let uid in self.rnas) {\r\n            //    for (let i = 1; i < self.rnas[uid].pairtable[0]; i++) {\r\n            //        console.log('pt', i, self.rnas[uid].pairtable[i]);\r\n            //    }\r\n            //}\r\n\r\n        });\r\n\r\n        self.changeColorScheme(self.colorScheme);\r\n\r\n        if (self.options.animation) {\r\n          self.force.start();\r\n        }\r\n\r\n        updateStyle();\r\n    };\r\n\r\n    self.transitionRNA = function(newStructure, nextFunction) {\r\n        if (self.dotbracket == newStructure) {\r\n            return;\r\n        } else {\r\n            self.dotbracket = newStructure;\r\n        }\r\n        //transition from an RNA which is already displayed to a new structure\r\n        var duration = self.options.transitionDuration;\r\n\r\n        var uids = self.graph.nodes\r\n        .filter(function(d) { return d.nodeType == 'nucleotide'; })\r\n        .map(function(d) { return d.uid; });\r\n\r\n        let options = {'uids': uids};\r\n        var newRNAJson = createInitialLayout(newStructure, options);\r\n\r\n        let gnodes = visNodes.selectAll('g.gnode').data(newRNAJson.nodes, elementKey);\r\n        var links = visLinks.selectAll('line.link').data(newRNAJson.links.filter(realLinkFilter), elementKey);\r\n\r\n        if (duration === 0)\r\n            gnodes.attr('transform', function(d) {\r\n                return 'translate(' + [d.x, d.y] + ')';\r\n            });\r\n        else {\r\n            gnodes.transition()\r\n            .attr('transform', function(d) {\r\n                return 'translate(' + [d.x, d.y] + ')'; }).duration(duration);\r\n        }\r\n\r\n\r\n        var newNodes = createNewNodes(gnodes.enter())\r\n        .attr('transform', function(d) {\r\n            if (typeof d.x != 'undefined' && typeof d.y != 'undefined')\r\n                return 'translate(' + [0, 0] + ')';\r\n            else\r\n                return '';\r\n        });\r\n\r\n        if (duration === 0)\r\n            gnodes.exit().remove();\r\n        else\r\n            gnodes.exit().transition()\r\n            .attr('transform', function(d) {\r\n                if (typeof d.x != 'undefined' && typeof d.y != 'undefined')\r\n                    return 'translate(' + [0, 0] + ')';\r\n                else\r\n                    return '';\r\n            });\r\n\r\n        self.graph.nodes = gnodes.data();\r\n        gnodes.select('.' + fstyle.directionArrow).each(drawDirectionArrow);\r\n        self.changeColorScheme(self.colorScheme);\r\n        updateStyle();\r\n        self.centerView(duration);\r\n\r\n        function endall(transition, callback) {\r\n            if (transition.size() === 0) { setTimeout(callback, duration); }\r\n            var n = 0;\r\n            transition\r\n            .each(function() { ++n; })\r\n            .each('end', function() { if (!--n) callback.apply(this, arguments); });\r\n        }\r\n\r\n        function afterAnimation() {\r\n            var newLinks = createNewLinks(links.enter());\r\n            self.graph.links = links.data();\r\n            self.changeColorScheme(self.colorScheme);\r\n            updateStyle();\r\n\r\n            if (typeof nextFunction != 'undefined')\r\n                nextFunction();\r\n\r\n        }\r\n\r\n        links.exit().remove();\r\n\r\n        if (duration === 0) {\r\n            links\r\n            .attr('x1', function(d) { return d.source.x; })\r\n            .attr('y1', function(d) { return d.source.y; })\r\n            .attr('x2', function(d) { return d.target.x; })\r\n            .attr('y2', function(d) { return d.target.y; });\r\n\r\n            var newLinks = createNewLinks(links.enter());\r\n            self.graph.links = links.data();\r\n\r\n            updateStyle();\r\n        } else {\r\n            links.transition()\r\n            .attr('x1', function(d) { return d.source.x; })\r\n            .attr('y1', function(d) { return d.source.y; })\r\n            .attr('x2', function(d) { return d.target.x; })\r\n            .attr('y2', function(d) { return d.target.y; })\r\n            .duration(duration)\r\n            .call(endall, afterAnimation);\r\n        }\r\n\r\n        if (duration === 0) {\r\n            newNodes\r\n            .attr('transform', function(d) {\r\n                if (typeof d.x != 'undefined' && typeof d.y != 'undefined')\r\n                    return 'translate(' + [d.x, d.y] + ')';\r\n                else\r\n                    return '';\r\n            });\r\n        } else {\r\n            newNodes.transition()\r\n            .attr('transform', function(d) {\r\n                if (typeof d.x != 'undefined' && typeof d.y != 'undefined')\r\n                    return 'translate(' + [d.x, d.y] + ')';\r\n                else\r\n                    return '';\r\n            });\r\n        }\r\n\r\n    };\r\n\r\n    /* Plot presentation related functions */\r\n    let getBoundingBoxTransform = () => {\r\n        // Center the view on the molecule(s) and scale it so that everything\r\n        // fits in the window\r\n\r\n        //no molecules, nothing to do\r\n        if (self.graph.nodes.length === 0)\r\n            return {'translate': [0,0], 'scale': 1};\r\n\r\n        // Get the bounding box\r\n        var minX = d3.min(self.graph.nodes.map(function(d) {return d.x;}));\r\n        var minY = d3.min(self.graph.nodes.map(function(d) {return d.y;}));\r\n\r\n        var maxX = d3.max(self.graph.nodes.map(function(d) {return d.x;}));\r\n        var maxY = d3.max(self.graph.nodes.map(function(d) {return d.y;}));\r\n\r\n        var maxRadius = d3.max(self.graph.nodes.map(function(d) { return d.radius; }));\r\n\r\n        // The width and the height of the molecule\r\n        var molWidth = maxX - minX;\r\n        var molHeight = maxY - minY;\r\n\r\n        // how much larger the drawing area is than the width and the height\r\n        var widthRatio = self.options.svgW / (molWidth + 1);\r\n        var heightRatio = self.options.svgH / (molHeight + 1);\r\n\r\n        // we need to fit it in both directions, so we scale according to\r\n        // the direction in which we need to shrink the most\r\n        var minRatio = Math.min(widthRatio, heightRatio,\r\n                                self.options.maxNodeRadius / maxRadius) * 0.8;\r\n\r\n        // the new dimensions of the molecule\r\n        var newMolWidth = molWidth * minRatio;\r\n        var newMolHeight = molHeight * minRatio;\r\n\r\n        // translate so that it's in the center of the window\r\n        var xTrans = -(minX) * minRatio + (self.options.svgW - newMolWidth) / 2;\r\n        var yTrans = -(minY) * minRatio + (self.options.svgH - newMolHeight) / 2;\r\n\r\n        return {'translate': [xTrans, yTrans], 'scale': minRatio};\r\n    };\r\n\r\n    self.centerView = function(duration = 0) {\r\n        var bbTransform = getBoundingBoxTransform();\r\n\r\n        if (bbTransform === null)\r\n            return;\r\n\r\n        // do the actual moving\r\n        vis.transition().attr('transform',\r\n                 'translate(' + bbTransform.translate + ')' + ' scale(' + bbTransform.scale + ')').duration(duration);\r\n\r\n        // tell the zoomer what we did so that next we zoom, it uses the\r\n        // transformation we entered here\r\n        self.zoomer.translate(bbTransform.translate);\r\n        self.zoomer.scale(bbTransform.scale);\r\n    };\r\n\r\n    self.setSize = (\r\n      svgW = d3.select(element).node().offsetWidth,\r\n      svgH = d3.select(element).node().offsetHeight\r\n    ) => {\r\n      // save width and height\r\n      self.options.svgW = svgW;\r\n      self.options.svgH = svgH;\r\n\r\n      // set the viewBox\r\n      svg.attr('viewBox', \"0 0 \" + svgW + \" \" + svgH)\r\n\r\n      //Set the output range of the scales\r\n      xScale.range([0, svgW]).domain([0, svgW]);\r\n      yScale.range([0, svgH]).domain([0, svgH]);\r\n\r\n      //re-attach the scales to the zoom behaviour\r\n      self.zoomer.x(xScale)\r\n      .y(yScale);\r\n      self.brusher.x(xScale)\r\n      .y(yScale);\r\n\r\n      //resize the background\r\n      svg.select('.background')\r\n      .attr('width', svgW)\r\n      .attr('height', svgH);\r\n\r\n      // center the view\r\n      self.centerView();\r\n    }\r\n\r\n    /* Style and color related functions */\r\n    self.setOutlineColor = function(color) {\r\n        var nodes = visNodes.selectAll('g.gnode').select('[node_type=nucleotide]');\r\n        nodes.style('fill', color);\r\n    }\r\n\r\n    self.addCustomColors = function addCustomColors(json) {\r\n        // Add a json file containing the custom colors\r\n        self.customColors = json;\r\n        self.changeColorScheme('custom');\r\n    };\r\n\r\n    self.addCustomColorsText = function(customColorsText) {\r\n        let cs = new ColorScheme(customColorsText);\r\n        self.customColors = cs.colorsJson;\r\n        self.changeColorScheme('custom');\r\n    };\r\n\r\n    self.changeColorScheme = function(newColorScheme) {\r\n        var proteinNodes = visNodes.selectAll('[node_type=protein]');\r\n\r\n        proteinNodes.classed(fstyle.node, true)\r\n                    .attr('r', function(d) { return d.radius; });\r\n\r\n        var gnodes = visNodes.selectAll('g.gnode');\r\n        var circles = visNodes.selectAll('g.gnode').selectAll('circle');\r\n        var nodes = visNodes.selectAll('g.gnode').select('[node_type=nucleotide]');\r\n        self.colorScheme = newColorScheme;\r\n\r\n\r\n        if (newColorScheme == 'sequence') {\r\n            var scale = d3.scale.ordinal()\r\n            .range(['#dbdb8d', '#98df8a', '#ff9896', '#aec7e8', '#aec7e8'])\r\n            .domain(['A','C','G','U','T']);\r\n            nodes.style('fill', function(d) {\r\n                return scale(d.name);\r\n            });\r\n\r\n        } else if (newColorScheme == 'structure') {\r\n            var scale = d3.scale.category10()\r\n            .domain(['s','m','i','e','t','h','x'])\r\n            .range(['lightgreen', '#ff9896', '#dbdb8d', 'lightsalmon',\r\n                   'lightcyan', 'lightblue', 'transparent']);\r\n\r\n                   nodes.style('fill', function(d) {\r\n                       return scale(d.elemType);\r\n                   });\r\n\r\n        } else if (newColorScheme == 'positions') {\r\n            nodes.style('fill', function(d) {\r\n                var scale = d3.scale.linear()\r\n                .range(['#98df8a', '#dbdb8d', '#ff9896'])\r\n                .interpolate(d3.interpolateLab)\r\n                .domain([1, 1 + (d.rna.rnaLength - 1) / 2, d.rna.rnaLength]);\r\n\r\n                return scale(d.num);\r\n            });\r\n        } else if (newColorScheme == 'custom') {\r\n            // scale to be used in case the user passes scalar\r\n            // values rather than color names\r\n            if (typeof self.customColors != 'undefined' &&\r\n                'domain' in self.customColors &&\r\n               'range' in self.customColors) {\r\n                var scale = d3.scale.linear()\r\n                .interpolate(d3.interpolateLab)\r\n                .domain(self.customColors.domain)\r\n                .range(self.customColors.range);\r\n            }\r\n\r\n            let changeColors = (moleculeColors, d, scale) => {\r\n                if (moleculeColors.hasOwnProperty(d.num)) {\r\n                    let val = parseFloat(moleculeColors[d.num]);\r\n\r\n                    if (isNaN(val)) {\r\n                        // passed in color is not a scalar, so\r\n                        // treat it as a color\r\n                        return moleculeColors[d.num];\r\n                    } else {\r\n                        // the user passed in a float, let's use a colormap\r\n                        // to convert it to a color\r\n                        return scale(val);\r\n                    }\r\n                } else {\r\n                    return 'white';\r\n                }\r\n            }\r\n\r\n            nodes.style('fill', function(d) {\r\n                if (typeof self.customColors == 'undefined' ||\r\n                   !self.customColors.hasOwnProperty('colorValues')) {\r\n                    return 'white';\r\n                }\r\n\r\n                if (self.customColors.colorValues.hasOwnProperty(d.structName) &&\r\n                    self.customColors.colorValues[d.structName].hasOwnProperty(d.num)) {\r\n                    // if a molecule name is specified, it supercedes the default colors\r\n                    // (for which no molecule name has been specified)\r\n                    let moleculeColors = self.customColors.colorValues[d.structName];\r\n                    return changeColors(moleculeColors, d, scale);\r\n                } else if (self.customColors.colorValues.hasOwnProperty('')) {\r\n                    let moleculeColors = self.customColors.colorValues[''];\r\n                    return changeColors(moleculeColors, d, scale);\r\n                }\r\n\r\n                return 'white';\r\n            });\r\n        }\r\n    };\r\n\r\n    let updateStyle = () => {\r\n        // Numbering\r\n        visNodes.selectAll('[node_type=label]').classed(fstyle.transparent, !self.displayParameters.displayNumbering);\r\n        visNodes.selectAll('[label_type=label]').classed(fstyle.transparent, !self.displayParameters.displayNumbering);\r\n        visLinks.selectAll('[link_type=label_link]').classed(fstyle.transparent, !self.displayParameters.displayNumbering);\r\n        // Node Outline\r\n        svg.selectAll('[node_type=nucleotide]').classed(fstyle.transparent, !self.displayParameters.displayNodeOutline);\r\n        // Node Labels\r\n        visNodes.selectAll('[label_type=nucleotide]').classed(fstyle.transparent, !self.displayParameters.displayNodeLabel);\r\n        // Links\r\n        svg.selectAll('[link_type=real],[link_type=basepair],[link_type=backbone],[link_type=pseudoknot],[link_type=protein_chain],[link_type=chain_chain],[link_type=external]').classed(fstyle.transparent, !self.displayParameters.displayLinks);\r\n        // Pseudoknot Links\r\n        svg.selectAll('[link_type=pseudoknot]').classed(fstyle.transparent, !self.displayParameters.displayPseudoknotLinks);\r\n        // Protein Links\r\n        svg.selectAll('[link_type=protein_chain]').classed(fstyle.transparent, !self.displayParameters.displayProteinLinks);\r\n        // Fake Links\r\n        visLinks.selectAll('[link_type=fake]').classed(fstyle.transparent, !self.options.displayAllLinks);\r\n        visLinks.selectAll('[link_type=fake_fake]').classed(fstyle.transparent, !self.options.displayAllLinks);\r\n        // direction Arrows\r\n        svg.selectAll('.' + fstyle.directionArrow).classed(fstyle.transparent, !self.displayParameters.displayDirectionArrows);\r\n    };\r\n\r\n    /* RNA edditing related functions */\r\n    let changeNode = function(nodeName, referenceNode) {\r\n        // change the label of a node\r\n        let rna = referenceNode.rna;\r\n\r\n        let dotbracket = rnaUtilities.pairtableToDotbracket(rna.pairtable);\r\n        let positions = rna.getPositions('nucleotide');\r\n        let sequence = rna.seq\r\n        let uids = rna.getUids();\r\n\r\n        let newNodeNum = referenceNode.num;\r\n\r\n        let newDotbracket = dotbracket;\r\n        let newSequence = sequence.slice(0,newNodeNum-1) +  nodeName + sequence.slice(newNodeNum);\r\n\r\n        console.log('newSequence:', newSequence);\r\n\r\n        console.log('uids:', uids);\r\n        uids.splice(newNodeNum-1, 1, slugid.nice());\r\n        let newPositions = positions;\r\n\r\n        delete self.rnas[rna.uid];\r\n        let newRNA = self.addRNA(newDotbracket, {'sequence': newSequence,\r\n                                 'positions': newPositions,\r\n                                 'uids': uids,\r\n                                 'centerView': false});\r\n    }\r\n\r\n    let insertNodeBeforeOrAfter = function(nodeName, referenceNode, positionOffset) {\r\n        //insert a new node before or after another one\r\n        //positionOffset specifies who far from the original to insert the new node\r\n        let rna = referenceNode.rna;\r\n\r\n        let dotbracket = rnaUtilities.pairtableToDotbracket(rna.pairtable);\r\n        let positions = rna.getPositions('nucleotide');\r\n        let sequence = rna.seq\r\n        let uids = rna.getUids();\r\n\r\n        let newNodeNum = referenceNode.num + positionOffset;\r\n\r\n        let newDotbracket = dotbracket.slice(0,newNodeNum) + '.' + dotbracket.slice(newNodeNum);\r\n        let newSequence = sequence.slice(0,newNodeNum) +  nodeName + sequence.slice(newNodeNum);\r\n\r\n        console.log('newSequence:', newSequence);\r\n\r\n        uids.splice(newNodeNum, 0, slugid.nice());\r\n        positions.splice(newNodeNum, 0, positions[newNodeNum - positionOffset-1]);\r\n\r\n        let newUids = uids;\r\n        let newPositions = positions;\r\n\r\n        console.log('positions:', positions);\r\n        console.log('new node positions:', newPositions);\r\n\r\n        delete self.rnas[rna.uid];\r\n        let newRNA = self.addRNA(newDotbracket, {'sequence': newSequence,\r\n                                 'positions': newPositions,\r\n                                 'uids': newUids,\r\n                                 'centerView': false});\r\n    }\r\n\r\n    let deleteNode = function(node) {\r\n        console.log('deleting...', node);\r\n        // get the dotbracket string for this rna\r\n        let rna = node.rna;\r\n        let pair = rna.pairtable[node.num];\r\n\r\n        // remove basepairs for this node\r\n        if (pair != 0) {\r\n            rna.pairtable[node.num] = 0;\r\n            rna.pairtable[pair] = 0;\r\n        }\r\n\r\n        let dotbracket = rnaUtilities.pairtableToDotbracket(rna.pairtable);\r\n        let positions = rna.getPositions('nucleotide');\r\n        let sequence = rna.seq\r\n        let uids = rna.getUids();\r\n\r\n        let newDotbracket = dotbracket.slice(0, node.num-1) + dotbracket.slice(node.num)\r\n        let newPositions = positions.slice(0, node.num-1)\r\n                .concat(positions.slice(node.num));\r\n        let newSequence = sequence.slice(0, node.num-1) + sequence.slice(node.num)\r\n        let newUids = uids.slice(0, node.num-1)\r\n                .concat(uids.slice(node.num));\r\n\r\n        delete self.rnas[rna.uid];\r\n        let newRNA = self.addRNA(newDotbracket, {'sequence': newSequence,\r\n                                 'positions': newPositions,\r\n                                 'uids': newUids,\r\n                                  'centerView': false});\r\n\r\n        console.log('new dotbracket:', newDotbracket);\r\n        //recalculateGraph();\r\n\r\n        //remove backbone links associated with this node\r\n\r\n        //remove this node\r\n\r\n    }\r\n\r\n    let elementKey = (d) => {\r\n        return d.uid;\r\n    };\r\n\r\n    let updateRnaGraph = function(r) {\r\n        let nucleotidePositions = r.getPositions('nucleotide');\r\n        let labelPositions = r.getPositions('label');\r\n\r\n        let uids = r.getUids();\r\n\r\n        r.recalculateElements()\r\n        .elementsToJson()\r\n        .addPseudoknots()\r\n        .addPositions('nucleotide', nucleotidePositions)\r\n        .addUids(uids)\r\n        .addLabels(1, self.options.labelInterval)\r\n        .addPositions('label', labelPositions)\r\n        .reinforceStems()\r\n        .reinforceLoops()\r\n        .updateLinkUids();\r\n    };\r\n\r\n    let removeBackBoneLink = function(d) {\r\n        if (d.target.num - d.source.num != 1) {\r\n            console.log('ERROR: non adjacent nodes. Target:', d.target,\r\n                        'Source:', d.source, 'Link:', d);\r\n            return;\r\n        }\r\n\r\n        let rna = d.target.rna;\r\n        let toRemove = [];\r\n\r\n        for (let i = 0; i < rna.links.length; i++) {\r\n            let link = rna.links[i];\r\n\r\n            if (link.linkType != 'basepair')\r\n                continue;\r\n\r\n            if (link.source.num <= d.source.num && link.target.num >= d.target.num) {\r\n                console.log('crossing basepair', link);\r\n                toRemove.push(link);\r\n            }\r\n        }\r\n\r\n\r\n        // Remove all base pairs that are between these two nodes and add them as extra\r\n        // links\r\n        console.log('toRemove:', toRemove);\r\n\r\n        for (let i = 0; i < toRemove.length; i++) {\r\n            rna.pairtable[toRemove[i].source.num] = 0;\r\n            rna.pairtable[toRemove[i].target.num] = 0;\r\n\r\n            toRemove[i].from = toRemove[i].source.num;\r\n            toRemove[i].to = toRemove[i].target.num - d.source.num;\r\n        }\r\n\r\n        // extract the dotbracket string of the rna\r\n        // cut it at the position of this backbone bond\r\n        let sequence = rna.seq;\r\n        let sequence1 = rna.seq.slice(0, d.source.num);\r\n        let sequence2 = rna.seq.slice(d.source.num);\r\n\r\n        let rnaDotBracket = rnaUtilities.pairtableToDotbracket(rna.pairtable);\r\n        let dotBracket1 = rnaDotBracket.slice(0, d.source.num);\r\n        let dotBracket2 = rnaDotBracket.slice(d.source.num)\r\n\r\n        // get the nucleotide positions\r\n        // cut them at the positions of the backbone bond\r\n        let positions = rna.getPositions('nucleotide')\r\n        let uids = rna.getUids();\r\n\r\n        let positions1 = positions.slice(0, d.source.num);\r\n        let positions2 = positions.slice(d.source.num);\r\n\r\n        let uids1 = uids.slice(0, d.source.num);\r\n        let uids2 = uids.slice(d.source.num);\r\n\r\n        console.log('positions1:', positions1);\r\n        console.log('positions2:', positions2);\r\n\r\n        delete self.rnas[rna.uid];\r\n        let rna1 = self.addRNA(dotBracket1, { 'sequence': sequence1,\r\n                                   'positions': positions1,\r\n                                   'uids': uids1 });\r\n        let rna2 = self.addRNA(dotBracket2, { 'sequence': sequence2,\r\n                                   'positions': positions2,\r\n                                   'uids': uids2 });\r\n        for (let i = 0; i < toRemove.length; i++) {\r\n            console.log('rna1:', rna1);\r\n            console.log('rna2:', rna2);\r\n            console.log('toRemove[i]', toRemove[i]);\r\n            self.extraLinks.push(\r\n                {'source': rna1.nodes[toRemove[i].from-1],\r\n                 'target': rna2.nodes[toRemove[i].to-1],\r\n                 'value': 1,\r\n                 'uid': slugid.nice(),\r\n                 'linkType': 'intermolecule'});\r\n                recalculateGraph();\r\n                self.update();\r\n\r\n        }\r\n        console.log('self.extraLinks:', self.extraLinks);\r\n        //self.extraLinks.push({'source': rna1.nodes[\r\n\r\n        // create two new rnas\r\n        // add their positions\r\n        // add them back to the plot\r\n    }\r\n\r\n    var removeLink = function(d) {\r\n        // remove a link between two nodes\r\n        let index = self.graph.links.indexOf(d);\r\n        console.log('removing link:', index);\r\n\r\n        if (index > -1) {\r\n            //remove a link\r\n            //graph.links.splice(index, 1);\r\n\r\n            // there should be two cases\r\n            // 1. The link is within a single molecule\r\n\r\n            if (d.source.rna == d.target.rna) {\r\n                if (d.linkType == 'backbone') {\r\n                    console.log('trying to remove a backbone link', d.source.num, d.target.num);\r\n                    removeBackBoneLink(d);\r\n                    return;\r\n                } else {\r\n                    let r = d.source.rna;\r\n                    r.addPseudoknots();\r\n                    r.pairtable[d.source.num] = 0;\r\n                    r.pairtable[d.target.num] = 0;\r\n\r\n                    updateRnaGraph(r);\r\n                }\r\n            } else {\r\n                // 2. The link is between two different molecules\r\n                let extraLinkIndex = self.extraLinks.indexOf(d);\r\n\r\n                self.extraLinks.splice(extraLinkIndex, 1);\r\n            }\r\n            recalculateGraph();\r\n        }\r\n        self.update();\r\n    };\r\n\r\n    let addBackBoneLink = function(newLink) {\r\n        // opposite of deleting a link\r\n        // get the two dotbracket strings\r\n        let rna1 = newLink.target.rna;\r\n        let rna2 = newLink.source.rna;\r\n        if (newLink.target.num == 1) {\r\n          rna1 = newLink.source.rna;\r\n          rna2 = newLink.target.rna;\r\n        }\r\n\r\n        let dotbracket1 = rnaUtilities.pairtableToDotbracket(rna1.pairtable);\r\n        let dotbracket2 = rnaUtilities.pairtableToDotbracket(rna2.pairtable);\r\n\r\n        let seq1 = rna1.seq;\r\n        let seq2 = rna2.seq;\r\n\r\n        let positions1 = rna1.getPositions('nucleotide');\r\n        let positions2 = rna2.getPositions('nucleotide');\r\n\r\n        // concatenate them\r\n        let newDotbracket = dotbracket1 + dotbracket2;\r\n        let newSeq = seq1 + seq2;\r\n        let newPositions = positions1.concat(positions2);\r\n\r\n        let toAddInternal = [];\r\n        let toAddExternal = [];\r\n        let toDelete = {};\r\n\r\n        for (let i = 0; i < self.extraLinks.length; i++) {\r\n            console.log('self.extraLinks[i]', self.extraLinks[i]);\r\n            console.log('rna1:', rna1);\r\n            console.log('rna2:', rna2);\r\n            if (self.extraLinks[i].source.rna == rna1) {\r\n                if ( self.extraLinks[i].target.rna == rna2) {\r\n                    // both ends of the extra link are within what will become the new molecule\r\n                    // need to be added as base pairs afterwards\r\n                    //self.extraLinks[i].from = self.extraLinks[i].source.num;\r\n                    //self.extraLinks[i].to = dotbracket1.length + self.extraLinks[i].target.num;\r\n                    //toAddInternal.push(self.extraLinks[i]);\r\n                } else {\r\n                    // only one end of the extra link is within what will become the newly\r\n                    // created molecule, needs to remain an extra link\r\n                    // source will always be the unchanged molecule, whereas target will be\r\n                    // the newly created one\r\n                    toAddExternal.push({\r\n                        'source': self.extraLinks[i].target,\r\n                        'target': self.extraLinks[i].source.num\r\n                    });\r\n\r\n                    toDelete[self.extraLinks[i].uid] = true;\r\n                }\r\n            } else if (self.extraLinks[i].source.rna == rna2) {\r\n                if ( self.extraLinks[i].target.rna == rna1) {\r\n                    // add internal link\r\n                    // both ends of the extra link are within what will become the new molecule\r\n                    // need to be added as base pairs afterwards\r\n                    //self.extraLinks[i].from = self.extraLinks[i].target.num;\r\n                    //self.extraLinks[i].to = dotbracket1.length + self.extraLinks[i].source.num;\r\n\r\n                    //toAddInternal.push(self.extraLinks[i]);\r\n                } else {\r\n                    toAddExternal.push({\r\n                        'source': self.extraLinks[i].target,\r\n                        'target': self.extraLinks[i].source.num + dotbracket1.length\r\n                    });\r\n                    toDelete[self.extraLinks[i].uid] = true;\r\n                }\r\n            }\r\n\r\n            if (self.extraLinks[i].target.rna == rna1) {\r\n                if (self.extraLinks[i].source.rna == rna2) {\r\n                    // covered in previous if statement\r\n                } else {\r\n                    // only one end of the extra link is within what will become the newly\r\n                    // created molecule, needs to remain an extra link\r\n                    toAddExternal.push({\r\n                        'source': self.extraLinks[i].source,\r\n                        'target': self.extraLinks[i].target.num\r\n                    });\r\n\r\n                    toDelete[self.extraLinks[i].uid] = true;\r\n                }\r\n            } else if (self.extraLinks[i].target.rna == rna2) {\r\n                if (self.extraLinks[i].source.rna == rna1) {\r\n                    toAddExternal.push({\r\n                        'source': self.extraLinks[i].source,\r\n                        'target': self.extraLinks[i].target.num + dotbracket1.length\r\n                    });\r\n\r\n                    toDelete[self.extraLinks[i].uid] = true;\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        self.extraLinks = self.extraLinks.filter((e) => { return !(e.uid in toDelete) });\r\n\r\n        delete self.rnas[rna1.uid];\r\n        delete self.rnas[rna2.uid];\r\n\r\n        let newRna = null;\r\n        // create a new RNA\r\n        if (self.options.animation)\r\n            newRna = self.addRNA(newDotbracket, { 'sequence': newSeq,\r\n                                'positions': newPositions,\r\n                                'centerView': false});\r\n        else\r\n            newRna = self.addRNA(newDotbracket, { 'sequence': newSeq,\r\n                        'centerView': false });\r\n\r\n\r\n\r\n        // add new external links\r\n        for (let i = 0; i < toAddExternal.length; i++) {\r\n            self.extraLinks.push({\r\n                'source': toAddExternal[i].source,\r\n                'target': newRna.nodes[toAddExternal[i].target-1],\r\n                'value': 1,\r\n                'uid': slugid.nice(),\r\n                'linkType': 'intermolecule'\r\n            });\r\n        }\r\n\r\n        recalculateGraph();\r\n        self.update();\r\n        console.log('self.extraLinks:', self.extraLinks);\r\n    };\r\n\r\n    function nudge(dx, dy) {\r\n      // TODO currently unused\r\n        node.filter(function(d) { return d.selected; })\r\n        .attr('cx', function(d) { return d.x += dx; })\r\n        .attr('cy', function(d) { return d.y += dy; });\r\n\r\n        link.filter(function(d) { return d.source.selected; })\r\n        .attr('x1', function(d) { return d.source.x; })\r\n        .attr('y1', function(d) { return d.source.y; });\r\n\r\n        link.filter(function(d) { return d.target.selected; })\r\n        .attr('x2', function(d) { return d.target.x; })\r\n        .attr('y2', function(d) { return d.target.y; });\r\n\r\n        d3.event.preventDefault();\r\n    }\r\n\r\n    let nodeMouseup = function(d,i) {\r\n        console.log(\"nodeMouseup\")\r\n        let backbonePossible = true, basepairPossible = true;\r\n\r\n        if (mousedownNode) {\r\n            mouseupNode = d;\r\n\r\n            // if the node isn't a nucleotide, we can't create a link\r\n            if (mouseupNode.nodeType == 'middle' || mousedownNode.nodeType == 'middle' || mouseupNode.nodeType == 'label' || mousedownNode.nodeType == 'label')\r\n                return;\r\n\r\n            if (mouseupNode == mousedownNode) { resetMouseVars(); return; }\r\n            let newLink = {source: mousedownNode, target: mouseupNode, linkType: 'basepair', value: 1, uid: slugid.nice()};\r\n\r\n            for (let i = 0; i < self.graph.links.length; i++) {\r\n                if ((self.graph.links[i].source == mousedownNode)  ||\r\n                    (self.graph.links[i].target == mousedownNode) ||\r\n                    (self.graph.links[i].source == mouseupNode) ||\r\n                    (self.graph.links[i].target == mouseupNode)) {\r\n                    // either one of the nodes is already in a link\r\n\r\n                    // if any of the nodes are already involved in a basepair or a pseudoknot\r\n                    // then we can't make a basepair link\r\n                    if (self.graph.links[i].linkType == 'basepair' ||\r\n                        self.graph.links[i].linkType == 'pseudoknot' ||\r\n                        self.graph.links[i].linkType == 'intermolecule') {\r\n                        // although should be able to make a backbone link\r\n                        console.log('no basepair possible');\r\n                        basepairPossible = false;\r\n                    }\r\n                }\r\n\r\n                if (((self.graph.links[i].source == mouseupNode)  &&\r\n                     (self.graph.links[i].target == mousedownNode)) ||\r\n                         ((self.graph.links[i].source == mousedownNode)  &&\r\n                          (self.graph.links[i].target == mouseupNode))) {\r\n\r\n                    // if we're trying to make a link between two nodes which already have\r\n                    // a backbone between them, then we can't make a link\r\n                    if (self.graph.links[i].linkType == 'backbone') {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            if (newLink.source.rna != newLink.target.rna) {\r\n                    // could be either a backbone link or an intermolecule link\r\n\r\n                if ((newLink.source.num == 1 &&\r\n                     newLink.target.num == newLink.target.rna.rnaLength) ||\r\n                     (newLink.target.num == 1 &&\r\n                      newLink.source.num == newLink.source.rna.rnaLength)) {\r\n                          //\r\n                          let linkMenu = [\r\n                              {\r\n                                  title: 'Backbone Link',\r\n                                  action: function(elm, d, i) {\r\n                                      linkContextMenuShown = false;\r\n                                      console.log('Item #1 clicked!');\r\n                                      console.log('The data for this circle is: ' + d);\r\n                                      dragLine.attr('class', fstyle.transparent);\r\n                                      addBackBoneLink(newLink);\r\n                                  },\r\n                                  disabled: false // optional, defaults to false\r\n                              },\r\n                              {\r\n                                  title: 'Basepair Link',\r\n                                  action: function(elm, d, i) {\r\n                                      linkContextMenuShown = false;\r\n                                      console.log('You have clicked the second item!');\r\n                                      console.log('The data for this circle is: ' + d);\r\n                                      dragLine.attr('class', fstyle.transparent);\r\n                                      self.addLink(newLink);\r\n                                  }\r\n                              }\r\n                          ]\r\n                          linkContextMenuShown = true;\r\n                          let linkContextMenu = contextMenu(linkMenu);\r\n                          console.log('newLinkMenu');\r\n                          linkContextMenu.apply(this, [d,i,true,\r\n                                                function() { dragLine.attr('class', fstyle.transparent) }]);\r\n                      } else {\r\n                          // between end points but can't make a backbone\r\n                          if (basepairPossible)\r\n                            self.addLink(newLink);\r\n                      }\r\n            } else {\r\n                if (basepairPossible)\r\n                    self.addLink(newLink);\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    let nodeMousedown = function(d) {\r\n      console.log(\"nodeMousedown\")\r\n      if (!d.selected && !ctrlKeydown) {\r\n        // if this node isn't selected, then we have to unselect every other node\r\n        deselectAllNodes()\r\n      }\r\n\r\n      if (!shiftKeydown) {\r\n        // only without shift, toggle select or select\r\n        if (ctrlKeydown) {\r\n          toggleSelectNode(d)\r\n        } else {\r\n          selectNode(d)\r\n        }\r\n      }\r\n\r\n      if (shiftKeydown && self.options.editable) {\r\n        // with shift key and editable continue to draw dragline\r\n        mousedownNode = d;\r\n\r\n        dragLine\r\n        .attr('class', fstyle.dragLine)\r\n        .attr('x1', mousedownNode.x)\r\n        .attr('y1', mousedownNode.y)\r\n        .attr('x2', mousedownNode.x)\r\n        .attr('y2', mousedownNode.y);\r\n\r\n        d3.event.stopPropagation();\r\n      }\r\n    };\r\n\r\n    let linkClick = (d) => {\r\n        if (!shiftKeydown) {\r\n            return;\r\n        }\r\n\r\n        var invalidLinks = { //'backbone': true,\r\n                             'fake': true,\r\n                             'fake_fake': true,\r\n                             'label_link': true};\r\n\r\n        console.log('d.linkType:', d.linkType);\r\n        if (d.linkType in invalidLinks )\r\n            return;\r\n\r\n        removeLink(d);\r\n    };\r\n\r\n    /* I/O functions */\r\n    self.toJSON = function toJSON() {\r\n       var data = {'rnas': self.rnas, 'extraLinks': self.extraLinks};\r\n            var dataString = JSON.stringify(data, function(key, value) {\r\n            //remove circular references\r\n            if (key == 'rna') {\r\n                return;\r\n            } else {\r\n                return value;\r\n            }\r\n       }, '\\t');\r\n       return dataString;\r\n    };\r\n\r\n    self.fromJSON = function(jsonString) {\r\n        var rnas, extraLinks;\r\n\r\n        try{\r\n            var data = JSON.parse(jsonString);\r\n            rnas = data.rnas;\r\n            extraLinks = data.extraLinks;\r\n        } catch(err) {\r\n            throw err;\r\n        }\r\n\r\n        for (var uid in rnas) {\r\n            if (rnas[uid].type == 'rna') {\r\n                r = new RNAGraph();\r\n\r\n                r.seq = rnas[uid].seq;\r\n                r.dotbracket = rnas[uid].dotbracket;\r\n                r.circular = rnas[uid].circular;\r\n                r.pairtable = rnas[uid].pairtable;\r\n                r.uid = rnas[uid].uid;\r\n                r.structName = rnas[uid].structName;\r\n                r.nodes = rnas[uid].nodes;\r\n                r.links = rnas[uid].links;\r\n                r.rnaLength = rnas[uid].rnaLength;\r\n                r.elements = rnas[uid].elements;\r\n                r.nucsToNodes = rnas[uid].nucsToNodes;\r\n                r.pseudoknotPairs = rnas[uid].pseudoknotPairs;\r\n            } else {\r\n                r = new ProteinGraph();\r\n                r.size = rnas[uid].size;\r\n                r.nodes = rnas[uid].nodes;\r\n                r.uid = rnas[uid].uid;\r\n            }\r\n\r\n            self.addRNAJSON(r, false);\r\n        }\r\n\r\n        extraLinks.forEach(function(link) {\r\n            self.extraLinks.push(link);\r\n        });\r\n\r\n        recalculateGraph();\r\n        self.update();\r\n    };\r\n\r\n    self.addRNA = function(structure, passedOptions = {}) {\r\n        let rnaJson = createInitialLayout(structure, passedOptions);\r\n        let centerView = false;\r\n\r\n        /*\r\n         * Code to display the JSONs representing the structure\r\n         *\r\n        rnaJson.nodes[0].rna = null;\r\n        rnaJson.nodes[0].nextNode = null;\r\n\r\n        rnaJson.links[0].source = null;\r\n        rnaJson.links[0].target = null;\r\n\r\n        console.log(rnaJson.nodes[0]);\r\n        console.log(rnaJson.links[0]);\r\n        console.log(JSON.stringify(rnaJson.nodes[0],null,2));\r\n        console.log(JSON.stringify(rnaJson.links[0],null,2));\r\n        */\r\n\r\n        if ('extraLinks' in passedOptions) {\r\n            // presumably the passed in links are within the passed molecule\r\n            let newLinks = self.addExternalLinks(rnaJson, passedOptions.extraLinks);\r\n\r\n            self.extraLinks = self.extraLinks.concat(newLinks);\r\n        }\r\n\r\n        if ('centerPos' in passedOptions)\r\n            self.addRNAJSON(rnaJson, {centerPos: passedOptions.centerPos,\r\n                                      centerView: false})\r\n        else if ('avoidOthers' in passedOptions)\r\n            self.addRNAJSON(rnaJson, {avoidOthers: passedOptions.avoidOthers});\r\n        else\r\n            self.addRNAJSON(rnaJson, {centerView: passedOptions.centerView});\r\n\r\n        return rnaJson;\r\n    };\r\n\r\n    self.addRNAJSON = function(rnaGraph,\r\n     { avoidOthers = false,\r\n      centerPos = null,\r\n      centerView = true}\r\n    ) {\r\n        // Add an RNAGraph, which contains nodes and links as part of the\r\n        // structure\r\n        // Each RNA will have uid to identify it\r\n        // when it is modified, it is replaced in the global list of RNAs\r\n        //\r\n        var maxX, minX;\r\n        //console.log('centerView:', centerView);\r\n\r\n        if (centerPos != null) {\r\n            // center the newly created RNA at a given position\r\n            let totalX = 0;\r\n            let totalY = 0;\r\n            let nodeCount = 0;\r\n\r\n            rnaGraph.nodes.forEach(function(node) {\r\n                totalX += node.x;\r\n                totalY += node.y;\r\n                nodeCount += 1;\r\n            });\r\n\r\n            if (nodeCount > 0) {\r\n                // center the nodes at centerPos\r\n\r\n                rnaGraph.nodes.forEach(function(node) {\r\n                    node.x = node.x + centerPos[0] - totalX / nodeCount;\r\n                    node.y = node.y + centerPos[1] - totalY / nodeCount;\r\n\r\n                    node.px = node.x;\r\n                    node.py = node.y;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (avoidOthers) {\r\n            if (self.graph.nodes.length > 0)\r\n                maxX = d3.max(self.graph.nodes.map(function(d) { return d.x; }));\r\n            else\r\n                maxX = 0;\r\n\r\n            minX = d3.min(rnaGraph.nodes.map(function(d) { return d.x; }));\r\n\r\n            rnaGraph.nodes.forEach(function(node) {\r\n                node.x += (maxX - minX) + 20;\r\n                node.px += (maxX - minX);\r\n            });\r\n        }\r\n\r\n        rnaGraph.nodes.forEach(function(node) {\r\n            node.rna = rnaGraph;\r\n        });\r\n\r\n        self.rnas[rnaGraph.uid] = rnaGraph;\r\n        recalculateGraph();\r\n\r\n        self.update();\r\n\r\n        if (centerView)\r\n            self.centerView();\r\n\r\n        return rnaGraph;\r\n    };\r\n\r\n    self.addNodes = function addNodes(json) {\r\n        // add a new set of nodes from a json file\r\n\r\n        // Resolve the sources and targets of the links so that they\r\n        // are not just indeces into an array\r\n        json.links.forEach(function(entry) {\r\n            if (typeof entry.source == 'number') entry.source = json.nodes[entry.source];\r\n            if (typeof entry.target == 'number') entry.target = json.nodes[entry.target];\r\n        });\r\n\r\n        // Get the maximum x and y values of the current graph\r\n        // so that we don't place a new structure on top of the\r\n        // old one\r\n        if (self.graph.nodes.length > 0) {\r\n            maxX = d3.max(self.graph.nodes.map(function(d) {return d.x;}));\r\n            maxY = d3.max(self.graph.nodes.map(function(d) {return d.y;}));\r\n        } else {\r\n            maxX = 0;\r\n            maxY = 0;\r\n        }\r\n\r\n        json.nodes.forEach(function(entry) {\r\n            if (!(entry.rna.uid in self.rnas)) {\r\n                self.rnas[entry.rna.uid] = entry.rna;\r\n            }\r\n\r\n            entry.x += maxX;\r\n            //entry.y += maxY;\r\n\r\n            entry.px += maxX;\r\n            //entry.py += maxY;\r\n        });\r\n\r\n        r = new RNAGraph('','');\r\n        r.nodes = json.nodes;\r\n        r.links = json.links;\r\n\r\n        //self.addRNA(r);\r\n        recalculateGraph();\r\n\r\n        self.update();\r\n        self.centerView();\r\n    };\r\n\r\n    self.clearNodes = () => {\r\n        self.graph.nodes = [];\r\n        self.graph.links = [];\r\n\r\n        self.rnas = {};\r\n        self.extraLinks = [];\r\n\r\n        self.update();\r\n    };\r\n\r\n    self.addLink =  function(newLink) {\r\n        // this means we have a new json, which means we have\r\n        // to recalculate the structure and change the colors\r\n        // appropriately\r\n        //\r\n        console.log('adding new link');\r\n        if (newLink.source.rna == newLink.target.rna) {\r\n            // must be a basepair\r\n            let r = newLink.source.rna;\r\n\r\n            r.pairtable[newLink.source.num] = newLink.target.num;\r\n            r.pairtable[newLink.target.num] = newLink.source.num;\r\n\r\n            updateRnaGraph(r);\r\n\r\n        } else {\r\n            //Add an extra link\r\n            console.log('intermolecule');\r\n            newLink.linkType = 'intermolecule';\r\n            self.extraLinks.push(newLink);\r\n        }\r\n        recalculateGraph();\r\n        self.update();\r\n    };\r\n\r\n    self.addExternalLinks = function(rnaJson, externalLinks) {\r\n        let newLinks = [];\r\n\r\n        for (let i = 0; i < externalLinks.length; i++) {\r\n            let newLink = {linkType: 'external', value: 1, uid: slugid.nice(),\r\n                source: null, target: null};\r\n            // check if the source node is an array\r\n            if (Object.prototype.toString.call(externalLinks[i][0]) === '[object Array]') {\r\n                for (let j = 0; j < rnaJson.nodes.length; j++) {\r\n                    if ('nucs' in rnaJson.nodes[j]) {\r\n                        if (rnaJson.nodes[j].nucs.equals(externalLinks[i][0])) {\r\n                            newLink.source = rnaJson.nodes[j];\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                for (let j = 0; j < rnaJson.nodes.length; j++) {\r\n                    if (rnaJson.nodes[j].num == externalLinks[i][0]) {\r\n                        newLink.source = rnaJson.nodes[j];\r\n                    }\r\n                }\r\n            }\r\n\r\n            // check if the target node is an array\r\n            if (Object.prototype.toString.call(externalLinks[i][1]) === '[object Array]') {\r\n                for (let j = 0; j < rnaJson.nodes.length; j++) {\r\n                    if ('nucs' in rnaJson.nodes[j]) {\r\n                        if (rnaJson.nodes[j].nucs.equals(externalLinks[i][1])) {\r\n                            newLink.target = rnaJson.nodes[j];\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                for (let j = 0; j < rnaJson.nodes.length; j++) {\r\n                    if (rnaJson.nodes[j].num == externalLinks[i][1]) {\r\n                        newLink.target = rnaJson.nodes[j];\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (newLink.source == null || newLink.target == null) {\r\n                console.log('ERROR: source or target of new link not found:', newLink, externalLinks[i]);\r\n                continue;\r\n            }\r\n\r\n            newLinks.push(newLink);\r\n        }\r\n\r\n        return newLinks;\r\n    };\r\n\r\n    self.getStructuresDotBracket = function() {\r\n        console.log('self.rnas:', self.rnas);\r\n        let sequence = [];\r\n        let currIdx = 1;\r\n        let nodeIdxs = {};\r\n        let breaks = [];\r\n        let pairtable = [];\r\n\r\n        // add the nodes\r\n        for (let uid in self.rnas) {\r\n            let rna = self.rnas[uid];\r\n\r\n            for (let j = 0; j < rna.nodes.length; j++) {\r\n                let node = rna.nodes[j];\r\n\r\n                if (node.nodeType != 'nucleotide')\r\n                    continue;\r\n\r\n                console.log('node:', node);\r\n                nodeIdxs[node.uid] = currIdx;\r\n                currIdx += 1;\r\n\r\n                sequence.push(node.name);\r\n            }\r\n\r\n            breaks.push(currIdx);\r\n        }\r\n\r\n        pairtable = [currIdx-1]\r\n        for (let i = 0; i < currIdx; i++)\r\n            pairtable.push(0)\r\n\r\n        // add the links\r\n        for (let uid in self.rnas) {\r\n            let rna = self.rnas[uid];\r\n\r\n            for (let j = 0; j < rna.links.length; j++) {\r\n                let link = rna.links[j];\r\n\r\n                if (link.linkType != 'basepair')\r\n                    continue;\r\n\r\n                let idx1 = nodeIdxs[link.source.uid];\r\n                let idx2 = nodeIdxs[link.target.uid];\r\n                pairtable[idx1] = idx2;\r\n                pairtable[idx2] = idx1;\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < self.extraLinks.length; i++) {\r\n            let link = self.extraLinks[i];\r\n\r\n            let idx1 = nodeIdxs[link.source.uid];\r\n            let idx2 = nodeIdxs[link.target.uid];\r\n\r\n            pairtable[idx1] = idx2;\r\n            pairtable[idx2] = idx1;\r\n        }\r\n\r\n        let structure = rnaUtilities.pairtableToDotbracket(pairtable).split('');\r\n\r\n        for (let i = 0; i < breaks.length - 1; i++) {\r\n            console.log('breaks[i]:', breaks[i]);\r\n            sequence.splice(breaks[i] + i - 1, 0, '&');\r\n            structure.splice(breaks[i] + i - 1, 0, '&');\r\n        }\r\n\r\n        console.log('sequence:', sequence, sequence.join(''));\r\n        console.log('structure:', structure, structure.join(''));\r\n        return [sequence.join(''), structure.join('')];\r\n    };\r\n\r\n    /* APIs */\r\n    self.startAnimation = function() {\r\n      self.options.animation = true;\r\n      vis.selectAll('g.gnode')\r\n        .call(drag);\r\n      self.force.start();\r\n    };\r\n\r\n    self.stopAnimation = function() {\r\n      self.options.animation = false;\r\n      vis.selectAll('g.gnode')\r\n           .on('mousedown.drag', null);\r\n      self.force.stop();\r\n    };\r\n\r\n    self.resumeForce = function() {\r\n        if (self.options.animation)\r\n            self.force.resume();\r\n    };\r\n\r\n    self.setFriction = function(value) {\r\n      self.force.friction(value);\r\n      self.resumeForce();\r\n    };\r\n\r\n    self.setCharge = function(value) {\r\n      self.force.charge(value);\r\n      self.resumeForce();\r\n    };\r\n\r\n    self.setGravity = function(value) {\r\n      self.force.gravity(value);\r\n      self.resumeForce();\r\n    };\r\n\r\n    self.setPseudoknotStrength = function(value) {\r\n      self.linkStrengths.pseudoknot = value;\r\n      self.update();\r\n    };\r\n\r\n    self.displayNumbering = function(value) {\r\n      self.displayParameters.displayNumbering = value;\r\n      updateStyle();\r\n    };\r\n\r\n    self.displayNodeOutline = function(value) {\r\n      self.displayParameters.displayNodeOutline = value;\r\n      updateStyle();\r\n    };\r\n\r\n    self.displayNodeLabel = function(value) {\r\n      self.displayParameters.displayNodeLabel = value;\r\n      updateStyle();\r\n    };\r\n\r\n    self.displayLinks = function(value) {\r\n      self.displayParameters.displayLinks = value;\r\n      updateStyle();\r\n    };\r\n\r\n    self.displayPseudoknotLinks = function(value) {\r\n      self.displayParameters.displayPseudoknotLinks = value;\r\n      updateStyle();\r\n    };\r\n\r\n    self.displayProteinLinks = function(value) {\r\n      self.displayParameters.displayProteinLinks = value;\r\n      updateStyle();\r\n    };\r\n\r\n    self.displayDirectionArrows = function(value) {\r\n      self.displayParameters.displayDirectionArrows = value;\r\n      updateStyle();\r\n    };\r\n}\r\n","import {RNAGraph} from './rnagraph.js';\r\n\r\nimport {simpleXyCoordinates} from './simplernaplot.js';\r\nimport {NAView} from './naview/naview.js'\r\n\r\nimport fstyle from './fornac.css';\r\n\r\nexport function rnaPlot(passedOptions = {}) {\r\n    var options = {\r\n        'width': 300,\r\n        'height': 300,\r\n        'nucleotideRadius': 5,\r\n        'rnaEdgePadding': 1,     // how far the leftmost, rightmost, topmost and bottomost\r\n                                // nucleotides are from the edge of the plot\r\n        'labelInterval': 10,\r\n        'showNucleotideLabels': true,\r\n        'startNucleotideNumber': 1,\r\n        'bundleExternalLinks': false,\r\n\r\n        'rnaLayout': 'simple', // simple or naview\r\n        'namePosition': '0 0' // for x and y either 0, 0.5 or 1\r\n    };\r\n    var options = Object.assign(options, passedOptions);\r\n\r\n    var xScale, yScale;\r\n\r\n    function createTransformToFillViewport(xValues, yValues) {\r\n        // create transform that will scale the x and y values so that\r\n        // they fill the available viewport\r\n        let xExtent = d3.extent(xValues);\r\n        let yExtent = d3.extent(yValues);\r\n\r\n        // add the radius of the nucleotides\r\n        xExtent[0] -= options.nucleotideRadius + options.rnaEdgePadding;\r\n        yExtent[0] -= options.nucleotideRadius + options.rnaEdgePadding;\r\n\r\n        xExtent[1] += options.nucleotideRadius + options.rnaEdgePadding;\r\n        yExtent[1] += options.nucleotideRadius + options.rnaEdgePadding;\r\n\r\n        // find out how wide and height the molecule\r\n        var xRange = xExtent[1] - xExtent[0];\r\n        var yRange = yExtent[1] - yExtent[0];\r\n\r\n        // how much wider / taller is it than the available viewport\r\n        var xExtra = xRange - options.width;\r\n        var yExtra = yRange - options.height;\r\n\r\n        // once we have a scale for one dimension, we can create the scale for the other\r\n        // keeping the same expansion / shrinking ratio\r\n        function createOtherScale(firstScale, newDomain, newRange) {\r\n            var scaleFactor = (firstScale.range()[1] - firstScale.range()[0]) /\r\n                              (firstScale.domain()[1] - firstScale.domain()[0]);\r\n            var newWidth = (newDomain[1] - newDomain[0]) * scaleFactor\r\n            var newMargin = ((newRange[1] - newRange[0]) - newWidth) / 2;\r\n\r\n            return {'scaleFactor': scaleFactor,\r\n                    'scale': d3.scale.linear()\r\n                                     .domain(newDomain)\r\n                                     .range([newRange[0] + newMargin, newRange[1] - newMargin])};\r\n        }\r\n\r\n        var ret;\r\n\r\n        if (xExtra > yExtra) {\r\n            // we have to shrink more in the x-dimension than the y\r\n            xScale = d3.scale.linear()\r\n            .domain(xExtent)\r\n            .range([0, options.width])\r\n\r\n            ret = createOtherScale(xScale, yExtent, [0, options.height]);\r\n            yScale = ret.scale;\r\n        } else {\r\n            // we have to shrink more in the x-dimension than the y\r\n            yScale = d3.scale.linear()\r\n            .domain(yExtent)\r\n            .range([0, options.height])\r\n\r\n            ret = createOtherScale(yScale, xExtent, [0, options.width]);\r\n            xScale = ret.scale;\r\n        }\r\n\r\n        var xOffset = xScale.range()[0] - xScale.domain()[0];\r\n        var yOffset = yScale.range()[0] - yScale.domain()[0];\r\n\r\n        return 'translate(' + -(xScale.domain()[0] * ret.scaleFactor - xScale.range()[0]) +\r\n                  ',' + -(yScale.domain()[0] * ret.scaleFactor - yScale.range()[0]) + ')' +\r\n            'scale(' + ret.scaleFactor + ')';\r\n    }\r\n\r\n    function createNucleotides(selection, nucleotideNodes) {\r\n        // create groupings for each nucleotide and label\r\n        var gs = selection\r\n        .selectAll('.gnode')\r\n        .data(nucleotideNodes)\r\n        .enter()\r\n        .append('svg:g')\r\n        .classed('gnode', true)\r\n        .attr('transform', function(d) {\r\n            return 'translate(' + d.x + ',' + d.y + ')';\r\n        });\r\n\r\n        var circles = gs.append('svg:circle')\r\n        .classed(fstyle.node, true)\r\n        .attr('node_type', 'nucleotide')\r\n        .attr('base_type', (d) => { if (d.name) { return d.name.toLowerCase(); }})\r\n        .attr('r', options.nucleotideRadius)\r\n\r\n\r\n        if (options.showNucleotideLabels) {\r\n            var nucleotideLabels = gs.append('svg:text')\r\n            .text(function(d) { return d.name; })\r\n            .classed(fstyle.nodeLabel, true)\r\n            .append('svg:title')\r\n            .text(function(d) { return d.struct_name + ':' + d.num; });\r\n        }\r\n    }\r\n\r\n    function createLabels(selection, labelNodes) {\r\n        // create groupings for each nucleotide and label\r\n\r\n        var gs = selection\r\n        .selectAll()\r\n        .data(labelNodes)\r\n        .enter()\r\n        .append('svg:g')\r\n        .classed('gnode', true)\r\n        .attr('transform', function(d) {\r\n            return 'translate(' + d.x + ',' + d.y + ')';\r\n        });\r\n\r\n        var circles = gs.append('svg:circle')\r\n        .classed(fstyle.node, true)\r\n        .attr('node_type', 'label')\r\n        .attr('r', options.nucleotideRadius)\r\n\r\n        var numberLabels = gs.append('svg:text')\r\n        .classed(fstyle.nodeLabel, true)\r\n        .text(function(d) { return d.name; })\r\n    }\r\n\r\n    function createName(selection, name) {\r\n        let nameLabel = selection.append('svg:text')\r\n        //.attr('dy', -10)\r\n        .classed(fstyle.plotLabel, true)\r\n        .text(name);\r\n\r\n        let xyPos = options.namePosition.split(\" \", 2) // 0 0.5 1\r\n        let xy = []\r\n        let textBBox = nameLabel.node().getBBox()\r\n        let textSize = [textBBox.width, textBBox.height]\r\n        let plotSize = [options.width, options.height]\r\n\r\n        for (let p in [0, 1]) {\r\n            switch (xyPos[p]) {\r\n                case '0':\r\n                    xy[p] = textSize[p] / 2\r\n                    break;\r\n                case '1':\r\n                    xy[p] = plotSize[p] - textSize[p] / 2\r\n                    break;\r\n                case '0.5':\r\n                    xy[p] = plotSize[p] / 2\r\n                    break;\r\n            }\r\n        }\r\n        nameLabel.attr('x', xy[0]).attr('y', xy[1])\r\n    }\r\n\r\n    function makeExternalLinksBundle(selection, links) {\r\n        var nodesDict = {};\r\n        var linksList = [];\r\n        links = links.filter(function(d) { return d.linkType == 'correct' || d.linkType == 'incorrect' || d.linkType == 'extra'; });\r\n\r\n        selection.selectAll('[link-type=extra]')\r\n        .remove();\r\n\r\n\r\n        for (var i = 0; i < links.length; i++) {\r\n            if (links[i].source === null || links[i].target === null)\r\n                continue;\r\n\r\n            nodesDict[links[i].source.uid] = links[i].source;\r\n            nodesDict[links[i].target.uid] = links[i].target;\r\n\r\n            linksList.push({'source': links[i].source.uid, 'target': links[i].target.uid, 'linkType': links[i].linkType, 'extraLinkType': links[i].extraLinkType}) ;\r\n        }\r\n\r\n        var fbundling = d3.ForceEdgeBundling().nodes(nodesDict).edges(linksList)\r\n        .compatibility_threshold(0.8).step_size(0.2);\r\n        var results   = fbundling();\r\n\r\n        var d3line = d3.svg.line()\r\n            .x(function(d){return d.x;})\r\n            .y(function(d){return d.y;})\r\n            .interpolate('linear');\r\n\r\n        for (var i = 0; i < results.length; i++) {\r\n            var edge_subpoint_data = results[i];\r\n            // for each of the arrays in the results\r\n            // draw a line between the subdivions points for that edge\r\n\r\n            selection.append('path').attr('d', d3line(edge_subpoint_data))\r\n            .style('fill', 'none')\r\n            .attr('link-type', function(d) { return linksList[i].linkType; })\r\n            .attr('extra-link-type', function(d) { return linksList[i].extraLinkType; })\r\n            .style('stroke-opacity',0.4); //use opacity as blending\r\n        }\r\n\r\n    }\r\n\r\n    function createLinks(selection, links) {\r\n        links = links.filter(function(d) { return d.source !== null && d.target !== null; });\r\n        var gs = selection.selectAll('.link')\r\n        .data(links)\r\n        .enter()\r\n        .append('svg:line')\r\n        .attr('x1', function(d) { return d.source.x; })\r\n        .attr('x2', function(d) { return d.target.x; })\r\n        .attr('y1', function(d) { return d.source.y; })\r\n        .attr('y2', function(d) { return d.target.y; })\r\n        .attr('link-type', function(d) { return d.linkType; })\r\n        .attr('extra-link-type', function(d) { return d.extraLinkType; })\r\n        .classed('link', true)\r\n        .classed(fstyle.link, true)\r\n    }\r\n\r\n    function chart(selection) {\r\n        selection.each(function(data) {\r\n            let plot = d3.select(this).append('g')\r\n            .classed(fstyle.plot, true)\r\n\r\n            // data should be a dictionary containing at least a structure\r\n            // and possibly a sequence\r\n            let rg = new RNAGraph(data.sequence, data.structure, data.name, options.startNucleotideNumber)\r\n                    .recalculateElements()\r\n                    .elementsToJson()\r\n                    .addName(data.name);\r\n\r\n            data.rnaGraph = rg;\r\n            // calculate the position of each nucleotide\r\n            // the positions of the labels will be calculated in\r\n            // the addLabels function\r\n            let positions = [];\r\n\r\n            if (options.rnaLayout === 'naview') {\r\n                var naview = new NAView();\r\n                var naViewPositions = naview.naview_xy_coordinates(rg.pairtable);\r\n\r\n                for (var i = 0; i < naViewPositions.nbase; i++) {\r\n                    positions.push([naViewPositions.x[i], naViewPositions.y[i]]);\r\n                }\r\n            } else {\r\n                positions = simpleXyCoordinates(rg.pairtable);\r\n            }\r\n\r\n            rg.addPositions('nucleotide', positions)\r\n            //.reinforceStems()\r\n            //.reinforceLoops()\r\n            //.addExtraLinks(data.extraLinks)\r\n            .addLabels(options.startNucleotideNumber, options.labelInterval);\r\n\r\n            // create a transform that will fit the molecule to the\r\n            // size of the viewport (canvas, svg, whatever)\r\n            let fillViewportTransform = createTransformToFillViewport(\r\n                rg.nodes.map(function(d) { return d.x; }),\r\n                rg.nodes.map(function(d) { return d.y; })\r\n            );\r\n            plot.attr('transform', fillViewportTransform);\r\n\r\n            let nucleotideNodes = rg.nodes.filter(function(d) {\r\n                return d.nodeType == 'nucleotide';\r\n            });\r\n\r\n            let labelNodes = rg.nodes.filter(function(d) {\r\n                return d.nodeType == 'label';\r\n            });\r\n\r\n            let links = rg.links;\r\n\r\n            createLinks(plot, links);\r\n            createNucleotides(plot, nucleotideNodes);\r\n            createLabels(plot, labelNodes);\r\n            createName(d3.select(this), data.name);\r\n\r\n            if (options.bundleExternalLinks) {\r\n                makeExternalLinksBundle(plot, links);\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    chart.width = function(_) {\r\n        if (!arguments.length) return options.width;\r\n        options.width = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.height = function(_) {\r\n        if (!arguments.length) return options.height;\r\n        options.height = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.showNucleotideLabels = function(_) {\r\n        if (!arguments.length) return options.showNucleotideLabels;\r\n        options.showNucleotideLabels = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.rnaEdgePadding = function(_) {\r\n        if (!arguments.length) return options.rnaEdgePadding;\r\n        options.rnaEdgePadding = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.nucleotideRadius = function(_) {\r\n        if (!arguments.length) return options.nucleotideRadius;\r\n        options.nucleotideRadius = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.labelInterval = function(_) {\r\n        if (!arguments.length) return options.labelInterval;\r\n        options.labelInterval = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.showNucleotideLabels = function(_) {\r\n        if (!arguments.length) return options.showNucleotideLabels;\r\n        options.showNucleotideLabels = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.startNucleotideNumber = function(_) {\r\n        if (!arguments.length) return options.startNucleotideNumber;\r\n        options.startNucleotideNumber = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.bundleExternalLinks = function(_) {\r\n        if (!arguments.length) return options.bundleExternalLinks;\r\n        options.bundleExternalLinks = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.rnaLayout = function(_) {\r\n        if (!arguments.length) return options.rnaLayout;\r\n        options.rnaLayout = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.namePosition = function(_) {\r\n        if (!arguments.length) return options.namePosition;\r\n        options.namePosition = _;\r\n        return chart;\r\n    };\r\n\r\n    return chart;\r\n}\r\n","import {rnaPlot} from './rnaplot.js';\r\n\r\nexport function rnaTreemap(passedOptions = {}) {\r\n    var options = {\r\n        'width': 300,\r\n        'height': 300,\r\n        'nucleotideRadius': 5,\r\n        'rnaEdgePadding': 1,     // how far the leftmost, rightmost, topmost and bottomost\r\n                                // nucleotides are from the edge of the plot\r\n        'labelInterval': 10,\r\n        'showNucleotideLabels': true,\r\n        'startNucleotideNumber': 1,\r\n        'bundleExternalLinks': false,\r\n\r\n        'rnaLayout': 'simple', // simple or naview\r\n        'namePosition': '0 0', // for x and y either 0, 0.5 or 1\r\n    };\r\n\r\n    var options = Object.assign(options, passedOptions);\r\n\r\n    function rnaTreemapNode(selection) {\r\n        // create a background rectangle for each RNA structure\r\n        selection.each(function(d) {\r\n            d3.select(this)\r\n            .attr('transform', function(d) { return 'translate(' + d.x + ',' + d.y + ')' })\r\n            .append('rect')\r\n            .attr('fill', 'transparent')\r\n            .attr('width', function(d) { return Math.max(0, d.dx); })\r\n            .attr('height', function(d) { return Math.max(0, d.dy); })\r\n\r\n            // draw the actual RNA structure\r\n            var chart = rnaPlot(options)\r\n            .width( Math.max(0, d.dx))\r\n            .height( Math.max(0, d.dy))\r\n\r\n            if ('structure' in d) d3.select(this).call(chart)\r\n        });\r\n    }\r\n\r\n    var chart = function(selection) {\r\n        selection.each(function(data) {\r\n            console.log('data:', data)\r\n            // initialize the treemap structure\r\n            // sample input\r\n            // { 'name': 'blah',\r\n            // 'children: [{'structure': '..((..))',\r\n            //               'sequence': 'ACCGGCC',\r\n            //               'size': 50}]\r\n            // }\r\n            var treemap = d3.layout.treemap()\r\n            .size([options.width, options.height])\r\n            .sticky(false)\r\n            .value(function(d) { return d.size; });\r\n\r\n            // create a new <g> for each node in the treemap\r\n            // this may be a little redundant, since we expect the calling\r\n            // selection to contain their own g elements\r\n            var gEnter = d3.select(this)\r\n                .append('g')\r\n                .classed('rnatreemap', true)\r\n            var treemapGnodes = gEnter.datum(data).selectAll('.treemapnode')\r\n                .data(treemap.nodes)\r\n                .enter()\r\n                .append('g')\r\n                .classed('treemapnode', true)\r\n                .call(rnaTreemapNode);\r\n        });\r\n    };\r\n\r\n    chart.width = function(_) {\r\n        if (!arguments.length) return options.width;\r\n        options.width = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.height = function(_) {\r\n        if (!arguments.length) return options.height;\r\n        options.height = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.showNucleotideLabels = function(_) {\r\n        if (!arguments.length) return options.showNucleotideLabels;\r\n        options.showNucleotideLabels = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.rnaEdgePadding = function(_) {\r\n        if (!arguments.length) return options.rnaEdgePadding;\r\n        options.rnaEdgePadding = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.nucleotideRadius = function(_) {\r\n        if (!arguments.length) return options.nucleotideRadius;\r\n        options.nucleotideRadius = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.labelInterval = function(_) {\r\n        if (!arguments.length) return options.labelInterval;\r\n        options.labelInterval = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.showNucleotideLabels = function(_) {\r\n        if (!arguments.length) return options.showNucleotideLabels;\r\n        options.showNucleotideLabels = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.startNucleotideNumber = function(_) {\r\n        if (!arguments.length) return options.startNucleotideNumber;\r\n        options.startNucleotideNumber = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.bundleExternalLinks = function(_) {\r\n        if (!arguments.length) return options.bundleExternalLinks;\r\n        options.bundleExternalLinks = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.rnaLayout = function(_) {\r\n        if (!arguments.length) return options.rnaLayout;\r\n        options.rnaLayout = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.namePosition = function(_) {\r\n        if (!arguments.length) return options.namePosition;\r\n        options.namePosition = _;\r\n        return chart;\r\n    };\r\n\r\n    chart.zoom = function(_) {\r\n        if (!arguments.length) return options.zoom;\r\n        options.zoom = _;\r\n        return chart;\r\n    };\r\n\r\n    return chart;\r\n}\r\n"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__893__","Connection","this","loop","Loop","region","Region","start","end","xrad","yrad","angle","extruded","broken","_isNull","prototype","isNull","setNull","getLoop","setLoop","getRegion","setRegion","getStart","setStart","getEnd","setEnd","getXrad","setXrad","getYrad","setYrad","getAngle","setAngle","isExtruded","setExtruded","isBroken","setBroken","nconnection","connections","_connections","number","depth","mark","x","y","radius","getNconnection","setNconnection","setConnection","i","c","getConnection","addConnection","push","getNumber","setNumber","getDepth","setDepth","isMark","setMark","getX","setX","getY","setY","getRadius","setRadius","_start1","_end1","_start2","_end2","getStart1","setStart1","start1","getEnd1","setEnd1","end1","getStart2","setStart2","start2","getEnd2","setEnd2","end2","byteLength","b64","lens","getLens","validLen","placeHoldersLen","toByteArray","tmp","arr","Arr","_byteLength","curByte","len","revLookup","charCodeAt","fromByteArray","uint8","length","extraBytes","parts","maxChunkLength","len2","encodeChunk","lookup","join","Uint8Array","Array","code","Error","indexOf","num","output","base64","ieee754","customInspectSymbol","Symbol","Buffer","K_MAX_LENGTH","createBuffer","RangeError","buf","Object","setPrototypeOf","arg","encodingOrOffset","TypeError","allocUnsafe","from","value","string","encoding","isEncoding","actual","write","slice","fromString","ArrayBuffer","isView","arrayView","isInstance","copy","fromArrayBuffer","buffer","byteOffset","fromArrayLike","fromArrayView","SharedArrayBuffer","valueOf","b","obj","isBuffer","checked","undefined","numberIsNaN","type","isArray","data","fromObject","toPrimitive","assertSize","size","array","toString","mustMatch","arguments","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","n","m","bidirectionalIndexOf","val","dir","arrayIndexOf","call","lastIndexOf","indexSize","arrLength","valLength","String","read","readUInt16BE","foundIndex","found","j","hexWrite","offset","Number","remaining","strLen","parsed","parseInt","substr","utf8Write","blitBuffer","asciiWrite","str","byteArray","asciiToBytes","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","Math","min","res","firstByte","codePoint","bytesPerSequence","secondByte","thirdByte","fourthByte","tempCodePoint","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","apply","decodeCodePointsArray","TYPED_ARRAY_SUPPORT","proto","foo","e","typedArraySupport","console","error","defineProperty","enumerable","get","poolSize","alloc","fill","allocUnsafeSlow","_isBuffer","compare","a","concat","list","pos","set","swap16","swap32","swap64","toLocaleString","equals","inspect","max","replace","trim","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","ret","out","hexSliceLookupTable","bytes","checkOffset","ext","checkInt","wrtBigUInt64LE","checkIntBI","BigInt","wrtBigUInt64BE","checkIEEE754","writeFloat","littleEndian","noAssert","writeDouble","newBuf","subarray","readUintLE","readUIntLE","mul","readUintBE","readUIntBE","readUint8","readUInt8","readUint16LE","readUInt16LE","readUint16BE","readUint32LE","readUInt32LE","readUint32BE","readUInt32BE","readBigUInt64LE","defineBigIntMethod","validateNumber","first","last","boundsError","readBigUInt64BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readBigInt64LE","readBigInt64BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUintLE","writeUIntLE","writeUintBE","writeUIntBE","writeUint8","writeUInt8","writeUint16LE","writeUInt16LE","writeUint16BE","writeUInt16BE","writeUint32LE","writeUInt32LE","writeUint32BE","writeUInt32BE","writeBigUInt64LE","writeBigUInt64BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeBigInt64LE","writeBigInt64BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","copyWithin","errors","E","sym","getMessage","Base","constructor","super","writable","configurable","name","stack","message","addNumericalSeparator","range","ERR_OUT_OF_RANGE","checkBounds","ERR_INVALID_ARG_TYPE","floor","ERR_BUFFER_OUT_OF_BOUNDS","input","msg","received","isInteger","abs","INVALID_BASE64_RE","Infinity","leadSurrogate","split","base64clean","src","dst","alphabet","table","i16","fn","BufferBigIntNotDefined","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","d","s","NaN","rt","isNaN","log","LN2","uuid","toBase64","btoa","fromBase64","atob","encode","uuid_","parse","substring","decode","slug","stringify","v4","nice","getRandomValues","rnds8","rng","crypto","bind","msCrypto","test","byteToHex","_nodeId","_clockseq","_lastMSecs","_lastNSecs","options","node","clockseq","seedBytes","random","msecs","Date","now","nsecs","dt","tl","tmh","v","version","hashfunc","generateUUID","namespace","unescape","encodeURIComponent","stringToBytes","err","DNS","URL","getOutputLength","inputLength8","safeAdd","lsw","md5cmn","q","t","cnt","md5ff","md5gg","md5hh","md5ii","v35","length32","hexTab","hex","charAt","md5ToHexEncodedArray","olda","oldb","oldc","oldd","wordsToMd5","length8","Uint32Array","bytesToWords","rnds","f","z","ROTL","K","H","l","N","ceil","M","_i","_i2","W","_t","_t2","T","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","key","o","g","globalThis","Function","window","prop","hasOwnProperty","r","toStringTag","scriptUrl","importScripts","location","document","currentScript","scripts","getElementsByTagName","p","contextMenu","menu","opts","openCallback","closeCallback","previouslyMouseUp","uid","slugid","rootElement","orientation","initialPos","parentStart","onOpen","onClose","d3","enter","append","classed","on","style","index","mousePos","pMouseUp","elm","currentThis","openChildMenuUid","html","preventDefault","stopPropagation","selectAll","attr","divider","disabled","action","title","children","childUid","boundingRect","getBoundingClientRect","childrenContextMenu","left","pageXOffset","top","pageYOffset","width","ArrowIcon","contextMenuSelection","pageX","pageY","innerWidth","numberSort","RNAUtilities","bracketLeft","bracketRight","inverseBrackets","bracket","maximumMatching","pt","mm","maximum","backtrackMaximumMatching","oldPt","map","mmBt","dotbracketToPairtable","dotbracket","inverseBracketLeft","inverseBracketRight","ni","pop","insertIntoStack","k","deleteFromStack","pairtableToDotbracket","seen","findUnmatched","to","toRemove","unmatched","origFrom","origTo","removePseudoknotsFromPairtable","newPt","removed","ptToElements","level","dotBracketBreaks","elements","u5","u3","sort","external","right","rnaUtilities","ColorScheme","colorsText","parseRange","rangeText","nums","parts1","parseColorText","colorText","lines","currMolecule","counter","colorsJson","colorValues","domainValues","words","search","partsRight","domain","color","normalizeColors","moleculeName","minNum","MAX_VALUE","maxNum","MIN_VALUE","resnum","RNAGraph","seq","structName","startNumber","circularizeExternal","circular","pseudoknotPairs","nucsToNodes","addUids","uids","nucleotideNodes","nodes","filter","nodeType","computePairtable","pairtable","removeBreaks","targetString","breaks","breakIndex","seqBreaks","rnaLength","arraysEqual","addPositions","positions","labelNodes","breakNodesToFakeNodes","_loop","elemType","getPositions","getUids","reinforceStems","relevantElements","allNucs","nucs","addFakeNode","reinforceLoops","filterNucs","newNode1","px","py","newNode2","updateLinkUids","links","source","tan","fakeNodeUid","newNode","newX","newY","coordsCounted","cos","ia","fromNode","connectFakeNodes","fakeNodes","linked","thisNode","thisNuc","JSON","distance","addExtraLinks","extraLinks","newLink","getNodeFromNucleotides","linkType","elementsToJson","elemTypes","nodeName","prevNode","nextNode","addLabels","labelInterval","prevVec","nextVec","combinedVec","vecLength","sqrt","normedVec","offsetVec","recalculateElements","removePseudoknots","externalLoop","eloop","prev","hloop","numGreater","reassignLinkUids","addPseudoknots","addName","simpleXyCoordinates","pair_table","alpha","loop_size","stack_size","lp","stk","PIHALF","PI","i_old","partner","start_k","start_l","ladder","begin","diff","polygon","count","bubble","remember","poss","sin","Radloop","loopnumber","next","getLoopnumber","setLoopnumber","getNext","setNext","getPrev","setPrev","mate","extracted","getMate","setMate","isExtracted","setExtracted","NAView","ANUM","MAXITER","bases","nbase","nregion","loop_count","loops","regions","rlphead","lencut","RADIUS_REDUCTION_FACTOR","angleinc","_h","HELIX_FACTOR","BACKBONE_DISTANCE","determine_depths","FornaContainer","element","passedOptions","assign","initialSize","svgW","svgH","linkStrengths","displayParameters","colorScheme","customColors","rnas","mousedownNode","mouseupNode","linkContextMenuShown","resetMouseVars","graph","editable","animation","shiftKeydown","ctrlKeydown","keyCode","getStructuresDotBracket","centerView","zoomable","disableZooming","enableBrushing","enableZooming","disableBrushing","backgroundMenu","canvasMousePos","xScale","invert","yScale","addRNA","nodeMenu","deleteNode","changeNode","insertNodeBeforeOrAfter","nodeContextMenu","backgroundContextMenu","select","remove","svg","each","focus","mouseEventHelper","mpos","vis","dragLine","fstyle","deselectAllNodes","visLinks","visNodes","linear","zoomer","zoom","scaleExtent","translate","scale","toggleSelectNode","selected","selectedNodes","brusher","brush","extent","clear","force","charge","middleCharge","otherCharge","friction","linkDistance","linkDistanceMultiplier","linkStrength","other","gravity","chargeDistance","drag","sourceEvent","d1","fixed","dx","dy","resumeForce","createInitialLayout","structure","rg","sequence","rnaJson","layout","naViewPositions","naview_xy_coordinates","createNewNodes","gnodesEnter","previouslySelected","rna","transition","duration","ease","nodeMousedown","nodeMouseup","labelAndProteinNodes","text","createNewLinks","linksEnter","linkLines","linkClick","drawDirectionArrow","magnitude","endPoint","startPoint","nodeStroke","parseFloat","lengthMult","arrowWidth","u","arrowTip","path","realLinkFilter","recalculateGraph","uidsToNodes","forEach","link","fakeLinks","linkIndex","splice","update","allLinks","elementKey","exit","gnodes","realNodes","quadtree","collide","nx1","nx2","ny1","ny2","quad","x1","y1","x2","y2","point","visit","changeColorScheme","updateStyle","transitionRNA","newStructure","nextFunction","transitionDuration","newRNAJson","newNodes","callback","setTimeout","bbTransform","minX","minY","maxX","maxY","maxRadius","molWidth","molHeight","widthRatio","heightRatio","minRatio","maxNodeRadius","newMolWidth","newMolHeight","getBoundingBoxTransform","setSize","offsetWidth","offsetHeight","setOutlineColor","addCustomColors","json","addCustomColorsText","customColorsText","cs","newColorScheme","ordinal","category10","interpolate","changeColors","moleculeColors","displayNumbering","displayNodeOutline","displayNodeLabel","displayLinks","displayPseudoknotLinks","displayProteinLinks","displayAllLinks","displayDirectionArrows","referenceNode","newNodeNum","newDotbracket","newSequence","newPositions","positionOffset","newUids","pair","updateRnaGraph","nucleotidePositions","labelPositions","basepairPossible","linkMenu","rna1","rna2","dotbracket1","dotbracket2","seq1","seq2","positions1","positions2","newSeq","toAddExternal","toDelete","newRna","addBackBoneLink","addLink","linkContextMenu","sequence1","sequence2","rnaDotBracket","dotBracket1","dotBracket2","uids1","uids2","removeBackBoneLink","extraLinkIndex","removeLink","fromJSON","jsonString","ProteinGraph","addRNAJSON","newLinks","addExternalLinks","centerPos","avoidOthers","rnaGraph","_ref","_ref$avoidOthers","_ref$centerPos","_ref$centerView","totalX","totalY","nodeCount","addNodes","entry","clearNodes","externalLinks","currIdx","nodeIdxs","idx1","idx2","startAnimation","stopAnimation","stop","resume","setFriction","setCharge","setGravity","setPseudoknotStrength","pseudoknot","rnaPlot","chart","selection","plot","startNucleotideNumber","rnaLayout","fillViewportTransform","xValues","yValues","xExtent","yExtent","nucleotideRadius","rnaEdgePadding","xRange","yRange","createOtherScale","firstScale","newDomain","newRange","scaleFactor","newWidth","newMargin","height","createTransformToFillViewport","extraLinkType","createLinks","gs","showNucleotideLabels","struct_name","createNucleotides","createLabels","nameLabel","xyPos","namePosition","xy","textBBox","getBBox","textSize","plotSize","createName","bundleExternalLinks","nodesDict","linksList","results","ForceEdgeBundling","edges","compatibility_threshold","step_size","fbundling","d3line","line","edge_subpoint_data","makeExternalLinksBundle","_","rnaTreemap","rnaTreemapNode","treemap","sticky","datum","read_in_bases","find_regions","construct_loop","find_central_loop","traverse_loop","npairs","nb1","ibase","retloop","cp","rp","rlp","maxconn","maxdepth","anchor_connection","xs","ys","xe","xn","yn","xc","yc","xo","yo","astart","aend","cpnext","acp","cpprev","ic","da","maxang","icstart","icend","icmiddle","icroot","done","done_all_connections","rooted","sign","midx","midy","nrx","nry","mx","my","vx","vy","dotmv","nmidx","nmidy","icstart1","icup","icdown","icnext","direction","dan","rr","cpx","cpy","cpnextx","cpnexty","cnx","rcn","rc","lnx","lny","rl","ac","acn","sx","sy","dcp","imaxloop","indice","atan2","set_radius","determine_radius","connected_connection","find_ic_middle","asin","construct_extruded_segment","generate_region","mindit","ci","sumn","sumd","dit","imindit","rt2_2","aend1","aend2","aave","a1","a2","dac","nstart","nend","collision","construct_circle_segment","minf2","maxf2","find_center_for_arc","h","hhi","hlow","disc","theta","iter","acos","noIterationFailureYet"],"sourceRoot":""}